<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>JLinkButton.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">argouml-app</a> &gt; <a href="index.source.html" class="el_package">org.argouml.swingext</a> &gt; <span class="el_source">JLinkButton.java</span></div><h1>JLinkButton.java</h1><pre class="source lang-java linenums">/* $Id$
 *****************************************************************************
 * Copyright (c) 2009 Contributors - see below
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License v1.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/legal/epl-v10.html
 *
 * Contributors:
 *    euluis
 *****************************************************************************
 *
 * Some portions of this file was previously release using the BSD License:
 */

// Copyright (c) 2008 The Regents of the University of California. All
// Rights Reserved. Permission to use, copy, modify, and distribute this
// software and its documentation without fee, and without a written
// agreement is hereby granted, provided that the above copyright notice
// and this paragraph appear in all copies. This software program and
// documentation are copyrighted by The Regents of the University of
// California. The software program and documentation are supplied &quot;AS
// IS&quot;, without any accompanying services from The Regents. The Regents
// does not warrant that the operation of the program will be
// uninterrupted or error-free. The end-user understands that the program
// was developed for research purposes and is advised not to rely
// exclusively on the program for any reason. IN NO EVENT SHALL THE
// UNIVERSITY OF CALIFORNIA BE LIABLE TO ANY PARTY FOR DIRECT, INDIRECT,
// SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, INCLUDING LOST PROFITS,
// ARISING OUT OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, EVEN IF
// THE UNIVERSITY OF CALIFORNIA HAS BEEN ADVISED OF THE POSSIBILITY OF
// SUCH DAMAGE. THE UNIVERSITY OF CALIFORNIA SPECIFICALLY DISCLAIMS ANY
// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
// MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE SOFTWARE
// PROVIDED HEREUNDER IS ON AN &quot;AS IS&quot; BASIS, AND THE UNIVERSITY OF
// CALIFORNIA HAS NO OBLIGATIONS TO PROVIDE MAINTENANCE, SUPPORT,
// UPDATES, ENHANCEMENTS, OR MODIFICATIONS.

package org.argouml.swingext;

import java.awt.Color;
import java.awt.Cursor;
import java.awt.FontMetrics;
import java.awt.Graphics;
import java.awt.Rectangle;
import java.net.URL;

import javax.swing.Action;
import javax.swing.ButtonModel;
import javax.swing.Icon;
import javax.swing.JButton;
import javax.swing.JComponent;
import javax.swing.plaf.ComponentUI;
import javax.swing.plaf.metal.MetalButtonUI;

/**
 * A button with the looks of an hyperlink.
 * 
 * Based on 
 * &lt;a href=&quot;http://www.java2s.com/Code/Java/Swing-Components/LinkButton.htm&quot;&gt;
 * JLinkButton&lt;/a&gt;.
 * 
 * @since 0.25.6
 */
public class JLinkButton extends JButton {

    /**
     * Link behavior - underline always.
     */
    public static final int ALWAYS_UNDERLINE = 0;

    /**
     * Link behavior - underline only when hovering the mouse over the button.
     */
    public static final int HOVER_UNDERLINE = 1;

    /**
     * Link behavior - don't underline.
     */
    public static final int NEVER_UNDERLINE = 2;

    /**
     * Link behavior - use the system default behavior for hyper-links.
     */
    public static final int SYSTEM_DEFAULT = 3;

    private int linkBehavior;

    private Color linkColor;

    private Color colorPressed;

    private Color visitedLinkColor;

    private Color disabledLinkColor;

    private URL buttonURL;

    private Action defaultAction;

    private boolean isLinkVisited;

    /**
     * No arguments constructor.
     */
    public JLinkButton() {
<span class="nc" id="L107">        this(null, null, null);</span>
<span class="nc" id="L108">    }</span>

    /**
     * Constructor.
     * @param action the Action to perform upon the button being hit.
     */
    public JLinkButton(Action action) {
<span class="nc" id="L115">        this();</span>
<span class="nc" id="L116">        setAction(action);</span>
<span class="nc" id="L117">    }</span>

    /**
     * @param text the button label.
     * @param icon the Icon to be shown in the button.
     * @param url the URL that will be linked from the button.
     */
    public JLinkButton(String text, Icon icon, URL url) {
<span class="nc" id="L125">        super(text, icon);</span>
<span class="nc" id="L126">        linkBehavior = SYSTEM_DEFAULT;</span>
<span class="nc" id="L127">        linkColor = Color.blue;</span>
<span class="nc" id="L128">        colorPressed = Color.red;</span>
<span class="nc" id="L129">        visitedLinkColor = new Color(128, 0, 128);</span>
<span class="nc bnc" id="L130" title="All 4 branches missed.">        if (text == null &amp;&amp; url != null) {</span>
<span class="nc" id="L131">            setText(url.toExternalForm());</span>
        }
<span class="nc" id="L133">        setLinkURL(url);</span>
<span class="nc" id="L134">        setCursor(Cursor.getPredefinedCursor(12));</span>
<span class="nc" id="L135">        setBorderPainted(false);</span>
<span class="nc" id="L136">        setContentAreaFilled(false);</span>
<span class="nc" id="L137">        setRolloverEnabled(true);</span>
<span class="nc" id="L138">        addActionListener(defaultAction);</span>
<span class="nc" id="L139">    }</span>

    @Override
    public void updateUI() {
<span class="nc" id="L143">        setUI(BasicLinkButtonUI.createUI(this));</span>
<span class="nc" id="L144">    }</span>

    @Override
    public String getUIClassID() {
<span class="nc" id="L148">        return &quot;LinkButtonUI&quot;;</span>
    }

    protected void setupToolTipText() {
<span class="nc" id="L152">        String tip = null;</span>
<span class="nc bnc" id="L153" title="All 2 branches missed.">        if (buttonURL != null) {</span>
<span class="nc" id="L154">            tip = buttonURL.toExternalForm();</span>
        }
<span class="nc" id="L156">        setToolTipText(tip);</span>
<span class="nc" id="L157">    }</span>

    int getLinkBehavior() {
<span class="nc" id="L160">        return linkBehavior;</span>
    }

    Color getLinkColor() {
<span class="nc" id="L164">        return linkColor;</span>
    }

    Color getActiveLinkColor() {
<span class="nc" id="L168">        return colorPressed;</span>
    }

    Color getDisabledLinkColor() {
<span class="nc" id="L172">        return disabledLinkColor;</span>
    }

    Color getVisitedLinkColor() {
<span class="nc" id="L176">        return visitedLinkColor;</span>
    }

    URL getLinkURL() {
<span class="nc" id="L180">        return buttonURL;</span>
    }

    void setLinkURL(URL url) {
<span class="nc" id="L184">        URL urlOld = buttonURL;</span>
<span class="nc" id="L185">        buttonURL = url;</span>
<span class="nc" id="L186">        setupToolTipText();</span>
<span class="nc" id="L187">        firePropertyChange(&quot;linkURL&quot;, urlOld, url);</span>
<span class="nc" id="L188">        revalidate();</span>
<span class="nc" id="L189">        repaint();</span>
<span class="nc" id="L190">    }</span>

    boolean isLinkVisited() {
<span class="nc" id="L193">        return isLinkVisited;</span>
    }

    protected String paramString() {
        String str;
<span class="nc bnc" id="L198" title="All 2 branches missed.">        if (linkBehavior == ALWAYS_UNDERLINE) {</span>
<span class="nc" id="L199">            str = &quot;ALWAYS_UNDERLINE&quot;;</span>
<span class="nc bnc" id="L200" title="All 2 branches missed.">        } else if (linkBehavior == HOVER_UNDERLINE) {</span>
<span class="nc" id="L201">            str = &quot;HOVER_UNDERLINE&quot;;</span>
<span class="nc bnc" id="L202" title="All 2 branches missed.">        } else if (linkBehavior == NEVER_UNDERLINE) {</span>
<span class="nc" id="L203">            str = &quot;NEVER_UNDERLINE&quot;;</span>
        } else {
<span class="nc" id="L205">            str = &quot;SYSTEM_DEFAULT&quot;;</span>
        }
<span class="nc bnc" id="L207" title="All 2 branches missed.">        String colorStr = linkColor == null ? &quot;&quot; : linkColor.toString();</span>
<span class="nc bnc" id="L208" title="All 2 branches missed.">        String colorPressStr = colorPressed == null ? &quot;&quot; : colorPressed</span>
<span class="nc" id="L209">                .toString();</span>
<span class="nc bnc" id="L210" title="All 2 branches missed.">        String disabledLinkColorStr = disabledLinkColor == null ? &quot;&quot;</span>
<span class="nc" id="L211">                : disabledLinkColor.toString();</span>
<span class="nc bnc" id="L212" title="All 2 branches missed.">        String visitedLinkColorStr = visitedLinkColor == null ? &quot;&quot;</span>
<span class="nc" id="L213">                : visitedLinkColor.toString();</span>
<span class="nc bnc" id="L214" title="All 2 branches missed.">        String buttonURLStr = buttonURL == null ? &quot;&quot; : buttonURL.toString();</span>
<span class="nc bnc" id="L215" title="All 2 branches missed.">        String isLinkVisitedStr = isLinkVisited ? &quot;true&quot; : &quot;false&quot;;</span>
<span class="nc" id="L216">        return super.paramString() + &quot;,linkBehavior=&quot; + str + &quot;,linkURL=&quot;</span>
                + buttonURLStr + &quot;,linkColor=&quot; + colorStr + &quot;,activeLinkColor=&quot;
                + colorPressStr + &quot;,disabledLinkColor=&quot; + disabledLinkColorStr
                + &quot;,visitedLinkColor=&quot; + visitedLinkColorStr
                + &quot;,linkvisitedString=&quot; + isLinkVisitedStr;
    }
}

class BasicLinkButtonUI extends MetalButtonUI {
<span class="nc" id="L225">    private static final BasicLinkButtonUI UI = new BasicLinkButtonUI();</span>

<span class="nc" id="L227">    BasicLinkButtonUI() {</span>
<span class="nc" id="L228">    }</span>

    public static ComponentUI createUI(JComponent jcomponent) {
<span class="nc" id="L231">        return UI;</span>
    }

    protected void paintText(Graphics g, JComponent com, Rectangle rect,
            String s) {
<span class="nc" id="L236">        JLinkButton bn = (JLinkButton) com;</span>
<span class="nc" id="L237">        ButtonModel bnModel = bn.getModel();</span>
<span class="nc" id="L238">        bn.getForeground();</span>
<span class="nc bnc" id="L239" title="All 2 branches missed.">        if (bnModel.isEnabled()) {</span>
<span class="nc bnc" id="L240" title="All 2 branches missed.">            if (bnModel.isPressed()) {</span>
<span class="nc" id="L241">                bn.setForeground(bn.getActiveLinkColor());</span>
<span class="nc bnc" id="L242" title="All 2 branches missed.">            } else if (bn.isLinkVisited()) {</span>
<span class="nc" id="L243">                bn.setForeground(bn.getVisitedLinkColor());</span>
            } else {
<span class="nc" id="L245">                bn.setForeground(bn.getLinkColor());</span>
            }
        } else {
<span class="nc bnc" id="L248" title="All 2 branches missed.">            if (bn.getDisabledLinkColor() != null) {</span>
<span class="nc" id="L249">                bn.setForeground(bn.getDisabledLinkColor());</span>
            }
        }
<span class="nc" id="L252">        super.paintText(g, com, rect, s);</span>
<span class="nc" id="L253">        int behaviour = bn.getLinkBehavior();</span>
<span class="nc" id="L254">        boolean drawLine = false;</span>
<span class="nc bnc" id="L255" title="All 2 branches missed.">        if (behaviour == JLinkButton.HOVER_UNDERLINE) {</span>
<span class="nc bnc" id="L256" title="All 2 branches missed.">            if (bnModel.isRollover()) {</span>
<span class="nc" id="L257">                drawLine = true;</span>
            }
<span class="nc bnc" id="L259" title="All 4 branches missed.">        } else if (behaviour == JLinkButton.ALWAYS_UNDERLINE</span>
                || behaviour == JLinkButton.SYSTEM_DEFAULT) {
<span class="nc" id="L261">            drawLine = true;</span>
        }
<span class="nc bnc" id="L263" title="All 2 branches missed.">        if (!drawLine) {</span>
<span class="nc" id="L264">            return;</span>
        }
<span class="nc" id="L266">        FontMetrics fm = g.getFontMetrics();</span>
<span class="nc" id="L267">        int x = rect.x + getTextShiftOffset();</span>
<span class="nc" id="L268">        int y = (rect.y + fm.getAscent() + fm.getDescent() </span>
<span class="nc" id="L269">                + getTextShiftOffset()) - 1;</span>
<span class="nc bnc" id="L270" title="All 2 branches missed.">        if (bnModel.isEnabled()) {</span>
<span class="nc" id="L271">            g.setColor(bn.getForeground());</span>
<span class="nc" id="L272">            g.drawLine(x, y, (x + rect.width) - 1, y);</span>
        } else {
<span class="nc" id="L274">            g.setColor(bn.getBackground().brighter());</span>
<span class="nc" id="L275">            g.drawLine(x, y, (x + rect.width) - 1, y);</span>
        }
<span class="nc" id="L277">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.5.201910111838</span></div></body></html>