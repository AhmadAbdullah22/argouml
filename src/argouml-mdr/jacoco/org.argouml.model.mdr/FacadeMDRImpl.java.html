<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>FacadeMDRImpl.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">argouml-core-model-mdr</a> &gt; <a href="index.source.html" class="el_package">org.argouml.model.mdr</a> &gt; <span class="el_source">FacadeMDRImpl.java</span></div><h1>FacadeMDRImpl.java</h1><pre class="source lang-java linenums">/* $Id$
 *******************************************************************************
 * Copyright (c) 2005-2012 Contributors - see below
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License v1.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/legal/epl-v10.html
 *
 * Contributors:
 *    Linus Tolke - initial framework implementation
 *    &lt;see source control change log for other early contributors&gt;
 *    Ludovic Maitre - UML 1.4
 *    Tom Morris - UML 1.4
 *    Bob Tarling
 *    Michiel van der Wulp
 *    Luis Sergio Oliveira (euluis)
 *******************************************************************************
 */
// Copyright (c) 2005-2009 The Regents of the University of California. All
// Rights Reserved. Permission to use, copy, modify, and distribute this
// software and its documentation without fee, and without a written
// agreement is hereby granted, provided that the above copyright notice
// and this paragraph appear in all copies. This software program and
// documentation are copyrighted by The Regents of the University of
// California. The software program and documentation are supplied &quot;AS
// IS&quot;, without any accompanying services from The Regents. The Regents
// does not warrant that the operation of the program will be
// uninterrupted or error-free. The end-user understands that the program
// was developed for research purposes and is advised not to rely
// exclusively on the program for any reason. IN NO EVENT SHALL THE
// UNIVERSITY OF CALIFORNIA BE LIABLE TO ANY PARTY FOR DIRECT, INDIRECT,
// SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, INCLUDING LOST PROFITS,
// ARISING OUT OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, EVEN IF
// THE UNIVERSITY OF CALIFORNIA HAS BEEN ADVISED OF THE POSSIBILITY OF
// SUCH DAMAGE. THE UNIVERSITY OF CALIFORNIA SPECIFICALLY DISCLAIMS ANY
// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
// MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE SOFTWARE
// PROVIDED HEREUNDER IS ON AN &quot;AS IS&quot; BASIS, AND THE UNIVERSITY OF
// CALIFORNIA HAS NO OBLIGATIONS TO PROVIDE MAINTENANCE, SUPPORT,
// UPDATES, ENHANCEMENTS, OR MODIFICATIONS.

package org.argouml.model.mdr;

import java.util.ArrayList;
import java.util.Collection;
import java.util.Collections;
import java.util.HashSet;
import java.util.Iterator;
import java.util.List;
import java.util.Set;
import java.util.logging.Level;
import java.util.logging.Logger;

import javax.jmi.model.MofClass;
import javax.jmi.model.Reference;
import javax.jmi.reflect.InvalidObjectException;
import javax.jmi.reflect.RefBaseObject;
import javax.jmi.reflect.RefClass;
import javax.jmi.reflect.RefFeatured;
import javax.jmi.reflect.RefObject;
import javax.jmi.reflect.RefPackage;

import org.argouml.model.CoreFactory;
import org.argouml.model.Facade;
import org.argouml.model.InvalidElementException;
import org.argouml.model.NotImplementedException;
import org.omg.uml.behavioralelements.activitygraphs.ActionState;
import org.omg.uml.behavioralelements.activitygraphs.ActivityGraph;
import org.omg.uml.behavioralelements.activitygraphs.CallState;
import org.omg.uml.behavioralelements.activitygraphs.ClassifierInState;
import org.omg.uml.behavioralelements.activitygraphs.ObjectFlowState;
import org.omg.uml.behavioralelements.activitygraphs.Partition;
import org.omg.uml.behavioralelements.activitygraphs.SubactivityState;
import org.omg.uml.behavioralelements.collaborations.AssociationEndRole;
import org.omg.uml.behavioralelements.collaborations.AssociationRole;
import org.omg.uml.behavioralelements.collaborations.ClassifierRole;
import org.omg.uml.behavioralelements.collaborations.Collaboration;
import org.omg.uml.behavioralelements.collaborations.CollaborationInstanceSet;
import org.omg.uml.behavioralelements.collaborations.Interaction;
import org.omg.uml.behavioralelements.collaborations.InteractionInstanceSet;
import org.omg.uml.behavioralelements.collaborations.Message;
import org.omg.uml.behavioralelements.commonbehavior.Action;
import org.omg.uml.behavioralelements.commonbehavior.ActionSequence;
import org.omg.uml.behavioralelements.commonbehavior.Argument;
import org.omg.uml.behavioralelements.commonbehavior.AttributeLink;
import org.omg.uml.behavioralelements.commonbehavior.CallAction;
import org.omg.uml.behavioralelements.commonbehavior.ComponentInstance;
import org.omg.uml.behavioralelements.commonbehavior.CreateAction;
import org.omg.uml.behavioralelements.commonbehavior.DataValue;
import org.omg.uml.behavioralelements.commonbehavior.DestroyAction;
import org.omg.uml.behavioralelements.commonbehavior.Instance;
import org.omg.uml.behavioralelements.commonbehavior.Link;
import org.omg.uml.behavioralelements.commonbehavior.LinkEnd;
import org.omg.uml.behavioralelements.commonbehavior.LinkObject;
import org.omg.uml.behavioralelements.commonbehavior.NodeInstance;
import org.omg.uml.behavioralelements.commonbehavior.Reception;
import org.omg.uml.behavioralelements.commonbehavior.ReturnAction;
import org.omg.uml.behavioralelements.commonbehavior.SendAction;
import org.omg.uml.behavioralelements.commonbehavior.Signal;
import org.omg.uml.behavioralelements.commonbehavior.Stimulus;
import org.omg.uml.behavioralelements.commonbehavior.SubsystemInstance;
import org.omg.uml.behavioralelements.commonbehavior.TerminateAction;
import org.omg.uml.behavioralelements.commonbehavior.UmlException;
import org.omg.uml.behavioralelements.commonbehavior.UninterpretedAction;
import org.omg.uml.behavioralelements.statemachines.CallEvent;
import org.omg.uml.behavioralelements.statemachines.ChangeEvent;
import org.omg.uml.behavioralelements.statemachines.CompositeState;
import org.omg.uml.behavioralelements.statemachines.Event;
import org.omg.uml.behavioralelements.statemachines.FinalState;
import org.omg.uml.behavioralelements.statemachines.Guard;
import org.omg.uml.behavioralelements.statemachines.Pseudostate;
import org.omg.uml.behavioralelements.statemachines.SignalEvent;
import org.omg.uml.behavioralelements.statemachines.SimpleState;
import org.omg.uml.behavioralelements.statemachines.State;
import org.omg.uml.behavioralelements.statemachines.StateMachine;
import org.omg.uml.behavioralelements.statemachines.StateVertex;
import org.omg.uml.behavioralelements.statemachines.StubState;
import org.omg.uml.behavioralelements.statemachines.SubmachineState;
import org.omg.uml.behavioralelements.statemachines.SynchState;
import org.omg.uml.behavioralelements.statemachines.TimeEvent;
import org.omg.uml.behavioralelements.statemachines.Transition;
import org.omg.uml.behavioralelements.usecases.Actor;
import org.omg.uml.behavioralelements.usecases.Extend;
import org.omg.uml.behavioralelements.usecases.ExtensionPoint;
import org.omg.uml.behavioralelements.usecases.Include;
import org.omg.uml.behavioralelements.usecases.UseCase;
import org.omg.uml.foundation.core.Abstraction;
import org.omg.uml.foundation.core.Artifact;
import org.omg.uml.foundation.core.AssociationClass;
import org.omg.uml.foundation.core.AssociationEnd;
import org.omg.uml.foundation.core.Attribute;
import org.omg.uml.foundation.core.BehavioralFeature;
import org.omg.uml.foundation.core.Binding;
import org.omg.uml.foundation.core.Classifier;
import org.omg.uml.foundation.core.Comment;
import org.omg.uml.foundation.core.Component;
import org.omg.uml.foundation.core.Constraint;
import org.omg.uml.foundation.core.DataType;
import org.omg.uml.foundation.core.Dependency;
import org.omg.uml.foundation.core.Element;
import org.omg.uml.foundation.core.ElementResidence;
import org.omg.uml.foundation.core.Enumeration;
import org.omg.uml.foundation.core.EnumerationLiteral;
import org.omg.uml.foundation.core.Feature;
import org.omg.uml.foundation.core.Flow;
import org.omg.uml.foundation.core.GeneralizableElement;
import org.omg.uml.foundation.core.Generalization;
import org.omg.uml.foundation.core.Interface;
import org.omg.uml.foundation.core.Method;
import org.omg.uml.foundation.core.ModelElement;
import org.omg.uml.foundation.core.Namespace;
import org.omg.uml.foundation.core.Node;
import org.omg.uml.foundation.core.Operation;
import org.omg.uml.foundation.core.Parameter;
import org.omg.uml.foundation.core.Permission;
import org.omg.uml.foundation.core.Primitive;
import org.omg.uml.foundation.core.Relationship;
import org.omg.uml.foundation.core.Stereotype;
import org.omg.uml.foundation.core.StructuralFeature;
import org.omg.uml.foundation.core.TagDefinition;
import org.omg.uml.foundation.core.TaggedValue;
import org.omg.uml.foundation.core.TemplateArgument;
import org.omg.uml.foundation.core.TemplateParameter;
import org.omg.uml.foundation.core.UmlAssociation;
import org.omg.uml.foundation.core.UmlClass;
import org.omg.uml.foundation.core.Usage;
import org.omg.uml.foundation.datatypes.ActionExpression;
import org.omg.uml.foundation.datatypes.AggregationKind;
import org.omg.uml.foundation.datatypes.AggregationKindEnum;
import org.omg.uml.foundation.datatypes.CallConcurrencyKind;
import org.omg.uml.foundation.datatypes.CallConcurrencyKindEnum;
import org.omg.uml.foundation.datatypes.ChangeableKind;
import org.omg.uml.foundation.datatypes.ChangeableKindEnum;
import org.omg.uml.foundation.datatypes.Expression;
import org.omg.uml.foundation.datatypes.Multiplicity;
import org.omg.uml.foundation.datatypes.MultiplicityRange;
import org.omg.uml.foundation.datatypes.OrderingKind;
import org.omg.uml.foundation.datatypes.OrderingKindEnum;
import org.omg.uml.foundation.datatypes.ParameterDirectionKind;
import org.omg.uml.foundation.datatypes.ParameterDirectionKindEnum;
import org.omg.uml.foundation.datatypes.PseudostateKind;
import org.omg.uml.foundation.datatypes.ScopeKind;
import org.omg.uml.foundation.datatypes.ScopeKindEnum;
import org.omg.uml.foundation.datatypes.VisibilityKind;
import org.omg.uml.foundation.datatypes.VisibilityKindEnum;
import org.omg.uml.modelmanagement.ElementImport;
import org.omg.uml.modelmanagement.Model;
import org.omg.uml.modelmanagement.Subsystem;
import org.omg.uml.modelmanagement.UmlPackage;

/**
 * Model Facade implementation.
 *
 * This class provides read-only access to model data in the repository.
 * Factories and setters are in separate UML package specific classes.
 * &lt;p&gt;
 * Most methods in this class can throw the run-time exception
 * {@link org.argouml.model.InvalidElementException}.
 * &lt;p&gt;
 * Unless otherwise noted by the Javadoc, all methods in this class implement
 * methods from the interface {@link Facade}.
 */
class FacadeMDRImpl implements Facade {

    /**
     * Logger.
     */
<span class="fc" id="L208">    private static final Logger LOG =</span>
<span class="fc" id="L209">        Logger.getLogger(FacadeMDRImpl.class.getName());</span>

    private MDRModelImplementation modelImpl;

    // Shorthand notation for convenience
<span class="fc" id="L214">    private static final javax.jmi.model.AggregationKindEnum MOF_COMPOSITE =</span>
        javax.jmi.model.AggregationKindEnum.COMPOSITE;

    /**
     * Constructor.
     *
     * @param impl
     *            The model implementation
     */
<span class="fc" id="L223">    public FacadeMDRImpl(MDRModelImplementation impl) {</span>
<span class="fc" id="L224">        modelImpl = impl;</span>
<span class="fc" id="L225">    }</span>

    public String getUmlVersion() {
<span class="nc" id="L228">        return &quot;1.4&quot;;</span>
    }

    public boolean isAAbstraction(Object handle) {
<span class="nc" id="L232">        return handle instanceof Abstraction;</span>
    }

    public boolean isAAcceptEventAction(Object handle) {
<span class="nc" id="L236">        return false; // Not in UML1.4</span>
    }

    public boolean isAAction(Object handle) {
<span class="nc" id="L240">        return handle instanceof Action;</span>
    }

    public boolean isAActionExpression(Object handle) {
<span class="nc" id="L244">        return handle instanceof ActionExpression;</span>
    }

    public boolean isAActionSequence(Object handle) {
<span class="nc" id="L248">        return handle instanceof ActionSequence;</span>
    }

    public boolean isAActionState(Object handle) {
<span class="nc" id="L252">        return handle instanceof ActionState;</span>
    }

    public boolean isACallState(Object handle) {
<span class="nc" id="L256">        return handle instanceof CallState;</span>
    }

    public boolean isAObjectFlowState(Object handle) {
<span class="nc" id="L260">        return handle instanceof ObjectFlowState;</span>
    }

    public boolean isAObjectNode(Object handle) {
        // NOT UML1.4
<span class="nc" id="L265">        return false;</span>
    }

    public boolean isASubactivityState(Object handle) {
<span class="nc" id="L269">        return handle instanceof SubactivityState;</span>
    }

    public boolean isAActor(Object handle) {
<span class="nc" id="L273">        return handle instanceof Actor;</span>
    }

    public boolean isAAggregationKind(Object handle) {
<span class="nc" id="L277">        return handle instanceof AggregationKind;</span>
    }

    public boolean isAAppliedProfileElement(Object handle) {
        // non existent in UML1
<span class="nc" id="L282">        return false;</span>
    }

    public boolean isAArgument(Object modelElement) {
<span class="nc" id="L286">        return modelElement instanceof Argument;</span>
    }

    public boolean isAArtifact(Object modelElement) {
<span class="nc" id="L290">        return modelElement instanceof Artifact;</span>
    }

    public boolean isAAssociation(Object handle) {
<span class="nc" id="L294">        return handle instanceof UmlAssociation;</span>
    }

    public boolean isAAssociationEnd(Object handle) {
<span class="nc" id="L298">        return handle instanceof AssociationEnd;</span>
    }

    public boolean isAAssociationRole(Object handle) {
<span class="nc" id="L302">        return handle instanceof AssociationRole;</span>
    }

    public boolean isAAssociationEndRole(Object handle) {
<span class="nc" id="L306">        return handle instanceof AssociationEndRole;</span>
    }

    public boolean isAAttribute(Object handle) {
<span class="nc" id="L310">        return handle instanceof Attribute;</span>
    }

    public boolean isAAttributeLink(Object handle) {
<span class="nc" id="L314">        return handle instanceof AttributeLink;</span>
    }

    public boolean isAsynchronous(Object handle) {
<span class="nc bnc" id="L318" title="All 2 branches missed.">        if (handle instanceof Action) {</span>
            try {
<span class="nc" id="L320">                return ((Action) handle).isAsynchronous();</span>
<span class="nc" id="L321">            } catch (InvalidObjectException e) {</span>
<span class="nc" id="L322">                throw new InvalidElementException(e);</span>
            }
        }
<span class="nc" id="L325">        return illegalArgumentBoolean(handle);</span>
    }


    public boolean isAbstract(Object handle) {
        try {
<span class="nc bnc" id="L331" title="All 2 branches missed.">            if (handle instanceof Operation) {</span>
<span class="nc" id="L332">                return ((Operation) handle).isAbstract();</span>
            }
<span class="nc bnc" id="L334" title="All 2 branches missed.">            if (handle instanceof GeneralizableElement) {</span>
<span class="nc" id="L335">                return ((GeneralizableElement) handle).isAbstract();</span>
            }
<span class="nc bnc" id="L337" title="All 2 branches missed.">            if (handle instanceof UmlAssociation) {</span>
<span class="nc" id="L338">                return ((UmlAssociation) handle).isAbstract();</span>
            }
<span class="nc bnc" id="L340" title="All 2 branches missed.">            if (handle instanceof Reception) {</span>
<span class="nc" id="L341">                return ((Reception) handle).isAbstract();</span>
            }
<span class="nc" id="L343">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L344">            throw new InvalidElementException(e);</span>
<span class="nc" id="L345">        }</span>
<span class="nc bnc" id="L346" title="All 2 branches missed.">        if (isAUMLElement(handle)) {</span>
<span class="nc" id="L347">            return false;</span>
        } else {
<span class="nc" id="L349">            return illegalArgumentBoolean(handle);</span>
        }
    }

    public boolean isAActivityEdge(Object handle) {
<span class="nc" id="L354">        return false; // Not in UML1.4</span>
    }

    public boolean isAActivityGraph(Object handle) {
<span class="nc" id="L358">        return handle instanceof ActivityGraph;</span>
    }

    public boolean isAActivityNode(Object handle) {
<span class="nc" id="L362">        return false; // Not in UML1.4</span>
    }

    public boolean isABehavioralFeature(Object handle) {
<span class="nc" id="L366">        return handle instanceof BehavioralFeature;</span>
    }

    public boolean isABinding(Object handle) {
<span class="nc" id="L370">        return handle instanceof Binding;</span>
    }

    public boolean isACallAction(Object handle) {
<span class="nc" id="L374">        return handle instanceof CallAction;</span>
    }

    public boolean isACallEvent(Object handle) {
<span class="nc" id="L378">        return handle instanceof CallEvent;</span>
    }

    public boolean isAChangeEvent(Object handle) {
<span class="nc" id="L382">        return handle instanceof ChangeEvent;</span>
    }

    public boolean isAClass(Object handle) {
<span class="nc" id="L386">        return handle instanceof UmlClass;</span>
    }

    public boolean isAAssociationClass(Object handle) {
<span class="nc" id="L390">        return handle instanceof AssociationClass;</span>
    }

    public boolean isAClassifier(Object handle) {
<span class="nc" id="L394">        return handle instanceof Classifier;</span>
    }

    public boolean isAClassifierInState(Object handle) {
<span class="nc" id="L398">        return handle instanceof ClassifierInState;</span>
    }

    public boolean isAClassifierRole(Object handle) {
<span class="nc" id="L402">        return handle instanceof ClassifierRole;</span>
    }

    public boolean isAComment(Object handle) {
<span class="nc" id="L406">        return handle instanceof Comment;</span>
    }

    public boolean isACollaboration(Object handle) {
<span class="nc" id="L410">        return handle instanceof Collaboration;</span>
    }

    public boolean isACollaborationInstanceSet(Object handle) {
<span class="nc" id="L414">        return handle instanceof CollaborationInstanceSet;</span>
    }

    public boolean isAComponent(Object handle) {
<span class="nc" id="L418">        return handle instanceof Component;</span>
    }

    public boolean isAComponentInstance(Object handle) {
<span class="nc" id="L422">        return handle instanceof ComponentInstance;</span>
    }

    public boolean isAComponentRealization(Object handle) {
<span class="nc" id="L426">        return false;</span>
    }

    public boolean isAConnector(Object handle) {
<span class="nc" id="L430">        return false;</span>
    }

    public boolean isAConnectorEnd(Object handle) {
<span class="nc" id="L434">        return false;</span>
    }

    public boolean isAConstraint(Object handle) {
<span class="nc" id="L438">        return handle instanceof Constraint;</span>
    }

    public boolean isACreateAction(Object handle) {
<span class="nc" id="L442">        return handle instanceof CreateAction;</span>
    }

    public boolean isADataType(Object handle) {
<span class="nc" id="L446">        return handle instanceof DataType;</span>
    }

    public boolean isADataValue(Object handle) {
<span class="nc" id="L450">        return handle instanceof DataValue;</span>
    }

    public boolean isADependency(Object handle) {
<span class="nc" id="L454">        return handle instanceof Dependency;</span>
    }

    public boolean isADestroyAction(Object handle) {
<span class="nc" id="L458">        return handle instanceof DestroyAction;</span>
    }

    public boolean isACompositeState(Object handle) {
<span class="nc" id="L462">        return handle instanceof CompositeState;</span>
    }

    public boolean isAElement(Object handle) {
<span class="nc" id="L466">        return handle instanceof Element;</span>
    }

    public boolean isAElementImport(Object handle) {
<span class="nc" id="L470">        return handle instanceof ElementImport;</span>
    }

    public boolean isAElementResidence(Object handle) {
<span class="nc" id="L474">        return handle instanceof ElementResidence;</span>
    }

    public boolean isAEvent(Object handle) {
<span class="nc" id="L478">        return handle instanceof Event;</span>
    }

    public boolean isAException(Object handle) {
<span class="nc" id="L482">        return handle instanceof UmlException;</span>
    }

    public boolean isAExpression(Object handle) {
<span class="nc" id="L486">        return handle instanceof Expression;</span>
    }

    public boolean isAExtend(Object handle) {
<span class="nc" id="L490">        return handle instanceof Extend;</span>
    }

    public boolean isAExtension(Object handle) {
<span class="nc" id="L494">        throw new NotImplementedException(</span>
        &quot;There are no extensions in UML 1.x&quot;);
    }

    public boolean isAExtensionPoint(Object handle) {
<span class="nc" id="L499">        return handle instanceof ExtensionPoint;</span>
    }

    public boolean isAFeature(Object handle) {
<span class="nc" id="L503">        return handle instanceof Feature;</span>
    }

    public boolean isAFinalState(Object handle) {
<span class="nc" id="L507">        return handle instanceof FinalState;</span>
    }

    public boolean isAFlow(Object handle) {
<span class="nc" id="L511">        return handle instanceof Flow;</span>
    }

    public boolean isAGuard(Object handle) {
<span class="nc" id="L515">        return handle instanceof Guard;</span>
    }

    public boolean isAGeneralizableElement(Object handle) {
<span class="nc" id="L519">        return handle instanceof GeneralizableElement;</span>
    }

    public boolean isAGeneralization(Object handle) {
<span class="nc" id="L523">        return handle instanceof Generalization;</span>
    }

    public boolean isAInclude(Object handle) {
<span class="nc" id="L527">        return handle instanceof Include;</span>
    }

    public boolean isAInstance(Object handle) {
<span class="nc" id="L531">        return handle instanceof Instance;</span>
    }

    public boolean isAInstanceSpecification(Object handle) {
<span class="nc" id="L535">        return false;</span>
    }

    public boolean isAInteraction(Object handle) {
<span class="nc" id="L539">        return handle instanceof Interaction;</span>
    }

    public boolean isAInteractionInstanceSet(Object handle) {
<span class="nc" id="L543">        return handle instanceof InteractionInstanceSet;</span>
    }

    public boolean isAInterface(Object handle) {
<span class="nc" id="L547">        return handle instanceof Interface;</span>
    }

    public boolean isALifeline(Object handle) {
<span class="nc" id="L551">        return handle instanceof ClassifierRole;</span>
    }

    public boolean isALink(Object handle) {
<span class="nc" id="L555">        return handle instanceof Link;</span>
    }

    public boolean isALinkEnd(Object handle) {
<span class="nc" id="L559">        return handle instanceof LinkEnd;</span>
    }

    public boolean isALinkObject(Object handle) {
<span class="nc" id="L563">        return handle instanceof LinkObject;</span>
    }

    public boolean isALiteralBoolean(Object handle) {
<span class="nc" id="L567">        return false;</span>
    }

    public boolean isALiteralInteger(Object handle) {
<span class="nc" id="L571">        return false;</span>
    }

    public boolean isALiteralString(Object handle) {
<span class="nc" id="L575">        return false;</span>
    }

    public boolean isAMessage(Object handle) {
<span class="nc" id="L579">        return handle instanceof Message;</span>
    }

    public boolean isAMethod(Object handle) {
<span class="nc" id="L583">        return handle instanceof Method;</span>
    }

    public boolean isAModel(Object handle) {
<span class="nc" id="L587">        return handle instanceof Model;</span>
    }

    public boolean isAModelElement(Object handle) {
<span class="nc" id="L591">        return handle instanceof ModelElement;</span>
    }

    public boolean isAMultiplicity(Object handle) {
<span class="nc" id="L595">        return handle instanceof Multiplicity;</span>
    }

    public boolean isAMultiplicityRange(Object handle) {
<span class="nc" id="L599">        return handle instanceof MultiplicityRange;</span>
    }

    public boolean isANamedElement(Object handle) {
<span class="nc" id="L603">        return handle instanceof ModelElement;</span>
    }

    public boolean isANamespace(Object handle) {
<span class="nc" id="L607">        return handle instanceof Namespace;</span>
    }

    public boolean isANaryAssociation(Object handle) {
<span class="nc bnc" id="L611" title="All 2 branches missed.">        if (handle instanceof UmlAssociation) {</span>
<span class="nc bnc" id="L612" title="All 2 branches missed.">            return (getConnections(handle).size() &gt; 2);</span>
        }
<span class="nc" id="L614">        return false;</span>
    }

    public boolean isANode(Object handle) {
<span class="nc" id="L618">        return handle instanceof Node;</span>
    }

    public boolean isANodeInstance(Object handle) {
<span class="nc" id="L622">        return handle instanceof NodeInstance;</span>
    }

    public boolean isAOperation(Object handle) {
<span class="nc" id="L626">        return handle instanceof Operation;</span>
    }

    public boolean isAOpaqueExpression(Object handle) {
<span class="nc" id="L630">        return false;</span>
    }

    public boolean isAObject(Object handle) {
<span class="nc" id="L634">        return handle</span>
            instanceof org.omg.uml.behavioralelements.commonbehavior.Object;
    }

    public boolean isAPackage(Object handle) {
<span class="nc" id="L639">        return handle instanceof UmlPackage;</span>
    }

    public boolean isAPackageImport(Object handle) {
<span class="nc" id="L643">        return handle instanceof Permission;</span>
    }

    public boolean isAParameter(Object handle) {
<span class="nc" id="L647">        return handle instanceof Parameter;</span>
    }

    public boolean isAPartition(Object handle) {
<span class="nc" id="L651">        return handle instanceof Partition;</span>
    }

    public boolean isAPort(Object handle) {
<span class="nc" id="L655">        return false;</span>
    }

    public boolean isAPrimitiveType(Object handle) {
<span class="nc" id="L659">        return handle instanceof Primitive;</span>
    }

    public boolean isAProfile(Object handle) {
<span class="nc bnc" id="L663" title="All 2 branches missed.">        if (handle instanceof Model) {</span>
<span class="nc bnc" id="L664" title="All 2 branches missed.">            for (Object stereo : getStereotypes(handle)) {</span>
<span class="nc" id="L665">                if (modelImpl.getExtensionMechanismsHelper()</span>
<span class="nc bnc" id="L666" title="All 2 branches missed.">                        .isStereotypeInh(stereo, &quot;profile&quot;,</span>
                                &quot;Package&quot;)) {
<span class="nc" id="L668">                    return true;</span>
                }
<span class="nc" id="L670">            }</span>
        }
<span class="nc" id="L672">        return false;</span>
    }

    public boolean isAProfileApplication(Object handle) {
<span class="nc" id="L676">        throw new NotImplementedException(</span>
        &quot;There are no profile application objects in UML 1.x&quot;);
    }

    public boolean isAProperty(Object handle) {
<span class="nc" id="L681">        throw new NotImplementedException(</span>
        &quot;There are no UML Property objects in UML 1.x&quot;);
    }

    public boolean isAPseudostate(Object handle) {
<span class="nc" id="L686">        return handle instanceof Pseudostate;</span>
    }

    public boolean isAPseudostateKind(Object handle) {
<span class="nc" id="L690">        return handle instanceof PseudostateKind;</span>
    }


    public Object getKind(Object handle) {
        try {
<span class="nc bnc" id="L696" title="All 2 branches missed.">            if (handle instanceof Pseudostate) {</span>
<span class="nc" id="L697">                return ((Pseudostate) handle).getKind();</span>
            }
<span class="nc bnc" id="L699" title="All 2 branches missed.">            if (handle instanceof Parameter) {</span>
<span class="nc" id="L700">                return ((Parameter) handle).getKind();</span>
            }
<span class="nc" id="L702">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L703">            throw new InvalidElementException(e);</span>
<span class="nc" id="L704">        }</span>
<span class="nc" id="L705">        return illegalArgumentObject(handle);</span>
    }


    public Object getReceiver(Object handle) {
        try {
<span class="nc bnc" id="L711" title="All 2 branches missed.">            if (handle instanceof Stimulus) {</span>
<span class="nc" id="L712">                return ((Stimulus) handle).getReceiver();</span>
            }
<span class="nc bnc" id="L714" title="All 2 branches missed.">            if (handle instanceof Message) {</span>
<span class="nc" id="L715">                return ((Message) handle).getReceiver();</span>
            }
<span class="nc" id="L717">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L718">            throw new InvalidElementException(e);</span>
<span class="nc" id="L719">        }</span>
<span class="nc" id="L720">        return illegalArgumentObject(handle);</span>
    }

    public Object getLifeline(Object handle) {
<span class="nc" id="L724">        throw new NotImplementedException(&quot;Not a UML1.4 element&quot;);</span>
    }

    public Object getLink(Object handle) {
        try {
<span class="nc bnc" id="L729" title="All 2 branches missed.">            if (handle instanceof LinkEnd) {</span>
<span class="nc" id="L730">                return ((LinkEnd) handle).getLink();</span>
            }
<span class="nc" id="L732">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L733">            throw new InvalidElementException(e);</span>
<span class="nc" id="L734">        }</span>
<span class="nc" id="L735">        return illegalArgumentObject(handle);</span>
    }


    public boolean equalsPseudostateKind(Object ps1, Object ps2) {
        try {
<span class="nc bnc" id="L741" title="All 2 branches missed.">            if (isAPseudostateKind(ps1)) {</span>
<span class="nc" id="L742">                return ((PseudostateKind) ps1).equals(ps2);</span>
            }
<span class="nc" id="L744">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L745">            throw new InvalidElementException(e);</span>
<span class="nc" id="L746">        }</span>
<span class="nc" id="L747">        return illegalArgumentBoolean(ps1);</span>
    }


    public boolean isAReception(Object handle) {
<span class="nc" id="L752">        return handle instanceof Reception;</span>
    }

    public boolean isARegion(Object handle) {
<span class="nc" id="L756">        return false; // Not in UML1.4</span>
    }

    public boolean isAReturnAction(Object handle) {
<span class="nc" id="L760">        return handle instanceof ReturnAction;</span>
    }

    public boolean isARelationship(Object handle) {
<span class="nc" id="L764">        return handle instanceof Relationship;</span>
    }

    public boolean isASendAction(Object handle) {
<span class="nc" id="L768">        return handle instanceof SendAction;</span>
    }

    public boolean isASendObjectAction(Object handle) {
<span class="nc" id="L772">        return false; // Not in UML1.4</span>
    }

    public boolean isASendSignalAction(Object handle) {
<span class="nc" id="L776">        return false; // Not in UML1.4</span>
    }

    public boolean isASignal(Object handle) {
<span class="nc" id="L780">        return handle instanceof Signal;</span>
    }

    public boolean isASignalEvent(Object handle) {
<span class="nc" id="L784">        return handle instanceof SignalEvent;</span>
    }

    public boolean isASimpleState(Object handle) {
<span class="nc" id="L788">        return handle instanceof SimpleState;</span>
    }

    public boolean isAStateMachine(Object handle) {
<span class="nc" id="L792">        return handle instanceof StateMachine;</span>
    }

    public boolean isAStimulus(Object handle) {
<span class="nc" id="L796">        return handle instanceof Stimulus;</span>
    }

    public boolean isAStateVertex(Object handle) {
<span class="nc" id="L800">        return handle instanceof StateVertex;</span>
    }

    public boolean isAVertex(Object handle) {
<span class="nc" id="L804">        return false; // not in UML1.4</span>
    }

    public boolean isAStereotype(Object handle) {
<span class="nc" id="L808">        return handle instanceof Stereotype;</span>
    }

    public boolean isAStructuralFeature(Object handle) {
<span class="nc" id="L812">        return handle instanceof StructuralFeature;</span>
    }

    public boolean isAState(Object handle) {
<span class="nc" id="L816">        return handle instanceof State;</span>
    }

    public boolean isAStubState(Object handle) {
<span class="nc" id="L820">        return handle instanceof StubState;</span>
    }

    public boolean isASubmachineState(Object handle) {
<span class="nc" id="L824">        return handle instanceof SubmachineState;</span>
    }

    public boolean isASubsystem(Object handle) {
<span class="nc" id="L828">        return handle instanceof Subsystem;</span>
    }

    public boolean isASubsystemInstance(Object handle) {
<span class="nc" id="L832">        return handle instanceof SubsystemInstance;</span>
    }

    public boolean isASynchState(Object handle) {
<span class="nc" id="L836">        return handle instanceof SynchState;</span>
    }

    public boolean isATaggedValue(Object handle) {
<span class="nc" id="L840">        return handle instanceof TaggedValue;</span>
    }

    public boolean isATemplateArgument(Object handle) {
<span class="nc" id="L844">        return handle instanceof TemplateArgument;</span>
    }

    public boolean isATemplateParameter(Object handle) {
<span class="nc" id="L848">        return handle instanceof TemplateParameter;</span>
    }

    public boolean isATransition(Object handle) {
<span class="nc" id="L852">        return handle instanceof Transition;</span>
    }

    public boolean isATrigger(Object handle) {
<span class="nc" id="L856">        return false; // not in UML1.4</span>
    }

    public boolean isATimeEvent(Object handle) {
<span class="nc" id="L860">        return handle instanceof TimeEvent;</span>
    }


    public boolean isAUMLElement(Object handle) {
<span class="pc bpc" id="L865" title="15 of 16 branches missed.">        return handle instanceof Element</span>
                || handle instanceof ElementImport
                || handle instanceof ElementResidence
                || handle instanceof Expression
                || handle instanceof Multiplicity
                || handle instanceof MultiplicityRange
                || handle instanceof TemplateArgument
                || handle instanceof TemplateParameter;
    }


    public boolean isAUninterpretedAction(Object handle) {
<span class="nc" id="L877">        return handle instanceof UninterpretedAction;</span>
    }

    public boolean isAUsage(Object handle) {
<span class="nc" id="L881">        return handle instanceof Usage;</span>
    }

    public boolean isAUseCase(Object handle) {
<span class="nc" id="L885">        return handle instanceof UseCase;</span>
    }


    public boolean isAVisibilityKind(Object handle) {
<span class="nc" id="L890">        return handle instanceof VisibilityKind;</span>
    }


    public boolean isActive(Object handle) {
        try {
<span class="nc bnc" id="L896" title="All 2 branches missed.">            if (handle instanceof UmlClass) {</span>
<span class="nc" id="L897">                return ((UmlClass) handle).isActive();</span>
            }
<span class="nc" id="L899">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L900">            throw new InvalidElementException(e);</span>
<span class="nc" id="L901">        }</span>
<span class="nc" id="L902">        return illegalArgumentBoolean(handle);</span>
    }


    public boolean isConcurrent(Object handle) {
        try {
<span class="nc bnc" id="L908" title="All 2 branches missed.">            if (handle instanceof CompositeState) {</span>
<span class="nc" id="L909">                return ((CompositeState) handle).isConcurrent();</span>
            }
<span class="nc" id="L911">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L912">            throw new InvalidElementException(e);</span>
<span class="nc" id="L913">        }</span>
<span class="nc" id="L914">        return illegalArgumentBoolean(handle);</span>
    }


    public boolean isAConcurrentRegion(Object handle) {
        try {
<span class="nc bnc" id="L920" title="All 2 branches missed.">            if ((handle instanceof CompositeState)</span>
<span class="nc bnc" id="L921" title="All 2 branches missed.">                    &amp;&amp; (getContainer(handle) != null)) {</span>
<span class="nc" id="L922">                return (isConcurrent(getContainer(handle)));</span>
            }
<span class="nc" id="L924">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L925">            throw new InvalidElementException(e);</span>
<span class="nc" id="L926">        }</span>
<span class="nc" id="L927">        return false;</span>
    }


    public boolean isConstructor(Object handle) {
        try {
<span class="nc" id="L933">            Operation operation = null;</span>
<span class="nc bnc" id="L934" title="All 2 branches missed.">            if (handle instanceof Method) {</span>
<span class="nc" id="L935">                operation = ((Method) handle).getSpecification();</span>
<span class="nc bnc" id="L936" title="All 2 branches missed.">                if (operation == null) {</span>
                    // This is not a well formed model in a strict sense.
                    // See the multiplicity in UML 1.3 Figure 2-5.
<span class="nc" id="L939">                    return false;</span>
                }
<span class="nc bnc" id="L941" title="All 2 branches missed.">            } else if (handle instanceof Operation) {</span>
<span class="nc" id="L942">                operation = (Operation) handle;</span>
            } else {
<span class="nc" id="L944">                return illegalArgumentBoolean(handle);</span>
            }

<span class="nc bnc" id="L947" title="All 2 branches missed.">            for (Object stereo : getStereotypes(operation)) {</span>
<span class="nc" id="L948">                if (modelImpl.getExtensionMechanismsHelper()</span>
<span class="nc bnc" id="L949" title="All 2 branches missed.">                        .isStereotypeInh(stereo, &quot;create&quot;,</span>
                                &quot;BehavioralFeature&quot;)) {
<span class="nc" id="L951">                    return true;</span>
                }
<span class="nc" id="L953">            }</span>
<span class="nc" id="L954">            return false;</span>
<span class="nc" id="L955">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L956">            throw new InvalidElementException(e);</span>
        }
    }


    public boolean isFrozen(Object handle) {
        try {
<span class="nc bnc" id="L963" title="All 2 branches missed.">            if (handle instanceof ChangeableKind) {</span>
<span class="nc" id="L964">                ChangeableKind ck = (ChangeableKind) handle;</span>
<span class="nc" id="L965">                return ChangeableKindEnum.CK_FROZEN.equals(ck);</span>
            }
<span class="nc bnc" id="L967" title="All 2 branches missed.">            if (handle instanceof AssociationEnd) {</span>
<span class="nc" id="L968">                return ChangeableKindEnum.CK_FROZEN</span>
<span class="nc" id="L969">                        .equals(((AssociationEnd) handle).getChangeability());</span>
            }
<span class="nc" id="L971">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L972">            throw new InvalidElementException(e);</span>
<span class="nc" id="L973">        }</span>
<span class="nc" id="L974">        return illegalArgumentBoolean(handle);</span>
    }


    public boolean isComposite(Object handle) {
        try {
<span class="nc bnc" id="L980" title="All 2 branches missed.">            if (handle instanceof AssociationEnd) {</span>
<span class="nc" id="L981">                return AggregationKindEnum.AK_COMPOSITE</span>
<span class="nc" id="L982">                .equals(((AssociationEnd) handle).getAggregation());</span>
            }
<span class="nc" id="L984">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L985">            throw new InvalidElementException(e);</span>
<span class="nc" id="L986">        }</span>
<span class="nc" id="L987">        return illegalArgumentBoolean(handle);</span>
    }


    public boolean isAggregate(Object handle) {
        try {
<span class="nc bnc" id="L993" title="All 2 branches missed.">            if (handle instanceof AssociationEnd) {</span>
<span class="nc" id="L994">                return AggregationKindEnum.AK_AGGREGATE</span>
<span class="nc" id="L995">                        .equals(((AssociationEnd) handle).getAggregation());</span>
            }
<span class="nc" id="L997">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L998">            throw new InvalidElementException(e);</span>
<span class="nc" id="L999">        }</span>
<span class="nc" id="L1000">        return illegalArgumentBoolean(handle);</span>
    }


    public boolean isInitialized(Object handle) {
        try {
<span class="nc bnc" id="L1006" title="All 2 branches missed.">            if (handle instanceof Attribute) {</span>
<span class="nc" id="L1007">                Expression init = ((Attribute) handle).getInitialValue();</span>

<span class="nc bnc" id="L1009" title="All 4 branches missed.">                if (init != null &amp;&amp; init.getBody() != null</span>
<span class="nc bnc" id="L1010" title="All 2 branches missed.">                        &amp;&amp; init.getBody().trim().length() &gt; 0) {</span>
<span class="nc" id="L1011">                    return true;</span>
                }
<span class="nc" id="L1013">                return false;</span>
            }
<span class="nc" id="L1015">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1016">            throw new InvalidElementException(e);</span>
<span class="nc" id="L1017">        }</span>
<span class="nc" id="L1018">        return illegalArgumentBoolean(handle);</span>
    }


    public boolean isInternal(Object handle) {
        try {
<span class="nc bnc" id="L1024" title="All 2 branches missed.">            if (handle instanceof Transition) {</span>
<span class="nc" id="L1025">                Object state = getState(handle);</span>
<span class="nc" id="L1026">                Object end0 = getSource(handle);</span>
<span class="nc" id="L1027">                Object end1 = getTarget(handle);</span>
<span class="nc bnc" id="L1028" title="All 2 branches missed.">                if (end0 != null) {</span>
<span class="nc bnc" id="L1029" title="All 4 branches missed.">                    return ((state == end0) &amp;&amp; (state == end1));</span>
                }
            }
<span class="nc" id="L1032">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1033">            throw new InvalidElementException(e);</span>
<span class="nc" id="L1034">        }</span>
<span class="nc" id="L1035">        return illegalArgumentBoolean(handle);</span>
    }


    public boolean isLeaf(Object handle) {
        try {
<span class="nc bnc" id="L1041" title="All 2 branches missed.">            if (handle instanceof GeneralizableElement) {</span>
<span class="nc" id="L1042">                return ((GeneralizableElement) handle).isLeaf();</span>
            }
<span class="nc bnc" id="L1044" title="All 2 branches missed.">            if (handle instanceof Operation) {</span>
<span class="nc" id="L1045">                return ((Operation) handle).isLeaf();</span>
            }
<span class="nc bnc" id="L1047" title="All 2 branches missed.">            if (handle instanceof Reception) {</span>
<span class="nc" id="L1048">                return ((Reception) handle).isLeaf();</span>
            }
<span class="nc" id="L1050">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1051">            throw new InvalidElementException(e);</span>
<span class="nc" id="L1052">        }</span>
<span class="nc bnc" id="L1053" title="All 2 branches missed.">        if (isAUMLElement(handle)) {</span>
<span class="nc" id="L1054">            return false;</span>
        } else {
<span class="nc" id="L1056">            return illegalArgumentBoolean(handle);</span>
        }
    }


    public boolean isRoot(Object handle) {
        try {
<span class="nc bnc" id="L1063" title="All 2 branches missed.">            if (handle instanceof GeneralizableElement) {</span>
<span class="nc" id="L1064">                return ((GeneralizableElement) handle).isRoot();</span>
            }
<span class="nc bnc" id="L1066" title="All 2 branches missed.">            if (handle instanceof Operation) {</span>
<span class="nc" id="L1067">                return ((Operation) handle).isRoot();</span>
            }
<span class="nc bnc" id="L1069" title="All 2 branches missed.">            if (handle instanceof Reception) {</span>
<span class="nc" id="L1070">                return ((Reception) handle).isRoot();</span>
            }
<span class="nc" id="L1072">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1073">            throw new InvalidElementException(e);</span>
<span class="nc" id="L1074">        }</span>
<span class="nc bnc" id="L1075" title="All 2 branches missed.">        if (isAUMLElement(handle)) {</span>
<span class="nc" id="L1076">            return false;</span>
        } else {
<span class="nc" id="L1078">            return illegalArgumentBoolean(handle);</span>
        }
    }


    public boolean isSpecification(Object handle) {
        try {
<span class="nc bnc" id="L1085" title="All 2 branches missed.">            if (handle instanceof ModelElement) {</span>
<span class="nc" id="L1086">                return ((ModelElement) handle).isSpecification();</span>
            }
<span class="nc bnc" id="L1088" title="All 2 branches missed.">            if (handle instanceof ElementImport) {</span>
<span class="nc" id="L1089">                return ((ElementImport) handle).isSpecification();</span>
            }
<span class="nc" id="L1091">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1092">            throw new InvalidElementException(e);</span>
<span class="nc" id="L1093">        }</span>
<span class="nc" id="L1094">        return illegalArgumentBoolean(handle);</span>
    }

    public boolean isNavigable(Object handle) {
        try {
<span class="nc bnc" id="L1099" title="All 2 branches missed.">            if (handle instanceof AssociationEnd) {</span>
<span class="nc" id="L1100">                return ((AssociationEnd) handle).isNavigable();</span>
            }
<span class="nc" id="L1102">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1103">            throw new InvalidElementException(e);</span>
<span class="nc" id="L1104">        }</span>
<span class="nc" id="L1105">        return illegalArgumentBoolean(handle);</span>
    }

    public boolean isOrthogonal(Object handle) {
<span class="nc" id="L1109">        throw new NotImplementedException(</span>
                &quot;Orthogonal is not a UML1.4 property&quot;);
    }

    public boolean isPrimaryObject(Object handle) {
        try {
<span class="nc bnc" id="L1115" title="All 2 branches missed.">            if (handle instanceof ModelElement) {</span>
                for (TaggedValue tv
<span class="nc bnc" id="L1117" title="All 2 branches missed.">                        : ((ModelElement) handle).getTaggedValue()) {</span>
<span class="nc" id="L1118">                    TagDefinition type = tv.getType();</span>
<span class="nc bnc" id="L1119" title="All 2 branches missed.">                    if (type != null</span>
<span class="nc bnc" id="L1120" title="All 2 branches missed.">                            &amp;&amp; GENERATED_TAG.equals(type.getTagType())) {</span>
<span class="nc" id="L1121">                        return false;</span>
                    }
<span class="nc" id="L1123">                }</span>
<span class="nc" id="L1124">                return true;</span>
            }
<span class="nc" id="L1126">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1127">            throw new InvalidElementException(e);</span>
<span class="nc" id="L1128">        }</span>
<span class="nc" id="L1129">        return illegalArgumentBoolean(handle);</span>
    }


    public boolean isPackage(Object handle) {
        try {
<span class="nc bnc" id="L1135" title="All 2 branches missed.">            if (handle instanceof ModelElement) {</span>
<span class="nc" id="L1136">                ModelElement element = (ModelElement) handle;</span>
<span class="nc" id="L1137">                return VisibilityKindEnum.VK_PACKAGE.equals(</span>
<span class="nc" id="L1138">                        element.getVisibility());</span>
            }
<span class="nc" id="L1140">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1141">            throw new InvalidElementException(e);</span>
<span class="nc" id="L1142">        }</span>
<span class="nc" id="L1143">        return illegalArgumentBoolean(handle);</span>
    }


    public boolean isPrivate(Object handle) {
        try {
<span class="nc bnc" id="L1149" title="All 2 branches missed.">            if (handle instanceof ModelElement) {</span>
<span class="nc" id="L1150">                ModelElement elem = (ModelElement) handle;</span>
<span class="nc" id="L1151">                return VisibilityKindEnum.VK_PRIVATE</span>
<span class="nc" id="L1152">                    .equals(elem.getVisibility());</span>
            }
<span class="nc" id="L1154">            return illegalArgumentBoolean(handle);</span>
<span class="nc" id="L1155">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1156">            throw new InvalidElementException(e);</span>
        }
    }


    public boolean isPublic(Object handle) {
        try {
<span class="nc bnc" id="L1163" title="All 2 branches missed.">            if (handle instanceof ModelElement) {</span>
<span class="nc" id="L1164">                ModelElement elem = (ModelElement) handle;</span>
<span class="nc" id="L1165">                return VisibilityKindEnum.VK_PUBLIC</span>
<span class="nc" id="L1166">                    .equals(elem.getVisibility());</span>
            }
<span class="nc" id="L1168">            return illegalArgumentBoolean(handle);</span>
<span class="nc" id="L1169">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1170">            throw new InvalidElementException(e);</span>
        }
    }


    public boolean isQuery(Object handle) {
        try {
<span class="nc bnc" id="L1177" title="All 2 branches missed.">            if (handle instanceof BehavioralFeature) {</span>
<span class="nc" id="L1178">                return ((BehavioralFeature) handle).isQuery();</span>
            }
<span class="nc" id="L1180">            return illegalArgumentBoolean(handle);</span>
<span class="nc" id="L1181">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1182">            throw new InvalidElementException(e);</span>
        }
    }


    public boolean isProtected(Object handle) {
        try {
<span class="nc bnc" id="L1189" title="All 2 branches missed.">            if (handle instanceof ModelElement) {</span>
<span class="nc" id="L1190">                ModelElement elem = (ModelElement) handle;</span>
<span class="nc" id="L1191">                return VisibilityKindEnum.VK_PROTECTED</span>
<span class="nc" id="L1192">                    .equals(elem.getVisibility());</span>
            }
<span class="nc" id="L1194">            return illegalArgumentBoolean(handle);</span>
<span class="nc" id="L1195">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1196">            throw new InvalidElementException(e);</span>
        }
    }


    public boolean isRealize(Object handle) {
<span class="nc" id="L1202">        return isStereotype(handle, CoreFactory.REALIZE_STEREOTYPE);</span>
    }


    public boolean isReturn(Object handle) {
<span class="nc" id="L1207">        return hasReturnParameterDirectionKind(handle);</span>
    }


    public boolean isSingleton(Object handle) {
<span class="nc" id="L1212">        return isStereotype(handle, &quot;singleton&quot;);</span>
    }


    public boolean isStereotype(Object handle, String stereotypeName) {
        try {
<span class="nc bnc" id="L1218" title="All 2 branches missed.">            if (handle instanceof ModelElement) {</span>
<span class="nc" id="L1219">                Collection stereotypes =</span>
<span class="nc" id="L1220">                    ((ModelElement) handle).getStereotype();</span>
<span class="nc" id="L1221">                Iterator it = stereotypes.iterator();</span>
                Stereotype stereotype;
<span class="nc bnc" id="L1223" title="All 2 branches missed.">                while (it.hasNext()) {</span>
<span class="nc" id="L1224">                    stereotype = (Stereotype) it.next();</span>
<span class="nc bnc" id="L1225" title="All 2 branches missed.">                    if (stereotypeName.equals(stereotype.getName())) {</span>
<span class="nc" id="L1226">                        return true;</span>
                    }
                }
<span class="nc" id="L1229">                return false;</span>
            }
<span class="nc" id="L1231">            return illegalArgumentBoolean(handle);</span>
<span class="nc" id="L1232">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1233">            throw new InvalidElementException(e);</span>
        }
    }


    public boolean isATerminateAction(Object handle) {
<span class="nc" id="L1239">        return handle instanceof TerminateAction;</span>
    }


    public boolean isTop(Object handle) {
        try {
<span class="nc bnc" id="L1245" title="All 2 branches missed.">            if (isACompositeState(handle)) {</span>
<span class="nc bnc" id="L1246" title="All 2 branches missed.">                return ((CompositeState) handle).getStateMachine() != null;</span>
            }
<span class="nc" id="L1248">            return illegalArgumentBoolean(handle);</span>
<span class="nc" id="L1249">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1250">            throw new InvalidElementException(e);</span>
        }
    }


    public boolean isType(Object handle) {
<span class="nc" id="L1256">        return isStereotype(handle, &quot;type&quot;);</span>
    }

    public boolean isUtility(Object handle) {
<span class="nc" id="L1260">        return isStereotype(handle, &quot;utility&quot;);</span>
    }


    public Object getAssociation(Object handle) {
        try {
<span class="nc bnc" id="L1266" title="All 2 branches missed.">            if (handle instanceof AssociationEnd) {</span>
<span class="nc" id="L1267">                return ((AssociationEnd) handle).getAssociation();</span>
            }
<span class="nc bnc" id="L1269" title="All 2 branches missed.">            if (handle instanceof Link) {</span>
<span class="nc" id="L1270">                return ((Link) handle).getAssociation();</span>
            }
<span class="nc" id="L1272">            return illegalArgumentObject(handle);</span>
<span class="nc" id="L1273">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1274">            throw new InvalidElementException(e);</span>
        }
    }


    public Object getAssociationEnd(Object handle, Object assoc) {
        try {
<span class="nc bnc" id="L1281" title="All 4 branches missed.">            if (handle instanceof Classifier</span>
                    &amp;&amp; assoc instanceof UmlAssociation) {
<span class="nc" id="L1283">                Classifier classifier = (Classifier) handle;</span>
<span class="nc" id="L1284">                Iterator it = getAssociationEnds(classifier).iterator();</span>
<span class="nc bnc" id="L1285" title="All 2 branches missed.">                while (it.hasNext()) {</span>
<span class="nc" id="L1286">                    AssociationEnd end = (AssociationEnd) it.next();</span>
<span class="nc" id="L1287">                    if (((UmlAssociation) assoc).getConnection()</span>
<span class="nc bnc" id="L1288" title="All 2 branches missed.">                            .contains(end)) {</span>
<span class="nc" id="L1289">                        return end;</span>
                    }
<span class="nc" id="L1291">                }</span>
<span class="nc" id="L1292">                return null;</span>
            }
<span class="nc" id="L1294">            throw new IllegalArgumentException(&quot;handle: &quot; + handle + &quot;,assoc: &quot;</span>
                    + assoc);
<span class="nc" id="L1296">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1297">            throw new InvalidElementException(e);</span>
        }
    }


    /**
     * Helper method to get a reference to the outermost package.
     *
     * @param handle the handle.
     * @return The outermost package.
     */
    private org.omg.uml.UmlPackage getRefOutermostPackage(Object handle) {
<span class="nc" id="L1309">        final RefPackage refPackage =</span>
<span class="nc" id="L1310">            ((ModelElement) handle).refOutermostPackage();</span>
<span class="nc" id="L1311">        return (org.omg.uml.UmlPackage) refPackage;</span>
    }

    public Collection getAssociations(Object handle) {
<span class="nc" id="L1315">        throw new NotImplementedException(&quot;Not available for UML1.4&quot;);</span>
    }

    public Collection getAssociationEnds(Object handle) {
        try {
<span class="nc bnc" id="L1320" title="All 2 branches missed.">            if (handle instanceof Classifier) {</span>
<span class="nc" id="L1321">                return getRefOutermostPackage(handle).getCore()</span>
<span class="nc" id="L1322">                        .getAParticipantAssociation().getAssociation(</span>
                                (Classifier) handle);
            }
<span class="nc" id="L1325">            return illegalArgumentCollection(handle);</span>
<span class="nc" id="L1326">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1327">            throw new InvalidElementException(e);</span>
        }
    }

    public Collection getAssociationRoles(Object handle) {
        try {
<span class="nc bnc" id="L1333" title="All 2 branches missed.">            if (handle instanceof UmlAssociation) {</span>
<span class="nc" id="L1334">                return getRefOutermostPackage(handle).getCollaborations()</span>
<span class="nc" id="L1335">                        .getABaseAssociationRole().getAssociationRole(</span>
                                (UmlAssociation) handle);
            }
<span class="nc" id="L1338">            return illegalArgumentCollection(handle);</span>
<span class="nc" id="L1339">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1340">            throw new InvalidElementException(e);</span>
        }
    }

    public List getAttributes(Object handle) {
        try {
<span class="nc bnc" id="L1346" title="All 2 branches missed.">            if (handle instanceof Classifier) {</span>
<span class="nc" id="L1347">                return getStructuralFeatures(handle);</span>
            }
<span class="nc" id="L1349">            return illegalArgumentList(handle);</span>
<span class="nc" id="L1350">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1351">            throw new InvalidElementException(e);</span>
        }
    }


    public Collection&lt;String&gt; getBaseClasses(Object handle) {
        try {
<span class="nc bnc" id="L1358" title="All 2 branches missed.">            if (isAStereotype(handle)) {</span>
<span class="nc" id="L1359">                return ((Stereotype) handle).getBaseClass();</span>
            }
<span class="nc" id="L1361">            return illegalArgumentCollection(handle);</span>
<span class="nc" id="L1362">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1363">            throw new InvalidElementException(e);</span>
        }
    }


    public Object getBase(Object handle) {
        try {
<span class="nc bnc" id="L1370" title="All 2 branches missed.">            if (handle instanceof AssociationEndRole) {</span>
<span class="nc" id="L1371">                return ((AssociationEndRole) handle).getBase();</span>
<span class="nc bnc" id="L1372" title="All 2 branches missed.">            } else if (handle instanceof AssociationRole) {</span>
<span class="nc" id="L1373">                return ((AssociationRole) handle).getBase();</span>
<span class="nc bnc" id="L1374" title="All 2 branches missed.">            } else if (handle instanceof Extend) {</span>
<span class="nc" id="L1375">                return ((Extend) handle).getBase();</span>
<span class="nc bnc" id="L1376" title="All 2 branches missed.">            } else if (handle instanceof Include) {</span>
<span class="nc" id="L1377">                return ((Include) handle).getBase();</span>
<span class="nc bnc" id="L1378" title="All 2 branches missed.">            } else if (handle instanceof ClassifierRole) {</span>
                // TODO: this returns a Collection, not a single Object
                // Is this what the callers expect?
<span class="nc" id="L1381">                return ((ClassifierRole) handle).getBase();</span>
            }
<span class="nc" id="L1383">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1384">            throw new InvalidElementException(e);</span>
<span class="nc" id="L1385">        }</span>
<span class="nc" id="L1386">        return illegalArgumentObject(handle);</span>
    }


    public Collection&lt;Classifier&gt; getBases(Object handle) {
        try {
<span class="nc bnc" id="L1392" title="All 2 branches missed.">            if (handle instanceof ClassifierRole) {</span>
<span class="nc" id="L1393">                return ((ClassifierRole) handle).getBase();</span>
            }
<span class="nc" id="L1395">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1396">            throw new InvalidElementException(e);</span>
<span class="nc" id="L1397">        }</span>
<span class="nc" id="L1398">        return illegalArgumentCollection(handle);</span>
    }


    public Collection getBehaviors(Object handle) {
        try {
<span class="nc bnc" id="L1404" title="All 2 branches missed.">            if (handle instanceof ModelElement) {</span>
<span class="nc" id="L1405">                return getRefOutermostPackage(handle)</span>
<span class="nc" id="L1406">                        .getStateMachines().getABehaviorContext().getBehavior(</span>
                                (ModelElement) handle);
            }
<span class="nc" id="L1409">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1410">            throw new InvalidElementException(e);</span>
<span class="nc" id="L1411">        }</span>
<span class="nc" id="L1412">        return illegalArgumentCollection(handle);</span>
    }


    public Object getBehavioralFeature(Object handle) {
        try {
<span class="nc bnc" id="L1418" title="All 2 branches missed.">            if (handle instanceof Parameter) {</span>
<span class="nc" id="L1419">                return ((Parameter) handle).getBehavioralFeature();</span>
            }
<span class="nc" id="L1421">            return illegalArgumentCollection(handle);</span>
<span class="nc" id="L1422">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1423">            throw new InvalidElementException(e);</span>
        }
    }


    public Object getBody(Object handle) {
        try {
<span class="nc bnc" id="L1430" title="All 2 branches missed.">            if (handle instanceof Comment) {</span>
                // Text was stored in name in UML 1.3
<span class="nc" id="L1432">                return ((Comment) handle).getBody();</span>
            }
<span class="nc bnc" id="L1434" title="All 2 branches missed.">            if (handle instanceof Constraint) {</span>
<span class="nc" id="L1435">                return ((Constraint) handle).getBody();</span>
            }
<span class="nc bnc" id="L1437" title="All 2 branches missed.">            if (handle instanceof Expression) {</span>
<span class="nc" id="L1438">                return ((Expression) handle).getBody();</span>
            }
<span class="nc bnc" id="L1440" title="All 2 branches missed.">            if (handle instanceof Method) {</span>
<span class="nc" id="L1441">                return ((Method) handle).getBody();</span>
            }
<span class="nc" id="L1443">            return illegalArgumentObject(handle);</span>
<span class="nc" id="L1444">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1445">            throw new InvalidElementException(e);</span>
        }
    }


    public int getBound(Object handle) {
        try {
<span class="nc bnc" id="L1452" title="All 2 branches missed.">            if (handle instanceof SynchState) {</span>
<span class="nc" id="L1453">                return ((SynchState) handle).getBound();</span>
            }
<span class="nc" id="L1455">            return illegalArgumentInt(handle);</span>
<span class="nc" id="L1456">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1457">            throw new InvalidElementException(e);</span>
        }
    }


    @Deprecated
    public Object getChangeability(Object handle) {
        try {
<span class="nc bnc" id="L1465" title="All 2 branches missed.">            if (handle instanceof StructuralFeature) {</span>
<span class="nc" id="L1466">                return ((StructuralFeature) handle).getChangeability();</span>
            }
<span class="nc bnc" id="L1468" title="All 2 branches missed.">            if (handle instanceof AssociationEnd) {</span>
<span class="nc" id="L1469">                return ((AssociationEnd) handle).getChangeability();</span>
            }
<span class="nc" id="L1471">            return illegalArgumentObject(handle);</span>
<span class="nc" id="L1472">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1473">            throw new InvalidElementException(e);</span>
        }
    }


    public boolean isReadOnly(Object handle) {
        ChangeableKind ck;
        try {
<span class="nc bnc" id="L1481" title="All 2 branches missed.">            if (handle instanceof StructuralFeature) {</span>
<span class="nc" id="L1482">                ck = ((StructuralFeature) handle).getChangeability();</span>
<span class="nc bnc" id="L1483" title="All 2 branches missed.">            } else if (handle instanceof AssociationEnd) {</span>
<span class="nc" id="L1484">                ck = ((AssociationEnd) handle).getChangeability();</span>
            } else {
<span class="nc" id="L1486">                return illegalArgumentBoolean(handle);</span>
            }
<span class="nc" id="L1488">            return ChangeableKindEnum.CK_FROZEN.equals(ck);</span>
<span class="nc" id="L1489">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1490">            throw new InvalidElementException(e);</span>
        }
    }

    public Object getSpecific(Object handle) {
        try {
<span class="nc bnc" id="L1496" title="All 2 branches missed.">            if (handle instanceof Generalization) {</span>
<span class="nc" id="L1497">                return ((Generalization) handle).getChild();</span>
            }
<span class="nc" id="L1499">            return illegalArgumentObject(handle);</span>
<span class="nc" id="L1500">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1501">            throw new InvalidElementException(e);</span>
        }
    }


    public Collection&lt;GeneralizableElement&gt; getChildren(Object handle) {
        try {
<span class="nc" id="L1508">            return modelImpl.getCoreHelper().getChildren(handle);</span>
<span class="nc" id="L1509">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1510">            throw new InvalidElementException(e);</span>
        }
    }


    public Collection getClassifierRoles(Object handle) {
        try {
<span class="nc bnc" id="L1517" title="All 2 branches missed.">            if (handle instanceof Feature) {</span>
<span class="nc" id="L1518">                return getRefOutermostPackage(handle).getCollaborations()</span>
<span class="nc" id="L1519">                        .getAClassifierRoleAvailableFeature()</span>
<span class="nc" id="L1520">                        .getClassifierRole((Feature) handle);</span>
            }
<span class="nc bnc" id="L1522" title="All 2 branches missed.">            if (handle instanceof Classifier) {</span>
<span class="nc" id="L1523">                return getRefOutermostPackage(handle).getCollaborations()</span>
<span class="nc" id="L1524">                        .getAClassifierRoleBase().getClassifierRole(</span>
                                (Classifier) handle);
            }
<span class="nc" id="L1527">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1528">            throw new InvalidElementException(e);</span>
<span class="nc" id="L1529">        }</span>
<span class="nc" id="L1530">        return illegalArgumentCollection(handle);</span>
    }


    public Object getClassifier(Object handle) {
        try {
<span class="nc bnc" id="L1536" title="All 2 branches missed.">            if (isAAssociationEnd(handle)) {</span>
<span class="nc" id="L1537">                return ((AssociationEnd) handle).getParticipant();</span>
            }
<span class="nc" id="L1539">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1540">            throw new InvalidElementException(e);</span>
<span class="nc" id="L1541">        }</span>
<span class="nc" id="L1542">        return illegalArgumentObject(handle);</span>
    }


    public Collection&lt;Classifier&gt; getClassifiers(Object handle) {
        try {
<span class="nc bnc" id="L1548" title="All 2 branches missed.">            if (handle instanceof Instance) {</span>
<span class="nc" id="L1549">                return ((Instance) handle).getClassifier();</span>
            }
<span class="nc" id="L1551">            return illegalArgumentCollection(handle);</span>
<span class="nc" id="L1552">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1553">            throw new InvalidElementException(e);</span>
        }
    }


    public Collection getClassifiersInState(Object handle) {
        try {
<span class="nc bnc" id="L1560" title="All 2 branches missed.">            if (handle instanceof Classifier) {</span>
<span class="nc" id="L1561">                return getRefOutermostPackage(handle).getActivityGraphs()</span>
<span class="nc" id="L1562">                        .getATypeClassifierInState().getClassifierInState(</span>
                                (Classifier) handle);
            }
<span class="nc bnc" id="L1565" title="All 2 branches missed.">            if (handle instanceof State) {</span>
<span class="nc" id="L1566">                return getRefOutermostPackage(handle).getActivityGraphs()</span>
<span class="nc" id="L1567">                        .getAClassifierInStateInState().getClassifierInState(</span>
                                (State) handle);
            }
<span class="nc" id="L1570">            return illegalArgumentCollection(handle);</span>
<span class="nc" id="L1571">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1572">            throw new InvalidElementException(e);</span>
        }
    }


    public Collection&lt;ModelElement&gt; getClients(Object handle) {
        try {
<span class="nc bnc" id="L1579" title="All 2 branches missed.">            if (isADependency(handle)) {</span>
<span class="nc" id="L1580">                return ((Dependency) handle).getClient();</span>
            }
<span class="nc" id="L1582">            return illegalArgumentCollection(handle);</span>
<span class="nc" id="L1583">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1584">            throw new InvalidElementException(e);</span>
        }
    }


    public Collection&lt;Dependency&gt; getClientDependencies(Object handle) {
        try {
<span class="nc bnc" id="L1591" title="All 2 branches missed.">            if (handle instanceof ModelElement) {</span>
<span class="nc" id="L1592">                final ModelElement me = (ModelElement) handle;</span>
<span class="nc" id="L1593">                return Collections.unmodifiableCollection(</span>
<span class="nc" id="L1594">                        me.getClientDependency());</span>
            }
<span class="nc" id="L1596">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1597">            throw new InvalidElementException(e);</span>
<span class="nc" id="L1598">        }</span>
<span class="nc" id="L1599">        throw new IllegalArgumentException(&quot;Expected a ModelElement. Got a &quot;</span>
<span class="nc" id="L1600">                + handle.getClass().getName());</span>
    }


    public Object getCondition(Object handle) {
        try {
<span class="nc bnc" id="L1606" title="All 2 branches missed.">            if (handle instanceof Extend) {</span>
<span class="nc" id="L1607">                return ((Extend) handle).getCondition();</span>
            }
<span class="nc" id="L1609">            return illegalArgumentObject(handle);</span>
<span class="nc" id="L1610">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1611">            throw new InvalidElementException(e);</span>
        }
    }


    public Object getConcurrency(Object handle) {
        try {
<span class="nc bnc" id="L1618" title="All 2 branches missed.">            if (handle instanceof Operation) {</span>
<span class="nc" id="L1619">                return ((Operation) handle).getConcurrency();</span>
            }
<span class="nc" id="L1621">            return illegalArgumentObject(handle);</span>
<span class="nc" id="L1622">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1623">            throw new InvalidElementException(e);</span>
        }
    }


    public Collection getConnections(Object handle) {
        try {
<span class="nc bnc" id="L1630" title="All 2 branches missed.">            if (handle instanceof UmlAssociation) {</span>
                // returns List
<span class="nc" id="L1632">                return ((UmlAssociation) handle).getConnection();</span>
            }
<span class="nc bnc" id="L1634" title="All 2 branches missed.">            if (handle instanceof Link) {</span>
<span class="nc" id="L1635">                return ((Link) handle).getConnection();</span>
            }
<span class="nc" id="L1637">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1638">            throw new InvalidElementException(e);</span>
<span class="nc" id="L1639">        }</span>
<span class="nc" id="L1640">        return illegalArgumentCollection(handle);</span>
    }


    public Object getEffect(Object handle) {
        try {
<span class="nc bnc" id="L1646" title="All 2 branches missed.">            if (handle instanceof Transition) {</span>
<span class="nc" id="L1647">                return ((Transition) handle).getEffect();</span>
            }
<span class="nc" id="L1649">            return illegalArgumentObject(handle);</span>
<span class="nc" id="L1650">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1651">            throw new InvalidElementException(e);</span>
        }
    }


    public Collection getElementResidences(Object handle) {
        try {
<span class="nc bnc" id="L1658" title="All 2 branches missed.">            if (handle instanceof ModelElement) {</span>
<span class="nc" id="L1659">                return getRefOutermostPackage(handle)</span>
<span class="nc" id="L1660">                        .getCore().getAResidentElementResidence()</span>
<span class="nc" id="L1661">                        .getElementResidence((ModelElement) handle);</span>
            }
<span class="nc" id="L1663">            return illegalArgumentCollection(handle);</span>
<span class="nc" id="L1664">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1665">            throw new InvalidElementException(e);</span>
        }
    }


    public Collection getElementImports2(Object handle) {
        try {
<span class="nc bnc" id="L1672" title="All 2 branches missed.">            if (handle instanceof ModelElement) {</span>
<span class="nc" id="L1673">                return getRefOutermostPackage(handle)</span>
<span class="nc" id="L1674">                        .getModelManagement()</span>
<span class="nc" id="L1675">                        .getAImportedElementElementImport().getElementImport(</span>
                                (ModelElement) handle);
            }
<span class="nc" id="L1678">            return illegalArgumentCollection(handle);</span>
<span class="nc" id="L1679">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1680">            throw new InvalidElementException(e);</span>
        }
    }

    public Collection&lt;ElementImport&gt; getElementImports(Object handle) {
        try {
<span class="nc bnc" id="L1686" title="All 2 branches missed.">            if (handle instanceof UmlPackage) {</span>
<span class="nc" id="L1687">                return ((UmlPackage) handle).getElementImport();</span>
            }
<span class="nc" id="L1689">            return illegalArgumentCollection(handle);</span>
<span class="nc" id="L1690">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1691">            throw new InvalidElementException(e);</span>
        }
    }

    public Object getEntry(Object handle) {
        try {
<span class="nc bnc" id="L1697" title="All 2 branches missed.">            if (handle instanceof State) {</span>
                try {
<span class="nc" id="L1699">                    return ((State) handle).getEntry();</span>
<span class="nc" id="L1700">                } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1701">                    throw new InvalidElementException(e);</span>
                }
            }
<span class="nc" id="L1704">            return illegalArgumentObject(handle);</span>
<span class="nc" id="L1705">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1706">            throw new InvalidElementException(e);</span>
        }
    }


    public Object getEnumeration(Object handle) {
        try {
<span class="nc bnc" id="L1713" title="All 2 branches missed.">            if (handle instanceof EnumerationLiteral) {</span>
<span class="nc" id="L1714">                return ((EnumerationLiteral) handle).getEnumeration();</span>
            }
<span class="nc" id="L1716">            return illegalArgumentObject(handle);</span>
<span class="nc" id="L1717">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1718">            throw new InvalidElementException(e);</span>
        }
    }


    public Object getExit(Object handle) {
        try {
<span class="nc bnc" id="L1725" title="All 2 branches missed.">            if (handle instanceof State) {</span>
<span class="nc" id="L1726">                return ((State) handle).getExit();</span>
            }
<span class="nc" id="L1728">            return illegalArgumentObject(handle);</span>
<span class="nc" id="L1729">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1730">            throw new InvalidElementException(e);</span>
        }
    }


    public Object getExpression(Object handle) {
        try {
<span class="nc bnc" id="L1737" title="All 2 branches missed.">            if (handle instanceof Guard) {</span>
<span class="nc" id="L1738">                return ((Guard) handle).getExpression();</span>
            }
<span class="nc bnc" id="L1740" title="All 2 branches missed.">            if (handle instanceof ChangeEvent) {</span>
<span class="nc" id="L1741">                return ((ChangeEvent) handle).getChangeExpression();</span>
            }
<span class="nc bnc" id="L1743" title="All 2 branches missed.">            if (handle instanceof TimeEvent) {</span>
<span class="nc" id="L1744">                return ((TimeEvent) handle).getWhen();</span>
            }
<span class="nc bnc" id="L1746" title="All 2 branches missed.">            if (handle instanceof Argument) {</span>
<span class="nc" id="L1747">                return ((Argument) handle).getValue();</span>
            }
<span class="nc" id="L1749">            return illegalArgumentObject(handle);</span>
<span class="nc" id="L1750">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1751">            throw new InvalidElementException(e);</span>
        }
    }


    public Collection getExtendedElements(Object handle) {
        try {
<span class="nc bnc" id="L1758" title="All 2 branches missed.">            if (!(handle instanceof Stereotype)) {</span>
<span class="nc" id="L1759">                return illegalArgumentCollection(handle);</span>
            }
<span class="nc" id="L1761">            Stereotype stereotype = (Stereotype) handle;</span>
<span class="nc" id="L1762">            return getRefOutermostPackage(handle)</span>
<span class="nc" id="L1763">                    .getCore().getAStereotypeExtendedElement()</span>
<span class="nc" id="L1764">                    .getExtendedElement(stereotype);</span>
<span class="nc" id="L1765">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1766">            throw new InvalidElementException(e);</span>
        }
    }


    public Collection getExtends(Object handle) {
        try {
<span class="nc bnc" id="L1773" title="All 2 branches missed.">            if (handle instanceof UseCase) {</span>
<span class="nc" id="L1774">                return ((UseCase) handle).getExtend();</span>
            }
<span class="nc bnc" id="L1776" title="All 2 branches missed.">            if (handle instanceof ExtensionPoint) {</span>
<span class="nc" id="L1777">                ExtensionPoint ep = (ExtensionPoint) handle;</span>
<span class="nc" id="L1778">                return getRefOutermostPackage(handle)</span>
<span class="nc" id="L1779">                        .getUseCases().getAExtensionPointExtend().getExtend(ep);</span>
            }
<span class="nc" id="L1781">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1782">            throw new InvalidElementException(e);</span>
<span class="nc" id="L1783">        }</span>
<span class="nc" id="L1784">        return illegalArgumentCollection(handle);</span>
    }


    public Collection getExtenders(Object handle) {
        try {
<span class="nc bnc" id="L1790" title="All 2 branches missed.">            if (handle instanceof UseCase) {</span>
<span class="nc" id="L1791">                return getRefOutermostPackage(handle).getUseCases()</span>
<span class="nc" id="L1792">                        .getABaseExtender().getExtender((UseCase) handle);</span>
            }
<span class="nc" id="L1794">            return illegalArgumentCollection(handle);</span>
<span class="nc" id="L1795">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1796">            throw new InvalidElementException(e);</span>
        }
    }


    public Object getExtension(Object handle) {
        try {
<span class="nc bnc" id="L1803" title="All 2 branches missed.">            if (handle instanceof Extend) {</span>
<span class="nc" id="L1804">                return ((Extend) handle).getExtension();</span>
            }
<span class="nc" id="L1806">            return illegalArgumentObject(handle);</span>
<span class="nc" id="L1807">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1808">            throw new InvalidElementException(e);</span>
        }
    }


    public Object getExtensionPoint(Object handle, int index) {
        try {
<span class="nc bnc" id="L1815" title="All 2 branches missed.">            if (handle instanceof Extend) {</span>
<span class="nc" id="L1816">                return ((Extend) handle).getExtensionPoint().get(index);</span>
            }
<span class="nc" id="L1818">            return illegalArgumentObject(handle);</span>
<span class="nc" id="L1819">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1820">            throw new InvalidElementException(e);</span>
        }
    }


    public Collection&lt;ExtensionPoint&gt; getExtensionPoints(Object handle) {
        try {
<span class="nc bnc" id="L1827" title="All 2 branches missed.">            if (handle instanceof UseCase) {</span>
<span class="nc" id="L1828">                return ((UseCase) handle).getExtensionPoint();</span>
            }
<span class="nc bnc" id="L1830" title="All 2 branches missed.">            if (handle instanceof Extend) {</span>
                // returns a List
<span class="nc" id="L1832">                return ((Extend) handle).getExtensionPoint();</span>
            }
<span class="nc" id="L1834">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1835">            throw new InvalidElementException(e);</span>
<span class="nc" id="L1836">        }</span>
<span class="nc" id="L1837">        return illegalArgumentCollection(handle);</span>
    }


    public List&lt;Feature&gt; getFeatures(Object handle) {
        try {
<span class="nc bnc" id="L1843" title="All 2 branches missed.">            if (handle instanceof Classifier) {</span>
<span class="nc" id="L1844">                return ((Classifier) handle).getFeature();</span>
            }
<span class="nc" id="L1846">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1847">            throw new InvalidElementException(e);</span>
<span class="nc" id="L1848">        }</span>
<span class="nc" id="L1849">        return illegalArgumentList(handle);</span>
    }


    public Object getGeneralization(Object handle, Object parent) {
        try {
<span class="nc bnc" id="L1855" title="All 4 branches missed.">            if (handle instanceof GeneralizableElement</span>
                    &amp;&amp; parent instanceof GeneralizableElement) {
<span class="nc" id="L1857">                Iterator it = getGeneralizations(handle).iterator();</span>
<span class="nc bnc" id="L1858" title="All 2 branches missed.">                while (it.hasNext()) {</span>
<span class="nc" id="L1859">                    Generalization gen = (Generalization) it.next();</span>
<span class="nc bnc" id="L1860" title="All 2 branches missed.">                    if (gen.getParent() == parent) {</span>
<span class="nc" id="L1861">                        return gen;</span>
                    }
<span class="nc" id="L1863">                }</span>
<span class="nc" id="L1864">                return null;</span>
            }
<span class="nc" id="L1866">            return illegalArgumentObject(handle);</span>
<span class="nc" id="L1867">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1868">            throw new InvalidElementException(e);</span>
        }
    }


    public Collection&lt;Generalization&gt; getGeneralizations(Object handle) {
        try {
<span class="nc bnc" id="L1875" title="All 2 branches missed.">            if (handle instanceof GeneralizableElement) {</span>
<span class="nc" id="L1876">                return ((GeneralizableElement) handle).getGeneralization();</span>
            }
<span class="nc" id="L1878">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1879">            throw new InvalidElementException(e);</span>
<span class="nc" id="L1880">        }</span>
<span class="nc" id="L1881">        return illegalArgumentCollection(handle);</span>
    }


    public Object getGuard(Object handle) {
        try {
<span class="nc bnc" id="L1887" title="All 2 branches missed.">            if (isATransition(handle)) {</span>
<span class="nc" id="L1888">                return ((Transition) handle).getGuard();</span>
            }
<span class="nc" id="L1890">            return illegalArgumentObject(handle);</span>
<span class="nc" id="L1891">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1892">            throw new InvalidElementException(e);</span>
        }
    }


    public Object getIcon(Object handle) {
        try {
<span class="nc bnc" id="L1899" title="All 2 branches missed.">            if (handle instanceof Stereotype) {</span>
<span class="nc" id="L1900">                return ((Stereotype) handle).getIcon();</span>
            }
<span class="nc" id="L1902">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1903">            throw new InvalidElementException(e);</span>
<span class="nc" id="L1904">        }</span>
<span class="nc" id="L1905">        return illegalArgumentObject(handle);</span>
    }


    public Collection&lt;ModelElement&gt; getImportedElements(Object pack) {
<span class="nc bnc" id="L1910" title="All 2 branches missed.">        if (!(pack instanceof UmlPackage)) {</span>
<span class="nc" id="L1911">            return illegalArgumentCollection(pack);</span>
        }
<span class="nc" id="L1913">        Collection&lt;ModelElement&gt; results = new ArrayList&lt;ModelElement&gt;();</span>
        try {
            /*
             * TODO: This code manually processes the ElementImports of a
             * Package, but we need to check whether MDR already does something
             * similar automatically as part of its namespace processing.
             * - tfm - 20060408
             */
<span class="nc bnc" id="L1921" title="All 2 branches missed.">            for (ElementImport ei : ((UmlPackage) pack).getElementImport()) {</span>
<span class="nc" id="L1922">                ModelElement element = ei.getImportedElement();</span>
<span class="nc" id="L1923">                results.add(element);</span>
<span class="nc" id="L1924">            }</span>
<span class="nc" id="L1925">            return results;</span>
<span class="nc" id="L1926">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1927">            throw new InvalidElementException(e);</span>
        }
    }


    public Object getImportedElement(Object elementImport) {
<span class="nc bnc" id="L1933" title="All 2 branches missed.">        if (!(elementImport instanceof ElementImport)) {</span>
<span class="nc" id="L1934">            return illegalArgumentCollection(&quot;This is not an ElementImport: &quot;</span>
                    + elementImport);
        }
        try {
<span class="nc" id="L1938">            return ((ElementImport) elementImport).getImportedElement();</span>
<span class="nc" id="L1939">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1940">            throw new InvalidElementException(e);</span>
        }
    }

    public Collection&lt;Include&gt; getIncludes(Object handle) {
        try {
<span class="nc bnc" id="L1946" title="All 2 branches missed.">            if (handle instanceof UseCase) {</span>
<span class="nc" id="L1947">                return ((UseCase) handle).getInclude();</span>
            }
<span class="nc" id="L1949">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1950">            throw new InvalidElementException(e);</span>
<span class="nc" id="L1951">        }</span>
<span class="nc" id="L1952">        return illegalArgumentCollection(handle);</span>
    }

    public Collection getIncluders(Object handle) {
        try {
<span class="nc bnc" id="L1957" title="All 2 branches missed.">            if (handle instanceof UseCase) {</span>
<span class="nc" id="L1958">                return getRefOutermostPackage(handle).getUseCases()</span>
<span class="nc" id="L1959">                        .getAIncluderAddition().getIncluder((UseCase) handle);</span>
            }
<span class="nc" id="L1961">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1962">            throw new InvalidElementException(e);</span>
<span class="nc" id="L1963">        }</span>
<span class="nc" id="L1964">        return illegalArgumentCollection(handle);</span>
    }


    public Collection getIncomings(Object handle) {
        try {
<span class="nc bnc" id="L1970" title="All 4 branches missed.">            if (isAGuard(handle) || isAAction(handle)) {</span>
<span class="nc" id="L1971">                return getIncomings(getTransition(handle));</span>
            }
<span class="nc bnc" id="L1973" title="All 2 branches missed.">            if (isAEvent(handle)) {</span>
<span class="nc" id="L1974">                Iterator trans = getTransitions(handle).iterator();</span>
<span class="nc" id="L1975">                Collection incomings = new ArrayList();</span>
<span class="nc bnc" id="L1976" title="All 2 branches missed.">                while (trans.hasNext()) {</span>
<span class="nc" id="L1977">                    incomings.addAll(getIncomings(trans.next()));</span>
                }
<span class="nc" id="L1979">                return incomings;</span>
            }
<span class="nc bnc" id="L1981" title="All 2 branches missed.">            if (isAStateVertex(handle)) {</span>
<span class="nc" id="L1982">                return ((StateVertex) handle).getIncoming();</span>
            }
            // For a Transition use indirection through source StateVertex
<span class="nc bnc" id="L1985" title="All 2 branches missed.">            if (isATransition(handle)) {</span>
<span class="nc" id="L1986">                return ((Transition) handle).getSource().getIncoming();</span>
            }
<span class="nc" id="L1988">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L1989">            throw new InvalidElementException(e);</span>
<span class="nc" id="L1990">        }</span>
<span class="nc" id="L1991">        return illegalArgumentCollection(handle);</span>
    }


    public Object getInitialValue(Object handle) {
        try {
<span class="nc bnc" id="L1997" title="All 2 branches missed.">            if (handle instanceof Attribute) {</span>
<span class="nc" id="L1998">                return ((Attribute) handle).getInitialValue();</span>
            }
<span class="nc" id="L2000">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2001">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2002">        }</span>
<span class="nc" id="L2003">        return illegalArgumentCollection(handle);</span>
    }


    public Object getInstance(Object handle) {
        try {
<span class="nc bnc" id="L2009" title="All 2 branches missed.">            if (handle instanceof AttributeLink) {</span>
<span class="nc" id="L2010">                return ((AttributeLink) handle).getInstance();</span>
            }
<span class="nc bnc" id="L2012" title="All 2 branches missed.">            if (handle instanceof LinkEnd) {</span>
<span class="nc" id="L2013">                return ((LinkEnd) handle).getInstance();</span>
            }
<span class="nc" id="L2015">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2016">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2017">        }</span>
<span class="nc" id="L2018">        return illegalArgumentObject(handle);</span>
    }


    public Collection getInstances(Object handle) {
        try {
<span class="nc bnc" id="L2024" title="All 2 branches missed.">            if (handle instanceof Classifier) {</span>
<span class="nc" id="L2025">                return getRefOutermostPackage(handle).getCommonBehavior()</span>
<span class="nc" id="L2026">                        .getAInstanceClassifier().getInstance(</span>
                                (Classifier) handle);
            }
<span class="nc" id="L2029">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2030">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2031">        }</span>
<span class="nc" id="L2032">        return illegalArgumentCollection(handle);</span>
    }


    public Collection&lt;State&gt; getInStates(Object handle) {
        try {
<span class="nc bnc" id="L2038" title="All 2 branches missed.">            if (handle instanceof ClassifierInState) {</span>
<span class="nc" id="L2039">                return ((ClassifierInState) handle).getInState();</span>
            }
<span class="nc" id="L2041">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2042">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2043">        }</span>
<span class="nc" id="L2044">        return illegalArgumentCollection(handle);</span>
    }


    public Object getInteraction(Object handle) {
        try {
<span class="nc bnc" id="L2050" title="All 2 branches missed.">            if (handle instanceof Message) {</span>
<span class="nc" id="L2051">                return ((Message) handle).getInteraction();</span>
            }
<span class="nc" id="L2053">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2054">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2055">        }</span>
<span class="nc" id="L2056">        return illegalArgumentObject(handle);</span>
    }


    public Collection&lt;Interaction&gt; getInteractions(Object handle) {
        try {
<span class="nc bnc" id="L2062" title="All 2 branches missed.">            if (handle instanceof Collaboration) {</span>
<span class="nc" id="L2063">                return ((Collaboration) handle).getInteraction();</span>
            }
<span class="nc" id="L2065">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2066">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2067">        }</span>
<span class="nc" id="L2068">        return illegalArgumentCollection(handle);</span>
    }


    public Collection&lt;Transition&gt; getInternalTransitions(Object handle) {
        try {
<span class="nc bnc" id="L2074" title="All 2 branches missed.">            if (handle instanceof State) {</span>
<span class="nc" id="L2075">                return ((State) handle).getInternalTransition();</span>
            }
<span class="nc" id="L2077">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2078">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2079">        }</span>
<span class="nc" id="L2080">        return illegalArgumentCollection(handle);</span>
    }


    public Collection&lt;Message&gt; getMessages(Object handle) {
        try {
<span class="nc bnc" id="L2086" title="All 2 branches missed.">            if (isAInteraction(handle)) {</span>
<span class="nc" id="L2087">                return ((Interaction) handle).getMessage();</span>
            }
<span class="nc bnc" id="L2089" title="All 2 branches missed.">            if (handle instanceof AssociationRole) {</span>
<span class="nc" id="L2090">                return ((AssociationRole) handle).getMessage();</span>
            }
<span class="nc bnc" id="L2092" title="All 2 branches missed.">            if (handle instanceof Action) {</span>
<span class="nc" id="L2093">                return getRefOutermostPackage(handle).getCollaborations()</span>
<span class="nc" id="L2094">                        .getAActionMessage().getMessage(((Action) handle));</span>
            }
<span class="nc" id="L2096">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2097">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2098">        }</span>
<span class="nc" id="L2099">        return illegalArgumentCollection(handle);</span>
    }

    /**
     * @see org.argouml.model.Facade#getMessageSort(java.lang.Object)
     */
    public Object getMessageSort(Object handle) {
<span class="nc" id="L2106">        return getAction(handle);</span>
    }



    public Collection getSuccessors(Object handle) {
        try {
<span class="nc bnc" id="L2113" title="All 2 branches missed.">            if (handle instanceof Message) {</span>
<span class="nc" id="L2114">                return getRefOutermostPackage(handle).getCollaborations()</span>
<span class="nc" id="L2115">                        .getAPredecessorSuccessor().getSuccessor(</span>
                                (Message) handle);
            }
<span class="nc" id="L2118">            return illegalArgumentCollection(handle);</span>
<span class="nc" id="L2119">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2120">            throw new InvalidElementException(e);</span>
        }
    }

    public Collection getActivatedMessages(Object handle) {
        try {
<span class="nc bnc" id="L2126" title="All 2 branches missed.">            if (handle instanceof Message) {</span>
<span class="nc" id="L2127">                return getRefOutermostPackage(handle).getCollaborations()</span>
<span class="nc" id="L2128">                        .getAMessageActivator().getMessage((Message) handle);</span>
            }
<span class="nc" id="L2130">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2131">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2132">        }</span>
<span class="nc" id="L2133">        return illegalArgumentCollection(handle);</span>
    }

    public Collection getReceivedMessages(Object handle) {
        try {
<span class="nc bnc" id="L2138" title="All 2 branches missed.">            if (handle instanceof ClassifierRole) {</span>
<span class="nc" id="L2139">                return getRefOutermostPackage(handle).getCollaborations()</span>
<span class="nc" id="L2140">                        .getAReceiverMessage().getMessage(</span>
                                (ClassifierRole) handle);
            }
<span class="nc" id="L2143">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2144">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2145">        }</span>
<span class="nc" id="L2146">        return illegalArgumentCollection(handle);</span>
    }

    public Collection getSentMessages(Object handle) {
        try {
<span class="nc bnc" id="L2151" title="All 2 branches missed.">            if (handle instanceof ClassifierRole) {</span>
<span class="nc" id="L2152">                return getRefOutermostPackage(handle).getCollaborations()</span>
<span class="nc" id="L2153">                        .getAMessageSender()</span>
<span class="nc" id="L2154">                        .getMessage((ClassifierRole) handle);</span>
            }
<span class="nc" id="L2156">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2157">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2158">        }</span>
<span class="nc" id="L2159">        return illegalArgumentCollection(handle);</span>
    }

    public Object getInnerContainingModel(Object handle) {
        try {
<span class="nc bnc" id="L2164" title="All 2 branches missed.">            if (isAModel(handle)) {</span>
<span class="nc" id="L2165">                return handle;</span>
            }
<span class="nc bnc" id="L2167" title="All 2 branches missed.">            if (!isAUMLElement(handle)) {</span>
<span class="nc" id="L2168">                return illegalArgumentObject(handle);</span>
            }
            // If we can't find a model, return the outermost
            // containing model element
<span class="nc bnc" id="L2172" title="All 2 branches missed.">            if (getModelElementContainer(handle) == null) {</span>
<span class="nc" id="L2173">                return handle;</span>
            }
            // TODO: replace this recursive function by a loop like in getRoot:
<span class="nc" id="L2176">            return getInnerContainingModel(</span>
<span class="nc" id="L2177">                getModelElementContainer(handle));</span>
<span class="nc" id="L2178">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2179">            throw new InvalidElementException(e);</span>
        }
    }

    public Object getRoot(final Object handle) {
<span class="fc" id="L2184">        Object result = handle;</span>
        try {
<span class="pc bpc" id="L2186" title="1 of 2 branches missed.">            if (!isAUMLElement(handle)) {</span>
<span class="nc" id="L2187">                return illegalArgumentObject(handle);</span>
            }
<span class="fc" id="L2189">            Object container = getModelElementContainer(handle);</span>
<span class="fc bfc" id="L2190" title="All 2 branches covered.">            while (container != null) {</span>
<span class="fc" id="L2191">                result = container;</span>
<span class="fc" id="L2192">                container = getModelElementContainer(result);</span>
            }
<span class="nc" id="L2194">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2195">            throw new InvalidElementException(e);</span>
<span class="fc" id="L2196">        }</span>
<span class="fc" id="L2197">        return result;</span>
    }

    public Collection getRootElements() {
<span class="nc" id="L2201">        Collection elements = new ArrayList();</span>
<span class="nc" id="L2202">        org.omg.uml.UmlPackage pkg = modelImpl.getUmlPackage();</span>
<span class="nc bnc" id="L2203" title="All 2 branches missed.">        if (pkg != null) {</span>
<span class="nc bnc" id="L2204" title="All 2 branches missed.">            for (RefObject obj : (Collection&lt;RefObject&gt;) pkg.getCore()</span>
<span class="nc" id="L2205">                    .getElement().refAllOfType()) {</span>
<span class="nc bnc" id="L2206" title="All 2 branches missed.">                if (obj.refImmediateComposite() == null) {</span>
<span class="nc" id="L2207">                    elements.add(obj);</span>
                }
<span class="nc" id="L2209">            }</span>
        } else {
<span class="nc" id="L2211">            LOG.log(Level.WARNING, &quot;No default extent in getRootElements&quot;);</span>
        }
<span class="nc" id="L2213">        return elements;</span>
    }


    public Object getModelElement(Object handle) {
        try {
<span class="nc bnc" id="L2219" title="All 2 branches missed.">            if (handle instanceof ElementImport) {</span>
                // TODO: This does not belong here - use getImportedElement.
<span class="nc" id="L2221">                return ((ElementImport) handle).getImportedElement();</span>
            }
<span class="nc bnc" id="L2223" title="All 2 branches missed.">            if (handle instanceof TaggedValue) {</span>
<span class="nc" id="L2224">                return ((TaggedValue) handle).getModelElement();</span>
            }
<span class="nc bnc" id="L2226" title="All 2 branches missed.">            if (handle instanceof TemplateArgument) {</span>
<span class="nc" id="L2227">                return ((TemplateArgument) handle).getModelElement();</span>
            }
<span class="nc" id="L2229">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2230">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2231">        }</span>
<span class="nc" id="L2232">        return illegalArgumentObject(handle);</span>
    }


    public Object getMultiplicity(Object handle) {
        try {
<span class="nc bnc" id="L2238" title="All 2 branches missed.">            if (handle instanceof StructuralFeature) {</span>
<span class="nc" id="L2239">                StructuralFeature sf = (StructuralFeature) handle;</span>
<span class="nc" id="L2240">                return sf.getMultiplicity();</span>
<span class="nc bnc" id="L2241" title="All 2 branches missed.">            } else if (handle instanceof TagDefinition) {</span>
<span class="nc" id="L2242">                TagDefinition td = (TagDefinition) handle;</span>
<span class="nc" id="L2243">                return td.getMultiplicity();</span>
<span class="nc bnc" id="L2244" title="All 2 branches missed.">            } else if (handle instanceof ClassifierRole) {</span>
<span class="nc" id="L2245">                ClassifierRole cr = (ClassifierRole) handle;</span>
<span class="nc" id="L2246">                return cr.getMultiplicity();</span>
<span class="nc bnc" id="L2247" title="All 2 branches missed.">            } else if (handle instanceof AssociationEnd) {</span>
<span class="nc" id="L2248">                AssociationEnd ae = (AssociationEnd) handle;</span>
<span class="nc" id="L2249">                return ae.getMultiplicity();</span>
<span class="nc bnc" id="L2250" title="All 2 branches missed.">            } else if (handle instanceof AssociationRole) {</span>
<span class="nc" id="L2251">                AssociationRole ar = (AssociationRole) handle;</span>
<span class="nc" id="L2252">                return ar.getMultiplicity();</span>
            }
<span class="nc" id="L2254">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2255">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2256">        }</span>
<span class="nc" id="L2257">        return illegalArgumentObject(handle);</span>
    }

    public Collection&lt;Comment&gt; getComments(Object handle) {
        try {
<span class="nc bnc" id="L2262" title="All 2 branches missed.">            if (handle instanceof ModelElement) {</span>
<span class="nc" id="L2263">                return ((ModelElement) handle).getComment();</span>
            }
<span class="nc" id="L2265">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2266">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2267">        }</span>
<span class="nc" id="L2268">        return illegalArgumentCollection(handle);</span>
    }


    public Collection&lt;ModelElement&gt; getAnnotatedElements(Object handle) {
        try {
<span class="nc bnc" id="L2274" title="All 2 branches missed.">            if (handle instanceof Comment) {</span>
<span class="nc" id="L2275">                return ((Comment) handle).getAnnotatedElement();</span>
            }
<span class="nc" id="L2277">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2278">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2279">        }</span>
<span class="nc" id="L2280">        return illegalArgumentCollection(handle);</span>
    }


    public Object getCommunicationConnection(Object handle) {
        try {
<span class="nc bnc" id="L2286" title="All 2 branches missed.">            if (handle instanceof Message) {</span>
<span class="nc" id="L2287">                return ((Message) handle).getCommunicationConnection();</span>
            }
<span class="nc" id="L2289">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2290">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2291">        }</span>
<span class="nc" id="L2292">        return illegalArgumentObject(handle);</span>
    }


    public Object getCommunicationLink(Object handle) {
        try {
<span class="nc bnc" id="L2298" title="All 2 branches missed.">            if (handle instanceof Stimulus) {</span>
<span class="nc" id="L2299">                return ((Stimulus) handle).getCommunicationLink();</span>
            }
<span class="nc" id="L2301">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2302">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2303">        }</span>
<span class="nc" id="L2304">        return illegalArgumentObject(handle);</span>
    }


    public Collection getCollaborations(Object handle) {
        try {
<span class="nc bnc" id="L2310" title="All 2 branches missed.">            if (handle instanceof Operation) {</span>
<span class="nc" id="L2311">                return getRefOutermostPackage(handle).getCollaborations()</span>
<span class="nc" id="L2312">                        .getARepresentedOperationCollaboration()</span>
<span class="nc" id="L2313">                        .getCollaboration((Operation) handle);</span>
            }
<span class="nc bnc" id="L2315" title="All 2 branches missed.">            if (handle instanceof Classifier) {</span>
<span class="nc" id="L2316">                return getRefOutermostPackage(handle).getCollaborations()</span>
<span class="nc" id="L2317">                        .getARepresentedClassifierCollaboration()</span>
<span class="nc" id="L2318">                        .getCollaboration((Classifier) handle);</span>
            }
<span class="nc" id="L2320">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2321">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2322">        }</span>
<span class="nc" id="L2323">        return illegalArgumentCollection(handle);</span>
    }


    public Object getComponentInstance(Object handle) {
        try {
<span class="nc bnc" id="L2329" title="All 2 branches missed.">            if (handle instanceof Instance) {</span>
<span class="nc" id="L2330">                return ((Instance) handle).getComponentInstance();</span>
            }
<span class="nc" id="L2332">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2333">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2334">        }</span>
<span class="nc" id="L2335">        return illegalArgumentObject(handle);</span>
    }


    public Collection&lt;ModelElement&gt; getConstrainingElements(Object handle) {
        try {
<span class="nc bnc" id="L2341" title="All 2 branches missed.">            if (handle instanceof Collaboration) {</span>
<span class="nc" id="L2342">                return ((Collaboration) handle).getConstrainingElement();</span>
            }
<span class="nc" id="L2344">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2345">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2346">        }</span>
<span class="nc" id="L2347">        return illegalArgumentCollection(handle);</span>
    }


    public List&lt;ModelElement&gt; getConstrainedElements(Object handle) {
        try {
<span class="nc bnc" id="L2353" title="All 2 branches missed.">            if (handle instanceof Constraint) {</span>
<span class="nc" id="L2354">                return ((Constraint) handle).getConstrainedElement();</span>
            }
<span class="nc" id="L2356">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2357">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2358">        }</span>
<span class="nc" id="L2359">        return illegalArgumentList(handle);</span>
    }


    public Collection&lt;Constraint&gt; getConstraints(Object handle) {
        try {
<span class="nc bnc" id="L2365" title="All 2 branches missed.">            if (handle instanceof ModelElement) {</span>
<span class="nc" id="L2366">                return ((ModelElement) handle).getConstraint();</span>
            }
<span class="nc" id="L2368">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2369">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2370">        }</span>
<span class="nc" id="L2371">        return illegalArgumentCollection(handle);</span>
    }


    public Object getModelElementContainer(Object handle) {
        try {
<span class="pc bpc" id="L2377" title="1 of 2 branches missed.">            if (handle instanceof RefObject) {</span>
<span class="fc" id="L2378">                return ((RefObject) handle).refImmediateComposite();</span>
            }
<span class="nc" id="L2380">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2381">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2382">        }</span>
<span class="nc" id="L2383">        return illegalArgumentObject(handle);</span>
    }


    public List getModelElementContents(Object handle) {
<span class="nc" id="L2388">        List results = getModelElementAssociated(handle, true);</span>
<span class="nc" id="L2389">        return results;</span>
    }


    public List getModelElementAssociated(Object handle) {
<span class="nc" id="L2394">        return getModelElementAssociated(handle, false);</span>
    }

    /**
     * Return all model elements associated with the given model element,
     * optionally excluding associations which are not composite.&lt;p&gt;
     *
     * NOTE: The current implementation only follows associations which
     * are navigable FROM the model element, so it's possible that there
     * are additional associated elements which would be too resource
     * intensive to search for.&lt;p&gt;
     *
     * Implementation queries the metamodel to find all attributes/references
     * for the metatype of the given object and uses that set of names
     * to query the object using the JMI reflective interface.
     *
     * @return A List with {@link RefBaseObject}s.
     */
    private List getModelElementAssociated(Object handle,
            boolean contentsOnly) {
<span class="nc" id="L2414">        List&lt;RefBaseObject&gt; results = new ArrayList&lt;RefBaseObject&gt;();</span>

<span class="nc bnc" id="L2416" title="All 2 branches missed.">        if (!(handle instanceof RefFeatured)) {</span>
<span class="nc" id="L2417">            throw new IllegalArgumentException(</span>
                    &quot;Element doesn't appear to be a MOF element :&quot; + handle);
        }

        try {
<span class="nc" id="L2422">            modelImpl.getRepository().beginTrans(false);</span>
<span class="nc" id="L2423">            RefFeatured rf = (RefFeatured) handle;</span>
<span class="nc" id="L2424">            RefObject metaobject = rf.refMetaObject();</span>
<span class="nc bnc" id="L2425" title="All 2 branches missed.">            if (!(metaobject instanceof MofClass)) {</span>
<span class="nc" id="L2426">                throw new IllegalArgumentException(</span>
                        &quot;Element doesn't appear to be a MOF element :&quot;
                        + handle);
            }
<span class="nc" id="L2430">            MofClass metaclass = (MofClass) metaobject;</span>
<span class="nc" id="L2431">            List&lt;MofClass&gt; types =</span>
<span class="nc" id="L2432">                    new ArrayList&lt;MofClass&gt;(metaclass.allSupertypes());</span>
<span class="nc" id="L2433">            types.add(metaclass);</span>
<span class="nc bnc" id="L2434" title="All 2 branches missed.">            for (MofClass s : types) {</span>
<span class="nc bnc" id="L2435" title="All 2 branches missed.">                for (Object contentElement : s.getContents()) {</span>
<span class="nc" id="L2436">                    getReferenceOrAttribute(</span>
                            (RefFeatured) handle, contentElement, results,
                            contentsOnly);
<span class="nc" id="L2439">                }</span>
<span class="nc" id="L2440">            }</span>
<span class="nc" id="L2441">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2442">            throw new InvalidElementException(e);</span>
        } finally {
<span class="nc" id="L2444">            modelImpl.getRepository().endTrans();</span>
        }
<span class="nc" id="L2446">        return results;</span>
    }

    /**
     * Helper function to add the value(s) of an Attribute or Reference to the
     * given collection.
     *
     * @param returns A Collection that {@link RefBaseObject}s are added to.
     */
    private void getReferenceOrAttribute(RefFeatured parent, Object element,
            Collection&lt;RefBaseObject&gt; returns, boolean contentsOnly) {

        try {
<span class="nc bnc" id="L2459" title="All 4 branches missed.">            if (!(element instanceof javax.jmi.model.Attribute</span>
                    || element instanceof Reference)) {
<span class="nc" id="L2461">                return;</span>
            }
<span class="nc bnc" id="L2463" title="All 2 branches missed.">            if (element instanceof Reference) {</span>
<span class="nc" id="L2464">                javax.jmi.model.AggregationKind ak = ((Reference) element)</span>
<span class="nc" id="L2465">                        .getExposedEnd().getAggregation();</span>
<span class="nc bnc" id="L2466" title="All 4 branches missed.">                if (contentsOnly &amp;&amp; ak != MOF_COMPOSITE) {</span>
<span class="nc" id="L2467">                    return;</span>
                }
            }

<span class="nc" id="L2471">            String valueName = ((javax.jmi.model.ModelElement) element)</span>
<span class="nc" id="L2472">                    .getName();</span>
<span class="nc" id="L2473">            Object refends = parent.refGetValue(valueName);</span>
<span class="nc bnc" id="L2474" title="All 2 branches missed.">            if (refends == null) {</span>
<span class="nc" id="L2475">                return;</span>
            }
<span class="nc bnc" id="L2477" title="All 2 branches missed.">            if (refends instanceof Collection) {</span>
<span class="nc" id="L2478">                Collection c = (Collection) refends;</span>
<span class="nc bnc" id="L2479" title="All 2 branches missed.">                if (!c.isEmpty()) {</span>
<span class="nc bnc" id="L2480" title="All 2 branches missed.">                    for (Iterator it = c.iterator(); it.hasNext();) {</span>
<span class="nc" id="L2481">                        Object o = it.next();</span>
                        // Only add MOF elements, not primitive datatypes
<span class="nc bnc" id="L2483" title="All 2 branches missed.">                        if (o instanceof RefBaseObject) {</span>
<span class="nc" id="L2484">                            returns.add((RefBaseObject) o);</span>
                        }
<span class="nc" id="L2486">                    }</span>
                }
<span class="nc" id="L2488">            } else {</span>
                // Only add MOF elements, not primitive datatypes
<span class="nc bnc" id="L2490" title="All 2 branches missed.">                if (refends instanceof RefBaseObject) {</span>
<span class="nc" id="L2491">                    returns.add((RefBaseObject) refends);</span>
                }
            }
<span class="nc" id="L2494">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2495">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2496">        }</span>
<span class="nc" id="L2497">    }</span>


    // TODO: Rationalize this with getModelElementContainer
    public Object getContainer(Object handle) {
        try {
<span class="nc bnc" id="L2503" title="All 4 branches missed.">            if (isAGuard(handle) || isAAction(handle)) {</span>
<span class="nc" id="L2504">                return getContainer(getTransition(handle));</span>
            }
<span class="nc bnc" id="L2506" title="All 2 branches missed.">            if (isAEvent(handle)) {</span>
                Object container;
<span class="nc" id="L2508">                Iterator it = getTransitions(handle).iterator();</span>
<span class="nc bnc" id="L2509" title="All 2 branches missed.">                while (it.hasNext()) {</span>
<span class="nc" id="L2510">                    container = getContainer(it.next());</span>
<span class="nc bnc" id="L2511" title="All 2 branches missed.">                    if (container != null) {</span>
<span class="nc" id="L2512">                        return container;</span>
                    }
                }
            }
<span class="nc bnc" id="L2516" title="All 2 branches missed.">            if (handle instanceof StateVertex) {</span>
<span class="nc" id="L2517">                return ((StateVertex) handle).getContainer();</span>
            }
            // TODO: Use getModelElementContainer for transition
<span class="nc bnc" id="L2520" title="All 2 branches missed.">            if (isATransition(handle)) {</span>
<span class="nc" id="L2521">                return ((Transition) handle).getStateMachine().getTop()</span>
<span class="nc" id="L2522">                        .getContainer();</span>
            }
<span class="nc bnc" id="L2524" title="All 2 branches missed.">            if (handle instanceof ElementResidence) {</span>
<span class="nc" id="L2525">                return ((ElementResidence) handle).getContainer();</span>
            }
<span class="nc" id="L2527">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2528">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2529">        }</span>
<span class="nc" id="L2530">        return illegalArgumentObject(handle);</span>
    }


    public Collection&lt;ModelElement&gt; getContents(Object handle) {
        try {
<span class="nc bnc" id="L2536" title="All 2 branches missed.">            if (handle instanceof Partition) {</span>
<span class="nc" id="L2537">                return ((Partition) handle).getContents();</span>
            }
<span class="nc" id="L2539">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2540">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2541">        }</span>
<span class="nc" id="L2542">        return illegalArgumentCollection(handle);</span>
    }


    public Object getContext(Object handle) {
        try {
<span class="nc bnc" id="L2548" title="All 2 branches missed.">            if (isAStateMachine(handle)) {</span>
<span class="nc" id="L2549">                return ((StateMachine) handle).getContext();</span>
            }
<span class="nc bnc" id="L2551" title="All 2 branches missed.">            if (isAInteraction(handle)) {</span>
<span class="nc" id="L2552">                return ((Interaction) handle).getContext();</span>
            }
<span class="nc" id="L2554">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2555">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2556">        }</span>
<span class="nc" id="L2557">        return illegalArgumentObject(handle);</span>
    }


    public Collection getContexts(Object handle) {
        try {
<span class="nc bnc" id="L2563" title="All 2 branches missed.">            if (handle instanceof Signal) {</span>
<span class="nc" id="L2564">                return getRefOutermostPackage(handle).getCommonBehavior()</span>
<span class="nc" id="L2565">                        .getAContextRaisedSignal().getContext((Signal) handle);</span>
            }
<span class="nc" id="L2567">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2568">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2569">        }</span>
<span class="nc" id="L2570">        return illegalArgumentCollection(handle);</span>
    }


    public Collection getCreateActions(Object handle) {
        try {
<span class="nc bnc" id="L2576" title="All 2 branches missed.">            if (handle instanceof Classifier) {</span>
<span class="nc" id="L2577">                return getRefOutermostPackage(handle).getCommonBehavior()</span>
<span class="nc" id="L2578">                        .getACreateActionInstantiation().getCreateAction(</span>
                                (Classifier) handle);
            }
<span class="nc" id="L2581">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2582">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2583">        }</span>
<span class="nc" id="L2584">        return illegalArgumentCollection(handle);</span>
    }


    public Object getDefaultValue(Object handle) {
        try {
<span class="nc bnc" id="L2590" title="All 2 branches missed.">            if (handle instanceof Parameter) {</span>
<span class="nc" id="L2591">                return ((Parameter) handle).getDefaultValue();</span>
            }
<span class="nc" id="L2593">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2594">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2595">        }</span>
<span class="nc" id="L2596">        return illegalArgumentObject(handle);</span>
    }


    public Collection&lt;Event&gt; getDeferrableEvents(Object handle) {
        try {
<span class="nc bnc" id="L2602" title="All 2 branches missed.">            if (handle instanceof State) {</span>
<span class="nc" id="L2603">                return ((State) handle).getDeferrableEvent();</span>
            }
<span class="nc" id="L2605">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2606">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2607">        }</span>
<span class="nc" id="L2608">        return illegalArgumentCollection(handle);</span>
    }


    public Collection&lt;Node&gt; getDeploymentLocations(Object handle) {
        try {
<span class="nc bnc" id="L2614" title="All 2 branches missed.">            if (handle instanceof Component) {</span>
<span class="nc" id="L2615">                return ((Component) handle).getDeploymentLocation();</span>
            }
<span class="nc" id="L2617">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2618">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2619">        }</span>
<span class="nc" id="L2620">        return illegalArgumentCollection(handle);</span>
    }

    public Collection&lt;Component&gt; getDeployedComponents(Object handle) {
        try {
<span class="nc bnc" id="L2625" title="All 2 branches missed.">            if (handle instanceof Node) {</span>
<span class="nc" id="L2626">                return ((Node) handle).getDeployedComponent();</span>
            }
<span class="nc" id="L2628">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2629">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2630">        }</span>
<span class="nc" id="L2631">        return illegalArgumentCollection(handle);</span>
    }


    @Deprecated
    public Object getDiscriminator(Object handle) {
        try {
<span class="nc bnc" id="L2638" title="All 2 branches missed.">            if (handle instanceof Generalization) {</span>
<span class="nc" id="L2639">                return ((Generalization) handle).getDiscriminator();</span>
            }
<span class="nc" id="L2641">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2642">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2643">        }</span>
<span class="nc" id="L2644">        throw new IllegalArgumentException(&quot;Expected a Generalization. Got a &quot;</span>
<span class="nc" id="L2645">                + handle.getClass().getName());</span>
    }


    public Object getDispatchAction(Object handle) {
        try {
<span class="nc bnc" id="L2651" title="All 2 branches missed.">            if (handle instanceof Stimulus) {</span>
<span class="nc" id="L2652">                return ((Stimulus) handle).getDispatchAction();</span>
            }
<span class="nc" id="L2654">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2655">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2656">        }</span>
<span class="nc" id="L2657">        return illegalArgumentObject(handle);</span>
    }


    public Object getDoActivity(Object handle) {
        try {
<span class="nc bnc" id="L2663" title="All 2 branches missed.">            if (handle instanceof State) {</span>
<span class="nc" id="L2664">                return ((State) handle).getDoActivity();</span>
            }
<span class="nc" id="L2666">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2667">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2668">        }</span>
<span class="nc" id="L2669">        return illegalArgumentObject(handle);</span>
    }


    public Collection getLinks(Object handle) {
        try {
<span class="nc bnc" id="L2675" title="All 2 branches missed.">            if (handle instanceof UmlAssociation) {</span>
<span class="nc" id="L2676">                return getRefOutermostPackage(handle).getCommonBehavior()</span>
<span class="nc" id="L2677">                        .getAAssociationLink().getLink((UmlAssociation) handle);</span>
            }
<span class="nc" id="L2679">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2680">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2681">        }</span>
<span class="nc" id="L2682">        return illegalArgumentCollection(handle);</span>
    }


    public Collection getLinkEnds(Object handle) {
        try {
<span class="nc bnc" id="L2688" title="All 2 branches missed.">            if (handle instanceof AssociationEnd) {</span>
<span class="nc" id="L2689">                return getRefOutermostPackage(handle).getCommonBehavior()</span>
<span class="nc" id="L2690">                        .getAAssociationEndLinkEnd().getLinkEnd(</span>
                                (AssociationEnd) handle);
            }
<span class="nc bnc" id="L2693" title="All 2 branches missed.">            if (handle instanceof Instance) {</span>
<span class="nc" id="L2694">                return ((Instance) handle).getLinkEnd();</span>
            }
<span class="nc" id="L2696">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2697">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2698">        }</span>
<span class="nc" id="L2699">        return illegalArgumentCollection(handle);</span>
    }


    public String getLocation(Object handle) {
        try {
<span class="nc bnc" id="L2705" title="All 2 branches missed.">            if (handle instanceof ExtensionPoint) {</span>
<span class="nc" id="L2706">                return ((ExtensionPoint) handle).getLocation();</span>
            }
<span class="nc" id="L2708">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2709">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2710">        }</span>
<span class="nc" id="L2711">        return illegalArgumentString(handle);</span>
    }


    public Collection getMethods(Object handle) {
        try {
<span class="nc bnc" id="L2717" title="All 2 branches missed.">            if (handle instanceof Operation) {</span>
<span class="nc" id="L2718">                return getRefOutermostPackage(handle).getCore()</span>
<span class="nc" id="L2719">                        .getASpecificationMethod()</span>
<span class="nc" id="L2720">                        .getMethod((Operation) handle);</span>
            }
<span class="nc" id="L2722">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2723">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2724">        }</span>
<span class="nc" id="L2725">        return illegalArgumentCollection(handle);</span>
    }


    public Object getNamespace(Object handle) {
<span class="nc bnc" id="L2730" title="All 2 branches missed.">        if (!(handle instanceof ModelElement)) {</span>
<span class="nc" id="L2731">            return illegalArgumentObject(handle);</span>
        }
        try {
<span class="nc" id="L2734">            return ((ModelElement) handle).getNamespace();</span>
<span class="nc" id="L2735">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2736">            throw new InvalidElementException(e);</span>
        }
    }


    public Object getNodeInstance(Object handle) {
        try {
<span class="nc bnc" id="L2743" title="All 2 branches missed.">            if (handle instanceof ComponentInstance) {</span>
<span class="nc" id="L2744">                return ((ComponentInstance) handle).getNodeInstance();</span>
            }
<span class="nc" id="L2746">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2747">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2748">        }</span>
<span class="nc" id="L2749">        return illegalArgumentObject(handle);</span>
    }


    public Collection getObjectFlowStates(Object handle) {
        try {
<span class="nc bnc" id="L2755" title="All 2 branches missed.">            if (handle instanceof Classifier) {</span>
<span class="nc" id="L2756">                return getRefOutermostPackage(handle).getActivityGraphs()</span>
<span class="nc" id="L2757">                        .getATypeObjectFlowState().getObjectFlowState(</span>
                                (Classifier) handle);
            }
<span class="nc" id="L2760">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2761">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2762">        }</span>
<span class="nc" id="L2763">        return illegalArgumentCollection(handle);</span>
    }


    public Object getOperation(Object handle) {
        try {
<span class="nc bnc" id="L2769" title="All 2 branches missed.">            if (handle instanceof CallAction) {</span>
<span class="nc" id="L2770">                return ((CallAction) handle).getOperation();</span>
            }
<span class="nc bnc" id="L2772" title="All 2 branches missed.">            if (handle instanceof CallEvent) {</span>
<span class="nc" id="L2773">                return ((CallEvent) handle).getOperation();</span>
            }
<span class="nc" id="L2775">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2776">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2777">        }</span>
<span class="nc" id="L2778">        return illegalArgumentObject(handle);</span>
    }


    public Collection getOccurrences(Object handle) {
        try {
<span class="nc bnc" id="L2784" title="All 2 branches missed.">            if (handle instanceof Operation) {</span>
<span class="nc" id="L2785">                return getRefOutermostPackage(handle).getStateMachines()</span>
<span class="nc" id="L2786">                        .getAOccurrenceOperation().getOccurrence(</span>
                                (Operation) handle);
            }
<span class="nc" id="L2789">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2790">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2791">        }</span>
<span class="nc" id="L2792">        return illegalArgumentCollection(handle);</span>
    }


    public List&lt;Operation&gt; getOperations(Object handle) {
<span class="nc bnc" id="L2797" title="All 2 branches missed.">        if (!(handle instanceof Classifier)) {</span>
<span class="nc" id="L2798">            return illegalArgumentList(handle);</span>
        }
<span class="nc" id="L2800">        List&lt;Operation&gt; result = new ArrayList&lt;Operation&gt;();</span>
        try {
<span class="nc bnc" id="L2802" title="All 2 branches missed.">            for (Feature feature : getFeatures(handle)) {</span>
<span class="nc bnc" id="L2803" title="All 2 branches missed.">                if (feature instanceof Operation) {</span>
<span class="nc" id="L2804">                    result.add((Operation) feature);</span>
                }
<span class="nc" id="L2806">            }</span>
<span class="nc" id="L2807">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2808">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2809">        }</span>

<span class="nc" id="L2811">        return result;</span>
    }

    public List&lt;Feature&gt; getOperationsAndReceptions(Object classifier) {
<span class="nc" id="L2815">        List&lt;Feature&gt; opsAndReceps = new ArrayList&lt;Feature&gt;();</span>
        // TODO: Return empty collection on null input or throw IllegalArgument?
<span class="nc bnc" id="L2817" title="All 2 branches missed.">        if (classifier != null) {</span>
<span class="nc bnc" id="L2818" title="All 2 branches missed.">            for (Feature f : getFeatures(classifier)) {</span>
<span class="nc bnc" id="L2819" title="All 4 branches missed.">                if (isAOperation(f) || isAReception(f)) {</span>
<span class="nc" id="L2820">                    opsAndReceps.add(f);</span>
                }
<span class="nc" id="L2822">            }</span>
        }
<span class="nc" id="L2824">        return opsAndReceps;</span>
    }


    public Object getNextEnd(Object handle) {
        try {
<span class="nc bnc" id="L2830" title="All 2 branches missed.">            if (handle instanceof AssociationEnd) {</span>
<span class="nc" id="L2831">                List&lt;AssociationEnd&gt; assocEnds =</span>
<span class="nc" id="L2832">                        (((AssociationEnd) handle).getAssociation())</span>
<span class="nc" id="L2833">                                .getConnection();</span>
<span class="nc" id="L2834">                int index = assocEnds.indexOf(handle);</span>
<span class="nc bnc" id="L2835" title="All 4 branches missed.">                if (index == -1 || assocEnds.size() &lt; 2) {</span>
<span class="nc" id="L2836">                    return null; // shouldn't happen</span>
                }
<span class="nc bnc" id="L2838" title="All 2 branches missed.">                if (index == assocEnds.size() - 1) {</span>
<span class="nc" id="L2839">                    return assocEnds.get(0);</span>
                } else {
<span class="nc" id="L2841">                    return assocEnds.get(index + 1);</span>
                }
            }
<span class="nc" id="L2844">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2845">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2846">        }</span>
<span class="nc" id="L2847">        return illegalArgumentObject(handle);</span>
    }


    public Object getOrdering(Object handle) {
        try {
<span class="nc bnc" id="L2853" title="All 2 branches missed.">            if (handle instanceof AssociationEnd) {</span>
<span class="nc" id="L2854">                return ((AssociationEnd) handle).getOrdering();</span>
            }
<span class="nc" id="L2856">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2857">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2858">        }</span>
<span class="nc" id="L2859">        return illegalArgumentObject(handle);</span>
    }


    public Collection getOutgoings(Object handle) {
        try {
<span class="nc bnc" id="L2865" title="All 4 branches missed.">            if (isAGuard(handle) || isAAction(handle)) {</span>
<span class="nc" id="L2866">                return getOutgoings(getTransition(handle));</span>
            }
<span class="nc bnc" id="L2868" title="All 2 branches missed.">            if (isAEvent(handle)) {</span>
<span class="nc" id="L2869">                Iterator trans = getTransitions(handle).iterator();</span>
<span class="nc" id="L2870">                Collection outgoings = new ArrayList();</span>
<span class="nc bnc" id="L2871" title="All 2 branches missed.">                while (trans.hasNext()) {</span>
<span class="nc" id="L2872">                    outgoings.addAll(getOutgoings(trans.next()));</span>
                }
<span class="nc" id="L2874">                return outgoings;</span>
            }
<span class="nc bnc" id="L2876" title="All 2 branches missed.">            if (isAStateVertex(handle)) {</span>
<span class="nc" id="L2877">                return ((StateVertex) handle).getOutgoing();</span>
            }
            // For Transition use indirection through target StateVertex
<span class="nc bnc" id="L2880" title="All 2 branches missed.">            if (isATransition(handle)) {</span>
<span class="nc" id="L2881">                return ((Transition) handle).getTarget().getOutgoing();</span>
            }
<span class="nc" id="L2883">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2884">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2885">        }</span>
<span class="nc" id="L2886">        return illegalArgumentCollection(handle);</span>
    }


    public Collection&lt;AssociationEnd&gt; getOtherAssociationEnds(Object handle) {
        try {
<span class="nc bnc" id="L2892" title="All 2 branches missed.">            if (handle instanceof AssociationEnd) {</span>
<span class="nc" id="L2893">                UmlAssociation a = ((AssociationEnd) handle).getAssociation();</span>

<span class="nc bnc" id="L2895" title="All 2 branches missed.">                if (a == null) {</span>
<span class="nc" id="L2896">                    return Collections.emptyList();</span>
                }

<span class="nc" id="L2899">                Collection&lt;AssociationEnd&gt; allEnds = a.getConnection();</span>
<span class="nc bnc" id="L2900" title="All 2 branches missed.">                if (allEnds == null) {</span>
<span class="nc" id="L2901">                    return Collections.emptyList();</span>
                }

                // TODO: An Iterator filter would be nice here instead of the
                // mucking around with the Collection.
<span class="nc" id="L2906">                allEnds = new ArrayList&lt;AssociationEnd&gt;(allEnds);</span>
<span class="nc" id="L2907">                allEnds.remove(handle);</span>
<span class="nc" id="L2908">                return allEnds;</span>
            }

<span class="nc" id="L2911">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2912">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2913">        }</span>
<span class="nc" id="L2914">        return illegalArgumentCollection(handle);</span>
    }


    public Collection&lt;LinkEnd&gt; getOtherLinkEnds(Object handle) {
        try {
<span class="nc bnc" id="L2920" title="All 2 branches missed.">            if (handle instanceof LinkEnd) {</span>
<span class="nc" id="L2921">                Link link = ((LinkEnd) handle).getLink();</span>

<span class="nc bnc" id="L2923" title="All 2 branches missed.">                if (link == null) {</span>
<span class="nc" id="L2924">                    return Collections.emptyList();</span>
                }

<span class="nc" id="L2927">                Collection&lt;LinkEnd&gt; allEnds = link.getConnection();</span>
<span class="nc bnc" id="L2928" title="All 2 branches missed.">                if (allEnds == null) {</span>
<span class="nc" id="L2929">                    return Collections.emptyList();</span>
                }

                // TODO: An Iterator filter would be nice here instead of the
                // mucking around with the Collection.
<span class="nc" id="L2934">                allEnds = new ArrayList&lt;LinkEnd&gt;(allEnds);</span>
<span class="nc" id="L2935">                allEnds.remove(handle);</span>
<span class="nc" id="L2936">                return allEnds;</span>
            }
<span class="nc" id="L2938">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2939">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2940">        }</span>
<span class="nc" id="L2941">        return illegalArgumentCollection(handle);</span>
    }


    public Collection&lt;ModelElement&gt; getOwnedElements(Object handle) {
<span class="nc bnc" id="L2946" title="All 2 branches missed.">        if (!(handle instanceof Namespace)) {</span>
<span class="nc" id="L2947">            return illegalArgumentCollection(handle);</span>
        }
        try {
<span class="nc" id="L2950">            return ((Namespace) handle).getOwnedElement();</span>
<span class="nc" id="L2951">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2952">            throw new InvalidElementException(e);</span>
        }
    }


    public boolean isStatic(Object handle) {
        try {
<span class="nc bnc" id="L2959" title="All 2 branches missed.">            if (handle instanceof Feature) {</span>
<span class="nc" id="L2960">                return ScopeKindEnum.SK_CLASSIFIER.equals(((Feature) handle)</span>
<span class="nc" id="L2961">                        .getOwnerScope());</span>
            }
<span class="nc bnc" id="L2963" title="All 2 branches missed.">            if (handle instanceof AssociationEnd) {</span>
<span class="nc" id="L2964">                return ScopeKindEnum.SK_CLASSIFIER</span>
<span class="nc" id="L2965">                        .equals(((AssociationEnd) handle).getTargetScope());</span>
            }
<span class="nc" id="L2967">            throw new IllegalArgumentException();</span>
<span class="nc" id="L2968">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2969">            throw new InvalidElementException(e);</span>
        }
    }


    public Object getPowertype(Object handle) {
        try {
<span class="nc bnc" id="L2976" title="All 2 branches missed.">            if (handle instanceof Generalization) {</span>
<span class="nc" id="L2977">                return ((Generalization) handle).getPowertype();</span>
            }
<span class="nc" id="L2979">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2980">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2981">        }</span>
<span class="nc" id="L2982">        return illegalArgumentObject(handle);</span>
    }


    public Collection&lt;Generalization&gt; getPowertypeRanges(Object handle) {
        try {
<span class="nc bnc" id="L2988" title="All 2 branches missed.">            if (handle instanceof Classifier) {</span>
<span class="nc" id="L2989">                return ((Classifier) handle).getPowertypeRange();</span>
            }
<span class="nc" id="L2991">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L2992">            throw new InvalidElementException(e);</span>
<span class="nc" id="L2993">        }</span>
<span class="nc" id="L2994">        return illegalArgumentCollection(handle);</span>
    }


    public Collection&lt;Message&gt; getPredecessors(Object handle) {
        try {
<span class="nc bnc" id="L3000" title="All 2 branches missed.">            if (handle instanceof Message) {</span>
            // TODO: This has different semantics than everything else
<span class="nc" id="L3002">                return Collections.unmodifiableCollection(</span>
                        new ArrayList&lt;Message&gt;(
<span class="nc" id="L3004">                                ((Message) handle).getPredecessor()));</span>
            }
<span class="nc" id="L3006">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3007">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3008">        }</span>
<span class="nc" id="L3009">        return illegalArgumentCollection(handle);</span>
    }


    public List&lt;Attribute&gt; getQualifiers(Object handle) {
        try {
<span class="nc bnc" id="L3015" title="All 2 branches missed.">            if (handle instanceof AssociationEnd) {</span>
<span class="nc" id="L3016">                return ((AssociationEnd) handle).getQualifier();</span>
            }
<span class="nc" id="L3018">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3019">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3020">        }</span>
<span class="nc" id="L3021">        return illegalArgumentList(handle);</span>
    }


    public boolean hasReturnParameterDirectionKind(Object handle) {
        try {
<span class="nc bnc" id="L3027" title="All 2 branches missed.">            if (handle instanceof Parameter) {</span>
<span class="nc" id="L3028">                Parameter parameter = (Parameter) handle;</span>
<span class="nc" id="L3029">                return (ParameterDirectionKindEnum.PDK_RETURN.equals(parameter</span>
<span class="nc" id="L3030">                        .getKind()));</span>
            }
<span class="nc" id="L3032">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3033">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3034">        }</span>
<span class="nc" id="L3035">        return illegalArgumentBoolean(handle);</span>
    }


    public Object getPackage(Object handle) {
        try {
<span class="nc bnc" id="L3041" title="All 2 branches missed.">            if (handle instanceof ElementImport) {</span>
<span class="nc" id="L3042">                return ((ElementImport) handle).getUmlPackage();</span>
            }
<span class="nc" id="L3044">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3045">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3046">        }</span>
<span class="nc" id="L3047">        return illegalArgumentObject(handle);</span>
    }


    public Object getParameter(Object handle, int n) {
<span class="nc" id="L3052">        Collection collection = getParameters(handle);</span>
<span class="nc bnc" id="L3053" title="All 2 branches missed.">        if (collection instanceof List) {</span>
<span class="nc" id="L3054">            return ((List) collection).get(n);</span>
        }
<span class="nc" id="L3056">        return illegalArgumentObject(handle);</span>
    }


    public Object getParameter(Object handle) {
<span class="nc bnc" id="L3061" title="All 2 branches missed.">        if (handle instanceof TemplateParameter) {</span>
<span class="nc" id="L3062">            return ((TemplateParameter) handle).getParameter();</span>
        }
<span class="nc" id="L3064">        return illegalArgumentObject(handle);</span>
    }


    public Collection getParameters(Object handle) {
        try {
<span class="nc bnc" id="L3070" title="All 4 branches missed.">            if (handle instanceof BehavioralFeature</span>
                    || handle instanceof Event) {
<span class="nc" id="L3072">                return getParametersList(handle);</span>
            }
<span class="nc bnc" id="L3074" title="All 2 branches missed.">            if (handle instanceof ObjectFlowState) {</span>
<span class="nc" id="L3075">                return ((ObjectFlowState) handle).getParameter();</span>
            }
<span class="nc bnc" id="L3077" title="All 2 branches missed.">            if (handle instanceof Classifier) {</span>
<span class="nc" id="L3078">                return getRefOutermostPackage(handle).getCore()</span>
<span class="nc" id="L3079">                        .getATypedParameterType().getTypedParameter(</span>
                                (Classifier) handle);
            }
<span class="nc" id="L3082">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3083">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3084">        }</span>
<span class="nc" id="L3085">        return illegalArgumentCollection(handle);</span>
    }


    public List&lt;Parameter&gt; getParametersList(Object handle) {
        try {
<span class="nc bnc" id="L3091" title="All 2 branches missed.">            if (handle instanceof BehavioralFeature) {</span>
<span class="nc" id="L3092">                return ((BehavioralFeature) handle).getParameter();</span>
            }
<span class="nc bnc" id="L3094" title="All 2 branches missed.">            if (handle instanceof Event) {</span>
<span class="nc" id="L3095">                return ((Event) handle).getParameter();</span>
            }
<span class="nc" id="L3097">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3098">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3099">        }</span>
<span class="nc" id="L3100">        return illegalArgumentList(handle);</span>
    }


    public Object getGeneral(Object handle) {
        try {
<span class="nc bnc" id="L3106" title="All 2 branches missed.">            if (handle instanceof Generalization) {</span>
<span class="nc" id="L3107">                return ((Generalization) handle).getParent();</span>
            }
<span class="nc" id="L3109">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3110">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3111">        }</span>
<span class="nc" id="L3112">        return illegalArgumentObject(handle);</span>
    }


    public Collection getRaisedSignals(Object handle) {
<span class="nc" id="L3117">        return getRaisedExceptions(handle);</span>
    }

    /**
     * Dummy method for UML 1.x
     *
     * @author Andreas Rueckert &lt;a_rueckert@gmx.net&gt;
     *
     * @see org.argouml.model.Facade#getRaisedExceptions(java.lang.Object)
     */
    public Collection getRaisedExceptions(Object handle) {
        try {
<span class="nc bnc" id="L3129" title="All 2 branches missed.">            if (handle instanceof BehavioralFeature) {</span>
<span class="nc" id="L3130">                return getRefOutermostPackage(handle).getCommonBehavior()</span>
<span class="nc" id="L3131">                        .getAContextRaisedSignal().getRaisedSignal(</span>
                                (BehavioralFeature) handle);
            }
<span class="nc" id="L3134">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3135">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3136">        }</span>
<span class="nc" id="L3137">        return illegalArgumentCollection(handle);</span>
    }


    public Collection getReceptions(Object handle) {
        try {
<span class="nc bnc" id="L3143" title="All 2 branches missed.">            if (handle instanceof Signal) {</span>
<span class="nc" id="L3144">                return getRefOutermostPackage(handle).getCommonBehavior()</span>
<span class="nc" id="L3145">                        .getASignalReception().getReception((Signal) handle);</span>
            }
<span class="nc" id="L3147">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3148">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3149">        }</span>
<span class="nc" id="L3150">        return illegalArgumentCollection(handle);</span>
    }


    public Object getRecurrence(Object handle) {
        try {
<span class="nc bnc" id="L3156" title="All 2 branches missed.">            if (handle instanceof Action) {</span>
<span class="nc" id="L3157">                return ((Action) handle).getRecurrence();</span>
            }
<span class="nc" id="L3159">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3160">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3161">        }</span>
<span class="nc" id="L3162">        return illegalArgumentObject(handle);</span>
    }


    public Object getRepresentedClassifier(Object handle) {
        try {
<span class="nc bnc" id="L3168" title="All 2 branches missed.">            if (handle instanceof Collaboration) {</span>
<span class="nc" id="L3169">                return ((Collaboration) handle).getRepresentedClassifier();</span>
            }
<span class="nc" id="L3171">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3172">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3173">        }</span>
<span class="nc" id="L3174">        return illegalArgumentObject(handle);</span>
    }


    public Object getRepresentedOperation(Object handle) {
        try {
<span class="nc bnc" id="L3180" title="All 2 branches missed.">            if (handle instanceof Collaboration) {</span>
<span class="nc" id="L3181">                return ((Collaboration) handle).getRepresentedOperation();</span>
            }
<span class="nc" id="L3183">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3184">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3185">        }</span>
<span class="nc" id="L3186">        return illegalArgumentObject(handle);</span>
    }


    public Object getScript(Object handle) {
        try {
<span class="nc bnc" id="L3192" title="All 2 branches missed.">            if (handle instanceof Action) {</span>
<span class="nc" id="L3193">                return ((Action) handle).getScript();</span>
            }
<span class="nc" id="L3195">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3196">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3197">        }</span>
<span class="nc" id="L3198">        return illegalArgumentObject(handle);</span>
    }


    public Object getSender(Object handle) {
        try {
<span class="nc bnc" id="L3204" title="All 2 branches missed.">            if (handle instanceof Stimulus) {</span>
<span class="nc" id="L3205">                return ((Stimulus) handle).getSender();</span>
            }
<span class="nc bnc" id="L3207" title="All 2 branches missed.">            if (handle instanceof Message) {</span>
<span class="nc" id="L3208">                return ((Message) handle).getSender();</span>
            }
<span class="nc" id="L3210">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3211">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3212">        }</span>
<span class="nc" id="L3213">        return illegalArgumentObject(handle);</span>
    }


    public Object getSignal(Object handle) {
        try {
<span class="nc bnc" id="L3219" title="All 2 branches missed.">            if (handle instanceof SendAction) {</span>
<span class="nc" id="L3220">                return ((SendAction) handle).getSignal();</span>
            }
<span class="nc bnc" id="L3222" title="All 2 branches missed.">            if (handle instanceof SignalEvent) {</span>
<span class="nc" id="L3223">                return ((SignalEvent) handle).getSignal();</span>
            }
<span class="nc bnc" id="L3225" title="All 2 branches missed.">            if (handle instanceof Reception) {</span>
<span class="nc" id="L3226">                return ((Reception) handle).getSignal();</span>
            }
<span class="nc" id="L3228">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3229">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3230">        }</span>
<span class="nc" id="L3231">        return illegalArgumentObject(handle);</span>
    }


    public Object getResident(Object handle) {
        try {
<span class="nc bnc" id="L3237" title="All 2 branches missed.">            if (handle instanceof ElementResidence) {</span>
<span class="nc" id="L3238">                return ((ElementResidence) handle).getResident();</span>
            }
<span class="nc" id="L3240">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3241">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3242">        }</span>
<span class="nc" id="L3243">        return illegalArgumentObject(handle);</span>
    }


    public Collection&lt;ElementResidence&gt; getResidentElements(Object handle) {
        try {
<span class="nc bnc" id="L3249" title="All 2 branches missed.">            if (handle instanceof Component) {</span>
<span class="nc" id="L3250">                return ((Component) handle).getResidentElement();</span>
            }
<span class="nc" id="L3252">            return illegalArgumentCollection(handle);</span>
<span class="nc" id="L3253">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3254">            throw new InvalidElementException(e);</span>
        }
    }


    public Collection getResidents(Object handle) {
        try {
<span class="nc bnc" id="L3261" title="All 2 branches missed.">            if (isANodeInstance(handle)) {</span>
<span class="nc" id="L3262">                return ((NodeInstance) handle).getResident();</span>
            }
<span class="nc bnc" id="L3264" title="All 2 branches missed.">            if (isAComponentInstance(handle)) {</span>
<span class="nc" id="L3265">                return ((ComponentInstance) handle).getResident();</span>
            }
<span class="nc bnc" id="L3267" title="All 2 branches missed.">            if (isAComponent(handle)) {</span>
<span class="nc" id="L3268">                Collection residents = new ArrayList();</span>
<span class="nc" id="L3269">                for (Iterator it =</span>
<span class="nc" id="L3270">                        ((Component) handle).getResidentElement().iterator();</span>
<span class="nc bnc" id="L3271" title="All 2 branches missed.">                    it.hasNext();) {</span>
<span class="nc" id="L3272">                    ModelElement me = ((ElementResidence) it.next()).getResident();</span>
<span class="nc bnc" id="L3273" title="All 2 branches missed.">                    if (me != null) {</span>
<span class="nc" id="L3274">                        residents.add(me);</span>
                    }
<span class="nc" id="L3276">                }</span>
<span class="nc" id="L3277">                return residents;</span>
            }
<span class="nc" id="L3279">            return illegalArgumentCollection(handle);</span>
<span class="nc" id="L3280">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3281">            throw new InvalidElementException(e);</span>
        }
    }


    public Object getSource(Object handle) {
        try {
<span class="nc bnc" id="L3288" title="All 2 branches missed.">            if (isATransition(handle)) {</span>
<span class="nc" id="L3289">                return ((Transition) handle).getSource();</span>
            }
<span class="nc" id="L3291">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3292">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3293">        }</span>
<span class="nc" id="L3294">        return illegalArgumentObject(handle);</span>
    }


    public Collection&lt;ModelElement&gt; getSources(Object handle) {
        try {
<span class="nc bnc" id="L3300" title="All 2 branches missed.">            if (handle instanceof Flow) {</span>
<span class="nc" id="L3301">                return ((Flow) handle).getSource();</span>
            }
<span class="nc" id="L3303">            return illegalArgumentCollection(handle);</span>
<span class="nc" id="L3304">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3305">            throw new InvalidElementException(e);</span>
        }
    }


    public Collection getSourceFlows(Object handle) {
        try {
<span class="nc bnc" id="L3312" title="All 2 branches missed.">            if (handle instanceof ModelElement) {</span>
<span class="nc" id="L3313">                return ((ModelElement) handle).getSourceFlow();</span>
            }
<span class="nc" id="L3315">            return illegalArgumentCollection(handle);</span>
<span class="nc" id="L3316">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3317">            throw new InvalidElementException(e);</span>
        }
    }


    public Collection getSpecializations(Object handle) {
<span class="nc bnc" id="L3323" title="All 2 branches missed.">        if (!(handle instanceof GeneralizableElement)) {</span>
<span class="nc" id="L3324">            return illegalArgumentCollection(handle);</span>
        }
        try {
<span class="nc" id="L3327">            return getRefOutermostPackage(handle).getCore()</span>
<span class="nc" id="L3328">                    .getAParentSpecialization().getSpecialization(</span>
                            (GeneralizableElement) handle);
<span class="nc" id="L3330">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3331">            throw new InvalidElementException(e);</span>
        }
    }


    public Object getStateMachine(Object handle) {
        try {
<span class="nc bnc" id="L3338" title="All 2 branches missed.">            if (handle instanceof State) {</span>
<span class="nc" id="L3339">                return ((State) handle).getStateMachine();</span>
            }
<span class="nc bnc" id="L3341" title="All 2 branches missed.">            if (handle instanceof Transition) {</span>
<span class="nc" id="L3342">                return ((Transition) handle).getStateMachine();</span>
            }
<span class="nc" id="L3344">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3345">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3346">        }</span>
<span class="nc" id="L3347">        return illegalArgumentObject(handle);</span>
    }


    public Object getState(Object handle) {
        try {
<span class="nc bnc" id="L3353" title="All 2 branches missed.">            if (handle instanceof Transition) {</span>
<span class="nc" id="L3354">                return getRefOutermostPackage(handle).getStateMachines()</span>
<span class="nc" id="L3355">                        .getAStateInternalTransition().getState(</span>
                                (Transition) handle);
            }
<span class="nc" id="L3358">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3359">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3360">        }</span>
<span class="nc" id="L3361">        return illegalArgumentObject(handle);</span>
    }


    public Collection getStates(Object handle) {
        try {
<span class="nc bnc" id="L3367" title="All 2 branches missed.">            if (handle instanceof Event) {</span>
<span class="nc" id="L3368">                return getRefOutermostPackage(handle).getStateMachines()</span>
<span class="nc" id="L3369">                        .getAStateDeferrableEvent().getState((Event) handle);</span>
            }
<span class="nc" id="L3371">            return illegalArgumentCollection(handle);</span>
<span class="nc" id="L3372">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3373">            throw new InvalidElementException(e);</span>
        }
    }


    public Collection getStereotypes(Object handle) {
<span class="nc bnc" id="L3379" title="All 2 branches missed.">        if (!(handle instanceof ModelElement)) {</span>
<span class="nc" id="L3380">            return illegalArgumentCollection(handle);</span>
        }
        try {
<span class="nc" id="L3383">            return ((ModelElement) handle).getStereotype();</span>
<span class="nc" id="L3384">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3385">            throw new InvalidElementException(e);</span>
        }
    }


    public Collection getStimuli(Object handle) {
        try {
<span class="nc bnc" id="L3392" title="All 2 branches missed.">            if (isALink(handle)) {</span>
<span class="nc" id="L3393">                return getRefOutermostPackage(handle).getCommonBehavior()</span>
<span class="nc" id="L3394">                        .getAStimulusCommunicationLink().getStimulus(</span>
                                (Link) handle);
            }
<span class="nc bnc" id="L3397" title="All 2 branches missed.">            if (isAAction(handle)) {</span>
<span class="nc" id="L3398">                return getRefOutermostPackage(handle).getCommonBehavior()</span>
<span class="nc" id="L3399">                        .getADispatchActionStimulus().getStimulus(</span>
                                (Action) handle);
            }
<span class="nc" id="L3402">            return illegalArgumentCollection(handle);</span>
<span class="nc" id="L3403">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3404">            throw new InvalidElementException(e);</span>
        }
    }

    public Collection getReceivedStimuli(Object handle) {
        try {
<span class="nc bnc" id="L3410" title="All 2 branches missed.">            if (handle instanceof Instance) {</span>
<span class="nc" id="L3411">                return getRefOutermostPackage(handle).getCommonBehavior()</span>
<span class="nc" id="L3412">                        .getAReceiverStimulus().getStimulus((Instance) handle);</span>
            }
<span class="nc" id="L3414">            return illegalArgumentCollection(handle);</span>
<span class="nc" id="L3415">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3416">            throw new InvalidElementException(e);</span>
        }
    }


    public Collection getSentStimuli(Object handle) {
        try {
<span class="nc bnc" id="L3423" title="All 2 branches missed.">            if (handle instanceof Instance) {</span>
<span class="nc" id="L3424">                return getRefOutermostPackage(handle).getCommonBehavior()</span>
<span class="nc" id="L3425">                        .getAStimulusSender().getStimulus((Instance) handle);</span>
            }
<span class="nc" id="L3427">            return illegalArgumentCollection(handle);</span>
<span class="nc" id="L3428">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3429">            throw new InvalidElementException(e);</span>
        }
    }


    public Collection getSubvertices(Object handle) {
        try {
<span class="nc bnc" id="L3436" title="All 2 branches missed.">            if (isACompositeState(handle)) {</span>
<span class="nc" id="L3437">                return ((CompositeState) handle).getSubvertex();</span>
            }
<span class="nc" id="L3439">            return illegalArgumentCollection(handle);</span>
<span class="nc" id="L3440">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3441">            throw new InvalidElementException(e);</span>
        }
    }


    public Object getSubmachine(Object handle) {
        try {
<span class="nc bnc" id="L3448" title="All 2 branches missed.">            if (handle instanceof SubmachineState) {</span>
<span class="nc" id="L3449">                return ((SubmachineState) handle).getSubmachine();</span>
            }
<span class="nc" id="L3451">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3452">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3453">        }</span>
<span class="nc" id="L3454">        return illegalArgumentObject(handle);</span>
    }


    public Collection getSubmachineStates(Object handle) {
        try {
<span class="nc bnc" id="L3460" title="All 2 branches missed.">            if (handle instanceof StateMachine) {</span>
<span class="nc" id="L3461">                return ((StateMachine) handle).getSubmachineState();</span>
            }
<span class="nc" id="L3463">            return illegalArgumentCollection(handle);</span>
<span class="nc" id="L3464">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3465">            throw new InvalidElementException(e);</span>
        }
    }


    public Collection getSupplierDependencies(Object handle) {
        try {
<span class="nc bnc" id="L3472" title="All 2 branches missed.">            if (handle instanceof ModelElement) {</span>
<span class="nc" id="L3473">                return Collections.unmodifiableCollection(</span>
<span class="nc" id="L3474">                        getRefOutermostPackage(handle)</span>
<span class="nc" id="L3475">                        .getCore().getASupplierSupplierDependency()</span>
<span class="nc" id="L3476">                        .getSupplierDependency((ModelElement) handle)</span>
                );
            }
<span class="nc" id="L3479">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3480">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3481">        }</span>
<span class="nc" id="L3482">        return illegalArgumentCollection(handle);</span>
    }


    public Object getTop(Object handle) {
        try {
<span class="nc bnc" id="L3488" title="All 2 branches missed.">            if (handle instanceof StateMachine) {</span>
<span class="nc" id="L3489">                return ((StateMachine) handle).getTop();</span>
            }
<span class="nc" id="L3491">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3492">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3493">        }</span>
<span class="nc" id="L3494">        return illegalArgumentObject(handle);</span>
    }


    public Object getTransition(Object handle) {
        try {
<span class="nc bnc" id="L3500" title="All 2 branches missed.">            if (handle instanceof Guard) {</span>
<span class="nc" id="L3501">                return ((Guard) handle).getTransition();</span>
            }
<span class="nc bnc" id="L3503" title="All 2 branches missed.">            if (handle instanceof Action) {</span>
<span class="nc" id="L3504">                return getRefOutermostPackage(handle).getStateMachines()</span>
<span class="nc" id="L3505">                        .getATransitionEffect().getTransition((Action) handle);</span>
            }
<span class="nc" id="L3507">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3508">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3509">        }</span>
<span class="nc" id="L3510">        return illegalArgumentObject(handle);</span>
    }


    public Object getTrigger(Object handle) {
        try {
<span class="nc bnc" id="L3516" title="All 2 branches missed.">            if (handle instanceof Transition) {</span>
<span class="nc" id="L3517">                return ((Transition) handle).getTrigger();</span>
            }
<span class="nc" id="L3519">            return illegalArgumentObject(handle);</span>
<span class="nc" id="L3520">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3521">            throw new InvalidElementException(e);</span>
        }
    }

    public List getTriggers(Object handle) {
        try {
<span class="nc bnc" id="L3527" title="All 2 branches missed.">            if (handle instanceof Transition) {</span>
<span class="nc" id="L3528">                ArrayList l = new ArrayList();</span>
<span class="nc" id="L3529">                Event trig = ((Transition) handle).getTrigger();</span>
<span class="nc bnc" id="L3530" title="All 2 branches missed.">                if (trig != null) {</span>
<span class="nc" id="L3531">                    l.add(trig);</span>
                }
<span class="nc" id="L3533">                return l;</span>
            }
<span class="nc" id="L3535">            return illegalArgumentList(handle);</span>
<span class="nc" id="L3536">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3537">            throw new InvalidElementException(e);</span>
        }
    }


    public Object getType(Object handle) {
        try {
<span class="nc bnc" id="L3544" title="All 2 branches missed.">            if (handle instanceof StructuralFeature) {</span>
<span class="nc" id="L3545">                return ((StructuralFeature) handle).getType();</span>
            }
<span class="nc bnc" id="L3547" title="All 2 branches missed.">            if (handle instanceof AssociationEnd) {</span>
<span class="nc" id="L3548">                return ((AssociationEnd) handle).getParticipant();</span>
            }
<span class="nc bnc" id="L3550" title="All 2 branches missed.">            if (handle instanceof Parameter) {</span>
<span class="nc" id="L3551">                return ((Parameter) handle).getType();</span>
            }
<span class="nc bnc" id="L3553" title="All 2 branches missed.">            if (handle instanceof ObjectFlowState) {</span>
<span class="nc" id="L3554">                return ((ObjectFlowState) handle).getType();</span>
            }
<span class="nc bnc" id="L3556" title="All 2 branches missed.">            if (handle instanceof TagDefinition) {</span>
<span class="nc" id="L3557">                return ((TagDefinition) handle).getTagType();</span>
            }
<span class="nc bnc" id="L3559" title="All 2 branches missed.">            if (handle instanceof ClassifierInState) {</span>
<span class="nc" id="L3560">                return ((ClassifierInState) handle).getType();</span>
            }
<span class="nc bnc" id="L3562" title="All 2 branches missed.">            if (handle instanceof TaggedValue) {</span>
<span class="nc" id="L3563">                return ((TaggedValue) handle).getType();</span>
            }
<span class="nc" id="L3565">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3566">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3567">        }</span>
<span class="nc" id="L3568">        return illegalArgumentObject(handle);</span>

    }


    public Collection getTypedValues(Object handle) {
        try {
<span class="nc bnc" id="L3575" title="All 2 branches missed.">            if (handle instanceof TagDefinition) {</span>
<span class="nc" id="L3576">                return getRefOutermostPackage(handle).getCore()</span>
<span class="nc" id="L3577">                        .getATypeTypedValue().getTypedValue(</span>
                                (TagDefinition) handle);
            }
<span class="nc" id="L3580">            return illegalArgumentCollection(handle);</span>
<span class="nc" id="L3581">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3582">            throw new InvalidElementException(e);</span>
        }
    }


    public Object getTarget(Object handle) {
        try {
<span class="nc bnc" id="L3589" title="All 2 branches missed.">            if (isATransition(handle)) {</span>
<span class="nc" id="L3590">                return ((Transition) handle).getTarget();</span>
            }
<span class="nc" id="L3592">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3593">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3594">        }</span>
<span class="nc" id="L3595">        return illegalArgumentObject(handle);</span>
    }


    @Deprecated
    public Object getTargetScope(Object handle) {
        try {
<span class="nc bnc" id="L3602" title="All 2 branches missed.">            if (handle instanceof StructuralFeature) {</span>
<span class="nc" id="L3603">                return ((StructuralFeature) handle).getTargetScope();</span>
            }
<span class="nc bnc" id="L3605" title="All 2 branches missed.">            if (handle instanceof AssociationEnd) {</span>
<span class="nc" id="L3606">                return ((AssociationEnd) handle).getTargetScope();</span>
            }
<span class="nc" id="L3608">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3609">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3610">        }</span>
<span class="nc" id="L3611">        return illegalArgumentObject(handle);</span>
    }


    public Collection getTargetFlows(Object handle) {
        try {
<span class="nc bnc" id="L3617" title="All 2 branches missed.">            if (handle instanceof ModelElement) {</span>
<span class="nc" id="L3618">                return ((ModelElement) handle).getTargetFlow();</span>
            }
<span class="nc" id="L3620">            return illegalArgumentCollection(handle);</span>
<span class="nc" id="L3621">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3622">            throw new InvalidElementException(e);</span>
        }
    }


    public int getUpper(Object handle) {
        try {
<span class="nc bnc" id="L3629" title="All 2 branches missed.">            if (isAAssociationEnd(handle)) {</span>
<span class="nc" id="L3630">                int upper = 0;</span>
<span class="nc" id="L3631">                AssociationEnd end = (AssociationEnd) handle;</span>
<span class="nc bnc" id="L3632" title="All 2 branches missed.">                if (end.getMultiplicity() != null) {</span>
<span class="nc" id="L3633">                    upper = getUpper(end.getMultiplicity());</span>
                }
<span class="nc" id="L3635">                return upper;</span>
            }
<span class="nc bnc" id="L3637" title="All 2 branches missed.">            if (isAMultiplicity(handle)) {</span>
<span class="nc" id="L3638">                Multiplicity up = (Multiplicity) handle;</span>
<span class="nc" id="L3639">                List ranges = new ArrayList(up.getRange());</span>
                // TODO: this assumes ranges are sorted. Is this true? - tfm
<span class="nc" id="L3641">                return getUpper(ranges.get(ranges.size() - 1));</span>
            }
<span class="nc bnc" id="L3643" title="All 2 branches missed.">            if (isAMultiplicityRange(handle)) {</span>
<span class="nc" id="L3644">                MultiplicityRange up = (MultiplicityRange) handle;</span>
<span class="nc" id="L3645">                return up.getUpper();</span>
            }
<span class="nc" id="L3647">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3648">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3649">        }</span>
<span class="nc" id="L3650">        illegalArgument(handle);</span>
<span class="nc" id="L3651">        return 0;</span>
    }


    public Object getUseCase(Object handle) {
        try {
<span class="nc bnc" id="L3657" title="All 2 branches missed.">            if (handle instanceof ExtensionPoint) {</span>
<span class="nc" id="L3658">                return ((ExtensionPoint) handle).getUseCase();</span>
            }
<span class="nc" id="L3660">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3661">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3662">        }</span>
<span class="nc" id="L3663">        return illegalArgumentObject(handle);</span>
    }


    public int getLower(Object handle) {
        try {
<span class="nc bnc" id="L3669" title="All 2 branches missed.">            if (isAAssociationEnd(handle)) {</span>
<span class="nc" id="L3670">                int lower = 0;</span>
<span class="nc" id="L3671">                AssociationEnd end = (AssociationEnd) handle;</span>
<span class="nc bnc" id="L3672" title="All 2 branches missed.">                if (end.getMultiplicity() != null) {</span>
<span class="nc" id="L3673">                    lower = getLower(end.getMultiplicity());</span>
                }
<span class="nc" id="L3675">                return lower;</span>
            }
<span class="nc bnc" id="L3677" title="All 2 branches missed.">            if (isAMultiplicity(handle)) {</span>
<span class="nc" id="L3678">                Multiplicity low = (Multiplicity) handle;</span>
<span class="nc" id="L3679">                List ranges = new ArrayList(low.getRange());</span>
                // TODO: this assumes ranges are sorted. Is this true? - tfm
<span class="nc" id="L3681">                return getLower(ranges.get(0));</span>
            }
<span class="nc bnc" id="L3683" title="All 2 branches missed.">            if (isAMultiplicityRange(handle)) {</span>
<span class="nc" id="L3684">                MultiplicityRange low = (MultiplicityRange) handle;</span>
<span class="nc" id="L3685">                return low.getLower();</span>
            }
<span class="nc" id="L3687">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3688">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3689">        }</span>
<span class="nc" id="L3690">        illegalArgument(handle);</span>
<span class="nc" id="L3691">        return 0;</span>
    }


    public Collection getTransitions(Object handle) {
        try {
<span class="nc bnc" id="L3697" title="All 2 branches missed.">            if (isAStateMachine(handle)) {</span>
<span class="nc" id="L3698">                return ((StateMachine) handle).getTransitions();</span>
<span class="nc bnc" id="L3699" title="All 2 branches missed.">            } else if (isAState(handle)) {</span>
<span class="nc" id="L3700">                return ((State) handle).getInternalTransition();</span>
<span class="nc bnc" id="L3701" title="All 2 branches missed.">            } else if (isAEvent(handle)) {</span>
<span class="nc" id="L3702">                return getRefOutermostPackage(handle).getStateMachines()</span>
<span class="nc" id="L3703">                        .getATransitionTrigger().getTransition((Event) handle);</span>
            }
<span class="nc" id="L3705">            return illegalArgumentCollection(handle);</span>
<span class="nc" id="L3706">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3707">            throw new InvalidElementException(e);</span>
        }
    }


    public List getStructuralFeatures(Object handle) {
<span class="nc bnc" id="L3713" title="All 2 branches missed.">        if (!(handle instanceof Classifier)) {</span>
<span class="nc" id="L3714">            return illegalArgumentList(handle);</span>
        }
<span class="nc" id="L3716">        List result = new ArrayList();</span>
<span class="nc" id="L3717">        Classifier mclassifier = (Classifier) handle;</span>

        try {
<span class="nc" id="L3720">            Iterator features = mclassifier.getFeature().iterator();</span>
<span class="nc bnc" id="L3721" title="All 2 branches missed.">            while (features.hasNext()) {</span>
<span class="nc" id="L3722">                Feature feature = (Feature) features.next();</span>
<span class="nc bnc" id="L3723" title="All 2 branches missed.">                if (isAStructuralFeature(feature)) {</span>
<span class="nc" id="L3724">                    result.add(feature);</span>
                }
<span class="nc" id="L3726">            }</span>
<span class="nc" id="L3727">            return result;</span>
<span class="nc" id="L3728">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3729">            throw new InvalidElementException(e);</span>
        }
    }


    public String getSpecification(Object handle) {
        try {
<span class="nc bnc" id="L3736" title="All 2 branches missed.">            if (handle instanceof Reception) {</span>
<span class="nc" id="L3737">                return ((Reception) handle).getSpecification();</span>
            }
<span class="nc bnc" id="L3739" title="All 2 branches missed.">            if (handle instanceof Operation) {</span>
<span class="nc" id="L3740">                return ((Operation) handle).getSpecification();</span>
            }
            // This case is handled by CoreHelper.getSpecification
            // confusing !
            // TODO: rationalize/merge these two methods
            // if (handle instanceof Method) {
            // return ((Method) handle).getSpecification();
            // }
<span class="nc" id="L3748">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3749">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3750">        }</span>

<span class="nc" id="L3752">        return illegalArgumentString(handle);</span>
    }


    public Collection getSpecifications(Object handle) {
        try {
<span class="nc bnc" id="L3758" title="All 2 branches missed.">            if (handle instanceof AssociationEnd) {</span>
<span class="nc" id="L3759">                return ((AssociationEnd) handle).getSpecification();</span>
            }
<span class="nc bnc" id="L3761" title="All 2 branches missed.">            if (handle instanceof Classifier) {</span>
<span class="nc" id="L3762">                return modelImpl.getCoreHelper().getRealizedInterfaces(</span>
                        handle);
            }
<span class="nc" id="L3765">            return illegalArgumentCollection(handle);</span>
<span class="nc" id="L3766">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3767">            throw new InvalidElementException(e);</span>
        }
    }


    public Collection getSuppliers(Object handle) {
        try {
<span class="nc bnc" id="L3774" title="All 2 branches missed.">            if (handle instanceof Dependency) {</span>
<span class="nc" id="L3775">                return ((Dependency) handle).getSupplier();</span>
            }
<span class="nc" id="L3777">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3778">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3779">        }</span>
<span class="nc" id="L3780">        return illegalArgumentCollection(handle);</span>
    }


    /**
     * @see org.argouml.model.Facade#getAction(java.lang.Object)
     */
    public Object getAction(Object handle) {
        try {
<span class="nc bnc" id="L3789" title="All 2 branches missed.">            if (handle instanceof Message) {</span>
<span class="nc" id="L3790">                return getRefOutermostPackage(handle).getCollaborations()</span>
<span class="nc" id="L3791">                        .getAActionMessage().getAction((Message) handle);</span>
            }
<span class="nc bnc" id="L3793" title="All 2 branches missed.">            if (handle instanceof Argument) {</span>
<span class="nc" id="L3794">                return ((Argument) handle).getAction();</span>
            }
<span class="nc" id="L3796">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3797">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3798">        }</span>
<span class="nc" id="L3799">        return illegalArgumentObject(handle);</span>
    }


    public List getActions(Object handle) {
        try {
<span class="nc bnc" id="L3805" title="All 2 branches missed.">            if (handle instanceof ActionSequence) {</span>
<span class="nc" id="L3806">                return ((ActionSequence) handle).getAction();</span>
            }
<span class="nc" id="L3808">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3809">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3810">        }</span>
<span class="nc" id="L3811">        return illegalArgumentList(handle);</span>
    }


    public Object getActionSequence(Object handle) {
        try {
<span class="nc bnc" id="L3817" title="All 2 branches missed.">            if (handle instanceof Action) {</span>
<span class="nc" id="L3818">                return ((Action) handle).getActionSequence();</span>
            }
<span class="nc" id="L3820">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3821">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3822">        }</span>
<span class="nc" id="L3823">        return illegalArgumentList(handle);</span>
    }


    public Object getActivator(Object handle) {
        try {
<span class="nc bnc" id="L3829" title="All 2 branches missed.">            if (handle instanceof Message) {</span>
<span class="nc" id="L3830">                return ((Message) handle).getActivator();</span>
            }
<span class="nc" id="L3832">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3833">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3834">        }</span>
<span class="nc" id="L3835">        return illegalArgumentObject(handle);</span>
    }


    public Object getActivityGraph(Object handle) {
        try {
<span class="nc bnc" id="L3841" title="All 2 branches missed.">            if (handle instanceof Partition) {</span>
<span class="nc" id="L3842">                return ((Partition) handle).getActivityGraph();</span>
            }
<span class="nc" id="L3844">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3845">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3846">        }</span>
<span class="nc" id="L3847">        return illegalArgumentObject(handle);</span>
    }


    public Object getActivity(Object handle) {
<span class="nc" id="L3852">        throw new NotImplementedException(</span>
                &quot;UML 1.x does not support the model element &quot; //$NON-NLS-1$
<span class="nc" id="L3854">                + handle.getClass().getName());</span>
    }


    public List getActualArguments(Object handle) {
        try {
<span class="nc bnc" id="L3860" title="All 2 branches missed.">            if (handle instanceof Action) {</span>
<span class="nc" id="L3861">                return ((Action) handle).getActualArgument();</span>
            }
<span class="nc" id="L3863">            return illegalArgumentList(handle);</span>
<span class="nc" id="L3864">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3865">            throw new InvalidElementException(e);</span>
        }
    }


    public Object getAddition(Object handle) {
        try {
<span class="nc bnc" id="L3872" title="All 2 branches missed.">            if (handle instanceof Include) {</span>
<span class="nc" id="L3873">                return ((Include) handle).getAddition();</span>
            }
<span class="nc" id="L3875">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3876">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3877">        }</span>
<span class="nc" id="L3878">        return illegalArgumentObject(handle);</span>
    }


    public Object getAggregation(Object handle) {
<span class="nc" id="L3883">        return getAggregation1(handle);</span>
    }

    public Object getAggregation1(Object handle) {
        try {
<span class="nc bnc" id="L3888" title="All 2 branches missed.">            if (handle instanceof AssociationEnd) {</span>
<span class="nc" id="L3889">                return ((AssociationEnd) handle).getAggregation();</span>
            }
<span class="nc" id="L3891">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3892">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3893">        }</span>
<span class="nc" id="L3894">        return illegalArgumentObject(handle);</span>
    }

    public Object getAggregation2(Object handle) {
        try {
<span class="nc bnc" id="L3899" title="All 2 branches missed.">            if (handle instanceof AssociationEnd) {</span>
                // Simulates UML2 getting the aggregation from the opposite end
<span class="nc" id="L3901">                AssociationEnd assEnd = (AssociationEnd) handle;</span>
<span class="nc" id="L3902">                Collection&lt;AssociationEnd&gt; assEnds = assEnd.getAssociation().getConnection();</span>
<span class="nc" id="L3903">                Iterator&lt;AssociationEnd&gt; it = assEnds.iterator();</span>
<span class="nc" id="L3904">                AssociationEnd other = it.next();</span>
<span class="nc bnc" id="L3905" title="All 2 branches missed.">                if (other != assEnd) {</span>
<span class="nc" id="L3906">                    return other.getAggregation();</span>
                } else {
<span class="nc" id="L3908">                    other = it.next();</span>
<span class="nc" id="L3909">                    return other.getAggregation();</span>
                }
            }
<span class="nc" id="L3912">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3913">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3914">        }</span>
<span class="nc" id="L3915">        return illegalArgumentObject(handle);</span>
    }

    public String getAlias(Object handle) {
        try {
<span class="nc bnc" id="L3920" title="All 2 branches missed.">            if (handle instanceof ElementImport) {</span>
<span class="nc" id="L3921">                return ((ElementImport) handle).getAlias();</span>
            }
<span class="nc" id="L3923">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3924">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3925">        }</span>
<span class="nc" id="L3926">        throw new IllegalArgumentException(</span>
                &quot;Must have an MDR element supplied. Received a &quot;
<span class="nc" id="L3928">                        + handle.getClass().getName());</span>
    }


    public Collection getAssociatedClasses(Object handle) {
        try {
<span class="nc" id="L3934">            Collection col = new ArrayList();</span>
<span class="nc bnc" id="L3935" title="All 2 branches missed.">            if (handle instanceof Classifier) {</span>
<span class="nc" id="L3936">                Classifier classifier = (Classifier) handle;</span>
<span class="nc" id="L3937">                Collection ends = getAssociationEnds(classifier);</span>
<span class="nc" id="L3938">                Iterator it = ends.iterator();</span>
<span class="nc" id="L3939">                Set associations = new HashSet();</span>
<span class="nc bnc" id="L3940" title="All 2 branches missed.">                while (it.hasNext()) {</span>
<span class="nc" id="L3941">                    AssociationEnd ae = (AssociationEnd) it.next();</span>
<span class="nc" id="L3942">                    associations.add(ae.getAssociation());</span>
<span class="nc" id="L3943">                }</span>
<span class="nc" id="L3944">                Collection otherEnds = new ArrayList();</span>
<span class="nc" id="L3945">                it = associations.iterator();</span>
<span class="nc bnc" id="L3946" title="All 2 branches missed.">                while (it.hasNext()) {</span>
<span class="nc" id="L3947">                    otherEnds.addAll(((UmlAssociation) it.next())</span>
<span class="nc" id="L3948">                            .getConnection());</span>
                }
<span class="nc" id="L3950">                otherEnds.removeAll(ends);</span>
<span class="nc" id="L3951">                it = otherEnds.iterator();</span>
<span class="nc bnc" id="L3952" title="All 2 branches missed.">                while (it.hasNext()) {</span>
<span class="nc" id="L3953">                    col.add(((AssociationEnd) it.next()).getParticipant());</span>
                }
<span class="nc" id="L3955">                return col;</span>
            }
<span class="nc" id="L3957">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L3958">            throw new InvalidElementException(e);</span>
<span class="nc" id="L3959">        }</span>
<span class="nc" id="L3960">        return illegalArgumentCollection(handle);</span>
    }


    public String getName(Object handle) {
        try {
<span class="nc bnc" id="L3966" title="All 2 branches missed.">            if (handle instanceof OrderingKindEnum) {</span>
<span class="nc" id="L3967">                return handle.toString().replaceAll(&quot;ok_&quot;, &quot;&quot;);</span>
            }
<span class="nc bnc" id="L3969" title="All 2 branches missed.">            if (handle instanceof CallConcurrencyKindEnum) {</span>
<span class="nc" id="L3970">                return handle.toString().replaceAll(&quot;cck_&quot;, &quot;&quot;);</span>
            }
<span class="nc bnc" id="L3972" title="All 2 branches missed.">            if (handle instanceof ChangeableKindEnum) {</span>
<span class="nc" id="L3973">                return handle.toString().replaceAll(&quot;ck_&quot;, &quot;&quot;);</span>
            }
<span class="nc bnc" id="L3975" title="All 2 branches missed.">            if (handle instanceof VisibilityKindEnum) {</span>
<span class="nc" id="L3976">                return handle.toString().replaceAll(&quot;vk_&quot;, &quot;&quot;);</span>
            }
<span class="nc bnc" id="L3978" title="All 2 branches missed.">            if (handle instanceof AggregationKindEnum) {</span>
<span class="nc" id="L3979">                return handle.toString().replaceAll(&quot;ak_&quot;, &quot;&quot;);</span>
            }
<span class="nc bnc" id="L3981" title="All 2 branches missed.">            if (handle instanceof ParameterDirectionKindEnum) {</span>
<span class="nc" id="L3982">                return handle.toString().replaceAll(&quot;pdk_&quot;, &quot;&quot;);</span>
            }
<span class="nc bnc" id="L3984" title="All 2 branches missed.">            if (handle instanceof PseudostateKind) {</span>
<span class="nc" id="L3985">                return handle.toString().replaceAll(&quot;pk_&quot;, &quot;&quot;);</span>
            }
<span class="nc bnc" id="L3987" title="All 2 branches missed.">            if (handle instanceof ModelElement) {</span>
<span class="nc" id="L3988">                ModelElement me = (ModelElement) handle;</span>
<span class="nc" id="L3989">                return me.getName();</span>
            }
<span class="nc bnc" id="L3991" title="All 2 branches missed.">            if (handle instanceof Multiplicity) {</span>
<span class="nc" id="L3992">                return modelImpl.getDataTypesHelper().multiplicityToString(</span>
                        handle);
            }
<span class="nc bnc" id="L3995" title="All 2 branches missed.">            if (handle instanceof Expression) {</span>
<span class="nc" id="L3996">                return ((Expression) handle).getBody();</span>
            }
<span class="nc bnc" id="L3998" title="All 2 branches missed.">            if (handle instanceof ElementResidence) {</span>
<span class="nc" id="L3999">                return &quot;&quot;;</span>
            }
<span class="nc bnc" id="L4001" title="All 2 branches missed.">            if (handle instanceof TemplateParameter) {</span>
<span class="nc" id="L4002">                TemplateParameter templateParameter =</span>
                    (TemplateParameter) handle;
                // TODO: Do we want to construct an artificial name here?
<span class="nc" id="L4005">                StringBuffer result = new StringBuffer();</span>
<span class="nc" id="L4006">                ModelElement template = templateParameter.getTemplate();</span>
<span class="nc bnc" id="L4007" title="All 2 branches missed.">                if (template != null) {</span>
<span class="nc" id="L4008">                    String name = template.getName();</span>
<span class="nc bnc" id="L4009" title="All 2 branches missed.">                    if (name != null) {</span>
<span class="nc" id="L4010">                        result.append(name);</span>
                    }
                }
<span class="nc" id="L4013">                result.append(&quot;:&quot;);</span>
<span class="nc" id="L4014">                ModelElement parameter = templateParameter.getParameter();</span>
<span class="nc bnc" id="L4015" title="All 2 branches missed.">                if (parameter != null) {</span>
<span class="nc" id="L4016">                    String name = parameter.getName();</span>
<span class="nc bnc" id="L4017" title="All 2 branches missed.">                    if (name != null) {</span>
<span class="nc" id="L4018">                        result.append(name);</span>
                    }
                }
<span class="nc" id="L4021">                return &quot;&quot;;</span>
            }
            // TODO: What other non-ModelElement types do we need to handle here?
<span class="nc" id="L4024">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L4025">            String uuid = getUUID(handle);</span>
<span class="nc bnc" id="L4026" title="All 2 branches missed.">            if (uuid != null) {</span>
<span class="nc" id="L4027">                throw new InvalidElementException(&quot;UUID: &quot; + uuid, e);</span>
            } else {
<span class="nc" id="L4029">                throw new InvalidElementException(e);</span>
            }
<span class="nc" id="L4031">        }</span>
<span class="nc" id="L4032">        throw new IllegalArgumentException(</span>
                &quot;Must have an MDR element supplied. Received a &quot;
<span class="nc" id="L4034">                        + handle.getClass().getName());</span>
    }


    public Object getOwner(Object handle) {
        try {
<span class="nc bnc" id="L4040" title="All 2 branches missed.">            if ((handle instanceof Attribute)</span>
<span class="nc bnc" id="L4041" title="All 2 branches missed.">                    &amp;&amp; ((Attribute) handle).getAssociationEnd() != null) {</span>
<span class="nc" id="L4042">                return ((Attribute) handle).getAssociationEnd();</span>
            }
<span class="nc bnc" id="L4044" title="All 2 branches missed.">            if (handle instanceof Feature) {</span>
<span class="nc" id="L4045">                return ((Feature) handle).getOwner();</span>
            }
<span class="nc bnc" id="L4047" title="All 2 branches missed.">            if (handle instanceof TagDefinition) {</span>
<span class="nc" id="L4048">                return ((TagDefinition) handle).getOwner();</span>
            }
<span class="nc" id="L4050">            return illegalArgumentObject(handle);</span>
<span class="nc" id="L4051">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L4052">            throw new InvalidElementException(e);</span>
        }
    }


    public String getTag(Object handle) {
        try {
<span class="nc bnc" id="L4059" title="All 2 branches missed.">            if (handle instanceof TaggedValue) {</span>
<span class="nc" id="L4060">                TagDefinition td = ((TaggedValue) handle).getType();</span>
<span class="nc bnc" id="L4061" title="All 2 branches missed.">                if (td != null) {</span>
<span class="nc" id="L4062">                    return td.getName();</span>
                }
<span class="nc" id="L4064">                return null;</span>
            }
<span class="nc" id="L4066">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L4067">            throw new InvalidElementException(e);</span>
<span class="nc" id="L4068">        }</span>
<span class="nc" id="L4069">        return illegalArgumentString(handle);</span>
    }


    public Iterator getTaggedValues(Object handle) {
        try {
<span class="nc bnc" id="L4075" title="All 2 branches missed.">            if (handle instanceof ModelElement) {</span>
<span class="nc" id="L4076">                return getTaggedValuesCollection(handle).iterator();</span>
            }
<span class="nc" id="L4078">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L4079">            throw new InvalidElementException(e);</span>
<span class="nc" id="L4080">        }</span>
<span class="nc" id="L4081">        throw new IllegalArgumentException(&quot;Expected a ModelElement. Got a &quot;</span>
<span class="nc" id="L4082">                + handle.getClass().getName());</span>
    }


    public Collection getTaggedValuesCollection(Object handle) {
        try {
<span class="nc bnc" id="L4088" title="All 2 branches missed.">            if (handle instanceof ModelElement) {</span>
<span class="nc" id="L4089">                return ((ModelElement) handle).getTaggedValue();</span>
            }
<span class="nc" id="L4091">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L4092">            throw new InvalidElementException(e);</span>
<span class="nc" id="L4093">        }</span>
<span class="nc" id="L4094">        return illegalArgumentCollection(handle);</span>
    }


    public Object getTaggedValue(Object handle, String name) {
        try {
<span class="nc bnc" id="L4100" title="All 2 branches missed.">            if (handle instanceof ModelElement) {</span>
<span class="nc" id="L4101">                ModelElement me = ((ModelElement) handle);</span>
<span class="nc" id="L4102">                Iterator i = me.getTaggedValue().iterator();</span>
<span class="nc bnc" id="L4103" title="All 2 branches missed.">                while (i.hasNext()) {</span>
<span class="nc" id="L4104">                    TaggedValue tv = (TaggedValue) i.next();</span>
<span class="nc bnc" id="L4105" title="All 2 branches missed.">                    if (tv.getType() != null</span>
<span class="nc bnc" id="L4106" title="All 2 branches missed.">                            &amp;&amp; name.equals(tv.getType().getName())) {</span>
<span class="nc" id="L4107">                        return tv;</span>
                    }
<span class="nc" id="L4109">                }</span>
<span class="nc" id="L4110">                return null;</span>
            }
<span class="nc" id="L4112">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L4113">            throw new InvalidElementException(e);</span>
<span class="nc" id="L4114">        }</span>
<span class="nc" id="L4115">        return illegalArgumentObject(handle);</span>
    }


    public String getTaggedValueValue(Object handle, String name) {
        try {
<span class="nc" id="L4121">            Object taggedValue = getTaggedValue(handle, name);</span>
<span class="nc bnc" id="L4122" title="All 2 branches missed.">            if (taggedValue == null) {</span>
<span class="nc" id="L4123">                return &quot;&quot;;</span>
            }
<span class="nc" id="L4125">            return getValueOfTag(taggedValue);</span>
<span class="nc" id="L4126">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L4127">            throw new InvalidElementException(e);</span>
        }
    }


    public String getTagOfTag(Object handle) {
<span class="nc" id="L4133">        return getTag(handle);</span>
    }


    public Object getTagDefinition(Object handle) {
        try {
<span class="nc bnc" id="L4139" title="All 2 branches missed.">            if (handle instanceof TaggedValue) {</span>
<span class="nc" id="L4140">                return ((TaggedValue) handle).getType();</span>
            }
<span class="nc" id="L4142">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L4143">            throw new InvalidElementException(e);</span>
<span class="nc" id="L4144">        }</span>
<span class="nc" id="L4145">        return illegalArgumentObject(handle);</span>
    }


    public Collection getTagDefinitions(Object handle) {
        try {
<span class="nc bnc" id="L4151" title="All 2 branches missed.">            if (handle instanceof Stereotype) {</span>
<span class="nc" id="L4152">                return ((Stereotype) handle).getDefinedTag();</span>
            }
<span class="nc" id="L4154">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L4155">            throw new InvalidElementException(e);</span>
<span class="nc" id="L4156">        }</span>
<span class="nc" id="L4157">        return illegalArgumentCollection(handle);</span>
    }


    public Object getValue(Object handle) {
        try {
<span class="nc bnc" id="L4163" title="All 2 branches missed.">            if (handle instanceof TaggedValue) {</span>
<span class="nc" id="L4164">                return getValueOfTag(handle);</span>
            }
<span class="nc bnc" id="L4166" title="All 2 branches missed.">            if (handle instanceof Argument) {</span>
<span class="nc" id="L4167">                return ((Argument) handle).getValue();</span>
            }
<span class="nc bnc" id="L4169" title="All 2 branches missed.">            if (handle instanceof AttributeLink) {</span>
<span class="nc" id="L4170">                return ((AttributeLink) handle).getValue();</span>
            }
<span class="nc bnc" id="L4172" title="All 2 branches missed.">            if (handle instanceof AggregationKind) {</span>
<span class="nc" id="L4173">                return Integer.valueOf(((AggregationKind) handle).toString());</span>
            }
<span class="nc bnc" id="L4175" title="All 2 branches missed.">            if (handle instanceof OrderingKind) {</span>
<span class="nc" id="L4176">                return Integer.valueOf(((OrderingKind) handle).toString());</span>
            }
<span class="nc bnc" id="L4178" title="All 2 branches missed.">            if (handle instanceof ParameterDirectionKind) {</span>
<span class="nc" id="L4179">                return Integer.valueOf(((ParameterDirectionKind) handle)</span>
<span class="nc" id="L4180">                        .toString());</span>
            }
<span class="nc bnc" id="L4182" title="All 2 branches missed.">            if (handle instanceof VisibilityKind) {</span>
<span class="nc" id="L4183">                return Integer.valueOf(((VisibilityKind) handle).toString());</span>
            }
<span class="nc bnc" id="L4185" title="All 2 branches missed.">            if (handle instanceof ScopeKind) {</span>
<span class="nc" id="L4186">                return Integer.valueOf(((ScopeKind) handle).toString());</span>
            }
            /*
             * if (handle instanceof MessageDirectionKind) { return new
             * Integer(((MessageDirectionKind) handle).getValue()); }
             */
<span class="nc bnc" id="L4192" title="All 2 branches missed.">            if (handle instanceof ChangeableKind) {</span>
<span class="nc" id="L4193">                return Integer.valueOf(((ChangeableKind) handle).toString());</span>
            }
<span class="nc bnc" id="L4195" title="All 2 branches missed.">            if (handle instanceof PseudostateKind) {</span>
<span class="nc" id="L4196">                return Integer.valueOf(((PseudostateKind) handle).toString());</span>
            }
<span class="nc bnc" id="L4198" title="All 2 branches missed.">            if (handle instanceof CallConcurrencyKind) {</span>
<span class="nc" id="L4199">                return Integer.valueOf(((CallConcurrencyKind) handle)</span>
<span class="nc" id="L4200">                        .toString());</span>
            }
<span class="nc" id="L4202">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L4203">            throw new InvalidElementException(e);</span>
<span class="nc" id="L4204">        }</span>
<span class="nc" id="L4205">        return illegalArgumentObject(handle);</span>
    }


    public String getValueOfTag(Object handle) {
        try {
<span class="nc bnc" id="L4211" title="All 2 branches missed.">            if (handle instanceof TaggedValue) {</span>
<span class="nc" id="L4212">                TaggedValue tv = (TaggedValue) handle;</span>
<span class="nc" id="L4213">                Collection refValues = tv.getReferenceValue();</span>
<span class="nc" id="L4214">                Collection values = tv.getDataValue();</span>

<span class="nc bnc" id="L4216" title="All 4 branches missed.">                if (values.isEmpty() &amp;&amp; refValues.isEmpty()) {</span>
<span class="nc" id="L4217">                    return &quot;&quot;;</span>
                }
                // TODO: Implement support for multiple TaggedValues
<span class="nc bnc" id="L4220" title="All 2 branches missed.">                if (values.size() + refValues.size() &gt; 1) {</span>
<span class="nc" id="L4221">                    LOG.log(Level.WARNING,</span>
                            &quot;Don't know how to manage multiple values &quot;
                            + &quot;for a TaggedValue, returning first value&quot;);
                }

                // TODO: More is required here to support referenceValues
                Object value;
<span class="nc bnc" id="L4228" title="All 2 branches missed.">                if (refValues.size() &gt; 0) {</span>
<span class="nc" id="L4229">                    value = refValues.iterator().next();</span>
                } else {
<span class="nc" id="L4231">                    value = values.iterator().next();</span>
                }
<span class="nc bnc" id="L4233" title="All 2 branches missed.">                if (value instanceof String) {</span>
<span class="nc" id="L4234">                    return (String) value;</span>
<span class="nc bnc" id="L4235" title="All 2 branches missed.">                } else if (value instanceof EnumerationLiteral) {</span>
                    // TODO: Temporary stopgap for EnumerationLiteral
<span class="nc" id="L4237">                    return ((EnumerationLiteral) value).getName();</span>
                } else {
                    // TODO: Implement support for types other than String
<span class="nc" id="L4240">                    LOG.log(Level.WARNING,</span>
                            &quot;Can't handled TaggedValue.dataValues which &quot;
                            + &quot; aren't Strings.  Converting to String&quot;);
<span class="nc" id="L4243">                    return value.toString();</span>
                }
            }
<span class="nc" id="L4246">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L4247">            throw new InvalidElementException(e);</span>
<span class="nc" id="L4248">        }</span>
<span class="nc" id="L4249">        return illegalArgumentString(handle);</span>
    }

    public Object getValueOfTag(Object handle, Object property) {
<span class="nc" id="L4253">        throw new NotImplementedException();</span>
    }

    public Collection getReferenceValue(Object taggedValue) {
        try {
<span class="nc bnc" id="L4258" title="All 2 branches missed.">            if (taggedValue instanceof TaggedValue) {</span>
<span class="nc" id="L4259">                TaggedValue tv = (TaggedValue) taggedValue;</span>
<span class="nc" id="L4260">                return tv.getReferenceValue();</span>
            }
<span class="nc" id="L4262">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L4263">            throw new InvalidElementException(e);</span>
<span class="nc" id="L4264">        }</span>
<span class="nc" id="L4265">        return illegalArgumentCollection(taggedValue);</span>
    }


    public Collection getDataValue(Object taggedValue) {
        try {
<span class="nc bnc" id="L4271" title="All 2 branches missed.">            if (taggedValue instanceof TaggedValue) {</span>
<span class="nc" id="L4272">                TaggedValue tv = (TaggedValue) taggedValue;</span>
<span class="nc" id="L4273">                return tv.getDataValue();</span>
            }
<span class="nc" id="L4275">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L4276">            throw new InvalidElementException(e);</span>
<span class="nc" id="L4277">        }</span>
<span class="nc" id="L4278">        return illegalArgumentCollection(taggedValue);</span>
    }


    public String getUUID(Object base) {
        try {
<span class="nc bnc" id="L4284" title="All 2 branches missed.">            if (base instanceof RefBaseObject) {</span>
<span class="nc" id="L4285">                String mofId = ((RefBaseObject) base).refMofId();</span>
                // Look for an existing reference matching our MofID
<span class="nc" id="L4287">                XmiReference ref = ((XmiReference) modelImpl</span>
<span class="nc" id="L4288">                        .getObjectToId().get(mofId));</span>
<span class="nc bnc" id="L4289" title="All 2 branches missed.">                if (ref == null) {</span>
<span class="nc" id="L4290">                    return mofId;</span>
                }
                // FIXME: depends on internal behavior of XmiReaderImpl.
                // Needed for solving issue 5017.
<span class="nc bnc" id="L4294" title="All 2 branches missed.">                else if (!ref.getSystemId().startsWith(</span>
<span class="nc" id="L4295">                        XmiReaderImpl.getTempXMIFileURIPrefix())) {</span>
<span class="nc" id="L4296">                    return ref.getSystemId() + &quot;#&quot; + ref.getXmiId();</span>
                } else {
<span class="nc" id="L4298">                    return ref.getXmiId();</span>
                }
            }
<span class="nc" id="L4301">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L4302">            throw new InvalidElementException(e);</span>
<span class="nc" id="L4303">        }</span>
<span class="nc" id="L4304">        return illegalArgumentString(base);</span>
    }


    public Object getVisibility(Object handle) {
        try {
<span class="nc bnc" id="L4310" title="All 2 branches missed.">            if (handle instanceof ModelElement) {</span>
<span class="nc" id="L4311">                return ((ModelElement) handle).getVisibility();</span>
            }
<span class="nc bnc" id="L4313" title="All 2 branches missed.">            if (handle instanceof ElementResidence) {</span>
<span class="nc" id="L4314">                return ((ElementResidence) handle).getVisibility();</span>
            }
<span class="nc bnc" id="L4316" title="All 2 branches missed.">            if (handle instanceof ElementImport) {</span>
<span class="nc" id="L4317">                return ((ElementImport) handle).getVisibility();</span>
            }
<span class="nc" id="L4319">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L4320">            throw new InvalidElementException(e);</span>
<span class="nc" id="L4321">        }</span>
<span class="nc" id="L4322">        return illegalArgumentObject(handle);</span>
    }


    public Object getWhen(Object target) {
        try {
<span class="nc bnc" id="L4328" title="All 2 branches missed.">            if (isATimeEvent(target)) {</span>
<span class="nc" id="L4329">                return ((TimeEvent) target).getWhen();</span>
            }
<span class="nc" id="L4331">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L4332">            throw new InvalidElementException(e);</span>
<span class="nc" id="L4333">        }</span>
<span class="nc" id="L4334">        return illegalArgumentObject(target);</span>
    }


    public Object getChangeExpression(Object target) {
        try {
<span class="nc bnc" id="L4340" title="All 2 branches missed.">            if (isAChangeEvent(target)) {</span>
<span class="nc" id="L4341">                return ((ChangeEvent) target).getChangeExpression();</span>
            }
<span class="nc" id="L4343">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L4344">            throw new InvalidElementException(e);</span>
<span class="nc" id="L4345">        }</span>
<span class="nc" id="L4346">        return illegalArgumentObject(target);</span>
    }


    public Collection getPartitions(Object container) {
        try {
<span class="nc bnc" id="L4352" title="All 2 branches missed.">            if (container instanceof ActivityGraph) {</span>
<span class="nc" id="L4353">                return ((ActivityGraph) container).getPartition();</span>
            }
<span class="nc" id="L4355">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L4356">            throw new InvalidElementException(e);</span>
<span class="nc" id="L4357">        }</span>
<span class="nc" id="L4358">        return illegalArgumentCollection(container);</span>
    }


    public String getReferenceState(Object o) {
        try {
<span class="nc bnc" id="L4364" title="All 2 branches missed.">            if (o instanceof StubState) {</span>
<span class="nc" id="L4365">                return ((StubState) o).getReferenceState();</span>
            }
<span class="nc" id="L4367">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L4368">            throw new InvalidElementException(e);</span>
<span class="nc" id="L4369">        }</span>
<span class="nc" id="L4370">        return illegalArgumentString(o);</span>
    }


    public Object lookupIn(Object handle, String name) {
        try {
<span class="nc bnc" id="L4376" title="All 2 branches missed.">            if (handle instanceof Model) {</span>
<span class="nc" id="L4377">                return lookup((Model) handle, name);</span>
            }
<span class="nc bnc" id="L4379" title="All 2 branches missed.">            if (handle instanceof Namespace) {</span>
<span class="nc" id="L4380">                return lookup((Namespace) handle, name);</span>
            }
<span class="nc bnc" id="L4382" title="All 2 branches missed.">            if (handle instanceof Classifier) {</span>
<span class="nc" id="L4383">                return lookup((Classifier) handle, name);</span>
            }
<span class="nc" id="L4385">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L4386">            throw new InvalidElementException(e);</span>
<span class="nc" id="L4387">        }</span>
<span class="nc" id="L4388">        return illegalArgumentObject(handle);</span>
    }

    private ModelElement lookup(Namespace ns, String name) {
        try {
<span class="nc" id="L4393">            int idx = name.indexOf(&quot;::&quot;);</span>

<span class="nc bnc" id="L4395" title="All 2 branches missed.">            if (idx != -1) {</span>
                String nm;
<span class="nc" id="L4397">                nm = name.substring(0, idx);</span>
<span class="nc" id="L4398">                ModelElement e = lookup(ns, nm);</span>
<span class="nc bnc" id="L4399" title="All 4 branches missed.">                if (e == null || !(e instanceof Namespace)) {</span>
<span class="nc" id="L4400">                    return null;</span>
                }
<span class="nc" id="L4402">                Namespace n = (Namespace) e;</span>
<span class="nc" id="L4403">                nm = name.substring(idx + 2);</span>
<span class="nc" id="L4404">                return lookup(n, nm);</span>
            }
<span class="nc" id="L4406">            Iterator i = ns.getOwnedElement().iterator();</span>
<span class="nc bnc" id="L4407" title="All 2 branches missed.">            while (i.hasNext()) {</span>
<span class="nc" id="L4408">                ModelElement e = (ModelElement) i.next();</span>
<span class="nc bnc" id="L4409" title="All 2 branches missed.">                if (name.equals(e.getName())) {</span>
<span class="nc" id="L4410">                    return e;</span>
                }
<span class="nc" id="L4412">            }</span>
<span class="nc" id="L4413">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L4414">            throw new InvalidElementException(e);</span>
<span class="nc" id="L4415">        }</span>
<span class="nc" id="L4416">        return null;</span>
    }


    public String toString(Object modelElement) {
        try {
<span class="nc bnc" id="L4422" title="All 2 branches missed.">            if (modelElement instanceof Multiplicity) {</span>
<span class="nc" id="L4423">                return org.argouml.model.Model.getDataTypesHelper()</span>
<span class="nc" id="L4424">                        .multiplicityToString(modelElement);</span>
<span class="nc bnc" id="L4425" title="All 2 branches missed.">            } else if (modelElement instanceof Expression) {</span>
<span class="nc" id="L4426">                Expression exp = (Expression) modelElement;</span>
<span class="nc" id="L4427">                String result = getUMLClassName(modelElement);</span>
<span class="nc" id="L4428">                String language = exp.getLanguage();</span>
<span class="nc" id="L4429">                String body = exp.getBody();</span>
                // TODO: I18N
<span class="nc bnc" id="L4431" title="All 4 branches missed.">                if (language != null &amp;&amp; language.length() &gt; 0) {</span>
<span class="nc" id="L4432">                    result += &quot; (&quot; + language + &quot;)&quot;;</span>
                }
<span class="nc bnc" id="L4434" title="All 4 branches missed.">                if (body != null &amp;&amp; body.length() &gt; 0) {</span>
<span class="nc" id="L4435">                    result += &quot;: &quot; + body;</span>
                }
<span class="nc" id="L4437">                return result;</span>
<span class="nc bnc" id="L4438" title="All 2 branches missed.">            } else if (modelElement instanceof ElementImport) {</span>
<span class="nc" id="L4439">                ElementImport ei = (ElementImport) modelElement;</span>
<span class="nc" id="L4440">                ModelElement me = ei.getImportedElement();</span>
<span class="nc" id="L4441">                String typeName = getUMLClassName(me);</span>
<span class="nc" id="L4442">                String elemName = toString(me);</span>
<span class="nc" id="L4443">                String alias = ei.getAlias();</span>
<span class="nc bnc" id="L4444" title="All 4 branches missed.">                if (alias != null &amp;&amp; alias.length() &gt; 0) {</span>
                    // TODO: I18N This needs to be localized, but we don't
                    // have any localization capabilities in the model subsystem
//                    Object[] args = { typeName, elemName, alias };
//                  misc.name.element-import.alias = Imported {0}: {1} alias {2}
//                    return Translator.localize(
//                            &quot;misc.name.element-import.alias&quot;, args);
<span class="nc" id="L4451">                    return &quot;Imported &quot; + typeName + &quot;: &quot; + elemName + &quot; alias &quot;</span>
                            + alias;
                } else {
//                    Object[] args = { typeName, elemName };
//                  misc.name.element-import = Imported {0}: {1}
//                    return Translator
//                            .localize(&quot;misc.name.element-import&quot;, args);
<span class="nc" id="L4458">                    return &quot;Imported &quot; + typeName + &quot;: &quot; + elemName;</span>
                }
<span class="nc bnc" id="L4460" title="All 2 branches missed.">            } else if (isAUMLElement(modelElement)) {</span>
<span class="nc" id="L4461">                return getUMLClassName(modelElement) + &quot;: &quot;</span>
<span class="nc" id="L4462">                        + getName(modelElement);</span>
<span class="nc bnc" id="L4463" title="All 2 branches missed.">            } else if (modelElement == null) {</span>
<span class="nc" id="L4464">                return &quot;&quot;;</span>
            }
<span class="nc" id="L4466">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L4467">            throw new InvalidElementException(e);</span>
<span class="nc" id="L4468">        }</span>
<span class="nc" id="L4469">        return modelElement.toString();</span>
    }

    public String getUMLClassName(Object handle) {
<span class="nc bnc" id="L4473" title="All 2 branches missed.">        if (!isAUMLElement(handle)) {</span>
<span class="nc" id="L4474">            return illegalArgumentString(handle);</span>
        }
        try {
<span class="nc" id="L4477">            return modelImpl.getMetaTypes().getName(handle);</span>
<span class="nc" id="L4478">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L4479">            throw new InvalidElementException(e);</span>
        }
    }

    /**
     * Method that throws an error when a method is called with an incorrect
     * argument.&lt;p&gt;
     *
     * @param arg
     *            is the incorrect argument.
     * @return Object for use in the return statement.
     */
    private Object illegalArgumentObject(Object arg) {
<span class="nc" id="L4492">        illegalArgument(arg);</span>
<span class="nc" id="L4493">        return null;</span>
    }

    /**
     * Method that throws an error when a method is called with an incorrect
     * argument.&lt;p&gt;
     *
     * @param arg
     *            is the incorrect argument.
     * @return String for use in the return statement.
     */
    private String illegalArgumentString(Object arg) {
<span class="nc" id="L4505">        illegalArgument(arg);</span>
<span class="nc" id="L4506">        return null;</span>
    }

    /**
     * Method that throws an error when a method is called with an incorrect
     * argument.
     *
     * @param arg
     *            is the incorrect argument.
     */
    private void illegalArgument(Object arg) {
<span class="nc" id="L4517">        throw new IllegalArgumentException(&quot;Unrecognized object &quot;</span>
<span class="nc" id="L4518">                + getClassNull(arg));</span>
    }

    /**
     * @param handle
     *            the Class or null
     * @return String
     */
    protected String getClassNull(Object handle) {
<span class="nc bnc" id="L4527" title="All 2 branches missed.">        if (handle == null) {</span>
<span class="nc" id="L4528">            return &quot;[null]&quot;;</span>
        }
<span class="nc" id="L4530">        return &quot;[&quot; + handle + &quot;/&quot; + handle.getClass() + &quot;]&quot;;</span>
    }


    public String getTipString(Object modelElement) {
<span class="nc" id="L4535">        return getUMLClassName(modelElement) + &quot;: &quot; + getName(modelElement);</span>
    }

    /**
     * Method that throws an error when a method is called with an incorrect
     * argument.&lt;p&gt;
     *
     * @param arg
     *            is the incorrect argument.
     * @return Collection for use in the return statement.
     */
    private Collection illegalArgumentCollection(Object arg) {
<span class="nc" id="L4547">        illegalArgument(arg);</span>
<span class="nc" id="L4548">        return null;</span>
    }

    /**
     * Method that throws an error when a method is called with an incorrect
     * argument.&lt;p&gt;
     *
     * @param arg
     *            is the incorrect argument.
     * @return Collection for use in the return statement.
     */
    private List illegalArgumentList(Object arg) {
<span class="nc" id="L4560">        illegalArgument(arg);</span>
<span class="nc" id="L4561">        return null;</span>
    }

    /**
     * Method that throws an error when a method is called with an incorrect
     * argument.&lt;p&gt;
     *
     * @param arg
     *            is the incorrect argument.
     * @return a boolean for use in the return statement.
     */
    private boolean illegalArgumentBoolean(Object arg) {
<span class="nc" id="L4573">        illegalArgument(arg);</span>
<span class="nc" id="L4574">        return false;</span>
    }

    /**
     * Method that throws an error when a method is called with an incorrect
     * argument.&lt;p&gt;
     *
     * @param arg
     *            is the incorrect argument.
     * @return Int for use in the return statement.
     */
    private int illegalArgumentInt(Object arg) {
<span class="nc" id="L4586">        illegalArgument(arg);</span>
<span class="nc" id="L4587">        return 0;</span>
    }

    public boolean isATagDefinition(Object handle) {
<span class="nc" id="L4591">        return handle instanceof TagDefinition;</span>
    }

    public List getEnumerationLiterals(Object handle) {
        try {
<span class="nc bnc" id="L4596" title="All 2 branches missed.">            if (!isAEnumeration(handle)) {</span>
<span class="nc" id="L4597">                throw new IllegalArgumentException(&quot;handle: &quot; + handle);</span>
            }
<span class="nc" id="L4599">            return ((Enumeration) handle).getLiteral();</span>
<span class="nc" id="L4600">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L4601">            throw new InvalidElementException(e);</span>
        }
    }

    public boolean isAEnumeration(Object handle) {
<span class="nc" id="L4606">        return handle instanceof Enumeration;</span>
    }

    public boolean isAEnumerationLiteral(Object handle) {
<span class="nc" id="L4610">        return handle instanceof EnumerationLiteral;</span>
    }

    public List getArguments(Object handle) {
        try {
<span class="nc bnc" id="L4615" title="All 2 branches missed.">            if (handle instanceof Binding) {</span>
<span class="nc" id="L4616">                return ((Binding) handle).getArgument();</span>
<span class="nc bnc" id="L4617" title="All 2 branches missed.">            } else if (handle instanceof Action) {</span>
<span class="nc" id="L4618">                return ((Action) handle).getActualArgument();</span>
            }
<span class="nc" id="L4620">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L4621">            throw new InvalidElementException(e);</span>
<span class="nc" id="L4622">        }</span>
<span class="nc" id="L4623">        return illegalArgumentList(handle);</span>
    }

    public Object getBinding(Object handle) {
        try {
<span class="nc bnc" id="L4628" title="All 2 branches missed.">            if (handle instanceof TemplateArgument) {</span>
<span class="nc" id="L4629">                return ((TemplateArgument) handle).getBinding();</span>
            }
<span class="nc" id="L4631">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L4632">            throw new InvalidElementException(e);</span>
<span class="nc" id="L4633">        }</span>
<span class="nc" id="L4634">        return illegalArgumentObject(handle);</span>
    }

    public Object getDefaultElement(Object handle) {
        try {
<span class="nc bnc" id="L4639" title="All 2 branches missed.">            if (handle instanceof TemplateParameter) {</span>
<span class="nc" id="L4640">                return ((TemplateParameter) handle).getDefaultElement();</span>
            }
<span class="nc" id="L4642">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L4643">            throw new InvalidElementException(e);</span>
<span class="nc" id="L4644">        }</span>
<span class="nc" id="L4645">        return illegalArgumentObject(handle);</span>
    }

    public Object getTemplate(Object handle) {
        try {
<span class="nc bnc" id="L4650" title="All 2 branches missed.">            if (handle instanceof TemplateParameter) {</span>
<span class="nc" id="L4651">                return ((TemplateParameter) handle).getTemplate();</span>
            }
<span class="nc" id="L4653">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L4654">            throw new InvalidElementException(e);</span>
<span class="nc" id="L4655">        }</span>
<span class="nc" id="L4656">        return illegalArgumentObject(handle);</span>
    }

    public List getTemplateParameters(Object handle) {
        try {
<span class="nc bnc" id="L4661" title="All 2 branches missed.">            if (handle instanceof ModelElement) {</span>
<span class="nc" id="L4662">                return ((ModelElement) handle).getTemplateParameter();</span>
            }
<span class="nc" id="L4664">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L4665">            throw new InvalidElementException(e);</span>
<span class="nc" id="L4666">        }</span>
<span class="nc" id="L4667">        return illegalArgumentList(handle);</span>
    }

    public boolean isSynch(Object handle) {
        try {
<span class="nc" id="L4672">            return ((ObjectFlowState) handle).isSynch();</span>
<span class="nc" id="L4673">        } catch (InvalidObjectException e) {</span>
<span class="nc" id="L4674">            throw new InvalidElementException(e);</span>
<span class="nc" id="L4675">        } catch (ClassCastException e) {</span>
<span class="nc" id="L4676">            throw new IllegalArgumentException(e);</span>
        }
    }


    public String[] getMetatypeNames() {
        // Get all (UML) metaclasses
<span class="nc" id="L4683">        Collection&lt;MofClass&gt; metaTypes = getMetaClasses();</span>
<span class="nc" id="L4684">        String[] names = new String[metaTypes.size()];</span>
<span class="nc" id="L4685">        int i = 0;</span>
<span class="nc bnc" id="L4686" title="All 2 branches missed.">        for (MofClass mofClass : metaTypes) {</span>
            // TODO: Do we need to worry about UmlClass, UmlPackage, etc?
<span class="nc" id="L4688">            names[i++] = mofClass.getName();</span>
<span class="nc" id="L4689">        }</span>
<span class="nc" id="L4690">        return names;</span>
    }

    Collection&lt;MofClass&gt; getMetaClasses() {
<span class="nc" id="L4694">        Collection&lt;MofClass&gt; metaTypes = modelImpl.getModelPackage()</span>
<span class="nc" id="L4695">                .getMofClass().refAllOfClass();</span>
<span class="nc" id="L4696">        return metaTypes;</span>
    }

    public boolean isA(String metatypeName, Object element) {
<span class="nc" id="L4700">        MofClass metaObject = (MofClass) ((RefObject) element).refMetaObject();</span>
<span class="nc bnc" id="L4701" title="All 2 branches missed.">        return metatypeName != null</span>
<span class="nc bnc" id="L4702" title="All 2 branches missed.">                &amp;&amp; metatypeName.equals(metaObject.getName());</span>
    }

    MofClass getMofClass(String metatypeName) {
<span class="nc" id="L4706">        Collection&lt;MofClass&gt; metaTypes = getMetaClasses();</span>
<span class="nc bnc" id="L4707" title="All 2 branches missed.">        for (MofClass mofClass : metaTypes) {</span>
            // TODO: Generalize - assumes UML type names are unique
            // without the qualifying package names - true for UML 1.4
<span class="nc bnc" id="L4710" title="All 2 branches missed.">            if (metatypeName.equals(mofClass.getName())) {</span>
<span class="nc" id="L4711">                return mofClass;</span>
            }
<span class="nc" id="L4713">        }</span>
<span class="nc" id="L4714">        return null;</span>
    }

    RefClass getProxy(String metatypeName, RefPackage extent) {
<span class="nc" id="L4718">        Collection&lt;MofClass&gt; metaTypes = getMetaClasses();</span>
<span class="nc" id="L4719">        MofClass mofClass = getMofClass(metatypeName);</span>
<span class="nc" id="L4720">        List&lt;String&gt; names = mofClass.getQualifiedName();</span>
        // Although this only handles one level of package, it is
        // OK for UML 1.4 because of clustering
        // Get the right UML package in the extent
<span class="nc" id="L4724">        RefPackage pkg = extent.refPackage(names.get(0));</span>
        // Return the metatype proxy
<span class="nc" id="L4726">        return pkg.refClass(names.get(1));</span>
    }


    public Collection getTargets(Object handle) {
<span class="nc" id="L4731">        return illegalArgumentCollection(handle);</span>
    }

    public boolean isADirectedRelationship(Object handle) {
<span class="nc" id="L4735">        return false;</span>
    }

    public boolean isAASynchCallMessage(Object handle) {
<span class="nc" id="L4739">        Message message = (Message) handle;</span>
<span class="nc bnc" id="L4740" title="All 2 branches missed.">        if (message.getAction() instanceof CallAction) {</span>
<span class="nc" id="L4741">            CallAction ca = (CallAction) message.getAction();</span>
<span class="nc" id="L4742">            return ca.isAsynchronous();</span>
        }
<span class="nc" id="L4744">        return false;</span>
    }

    public boolean isAASynchSignalMessage(Object handle) {
<span class="nc" id="L4748">        Message message = (Message) handle;</span>
<span class="nc bnc" id="L4749" title="All 2 branches missed.">        if (message.getAction() instanceof SendAction) {</span>
<span class="nc" id="L4750">            SendAction sa = (SendAction) message.getAction();</span>
<span class="nc" id="L4751">            return sa.isAsynchronous();</span>
        }
<span class="nc" id="L4753">        return false;</span>
    }

    public boolean isACreateMessage(Object handle) {
<span class="nc" id="L4757">        Message message = (Message) handle;</span>
<span class="nc" id="L4758">        return (message.getAction() instanceof CreateAction);</span>
    }

    public boolean isADeleteMessage(Object handle) {
<span class="nc" id="L4762">        Message message = (Message) handle;</span>
<span class="nc" id="L4763">        return (message.getAction() instanceof DestroyAction);</span>
    }

    public boolean isAReplyMessage(Object handle) {
<span class="nc" id="L4767">        Message message = (Message) handle;</span>
<span class="nc" id="L4768">        return (message.getAction() instanceof ReturnAction);</span>
    }

    public boolean isASynchCallMessage(Object handle) {
<span class="nc" id="L4772">        Message message = (Message) handle;</span>
<span class="nc bnc" id="L4773" title="All 2 branches missed.">        if (message.getAction() instanceof CallAction) {</span>
<span class="nc" id="L4774">            CallAction ca = (CallAction) message.getAction();</span>
<span class="nc bnc" id="L4775" title="All 2 branches missed.">            return !ca.isAsynchronous();</span>
        }
<span class="nc" id="L4777">        return false;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.5.201910111838</span></div></body></html>